<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="Copyright © Panic Inc.">
<title>Inside Playdate</title>
<link rel="stylesheet" href="./Inside%20Playdate/adoc.css">

<link rel="stylesheet" href="./Inside%20Playdate/colors.css">
<link rel="stylesheet" href="./Inside%20Playdate/themes.css">
<link rel="stylesheet" href="./Inside%20Playdate/fonts.css">
<link rel="stylesheet" href="./Inside%20Playdate/coderay.css">
</head>
<body class="article">
<div id="header">
<h1>Inside Playdate</h1>
<div class="details">
<span id="author" class="author">Copyright © Panic Inc.</span><br>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_what_is_playdate">1. What is Playdate?</a>
<ul class="sectlevel2">
<li><a href="#_playdate_specifications">1.1. Playdate specifications</a></li>
<li><a href="#_playdate_hardware_naming_conventions">1.2. Playdate hardware naming conventions</a></li>
</ul>
</li>
<li><a href="#_contents_of_the_sdk">2. Contents of the SDK</a></li>
<li><a href="#_installation">3. Installation</a></li>
<li><a href="#_writing_a_game">4. Writing a game</a>
<ul class="sectlevel2">
<li><a href="#_choosing_your_development_language">4.1. Choosing your development language</a></li>
<li><a href="#_structuring_your_project">4.2. Structuring your project</a></li>
<li><a href="#_compiling_a_project">4.3. Compiling a project</a>
<ul class="sectlevel3">
<li><a href="#_set_playdate_sdk_path_environment_variable">Set <code>PLAYDATE_SDK_PATH</code> Environment Variable</a></li>
</ul>
</li>
<li><a href="#using-playdate-simulator">4.4. Using the Playdate Simulator</a>
<ul class="sectlevel3">
<li><a href="#_running_your_game">Running your game</a></li>
<li><a href="#_running_your_game_on_playdate_hardware">Running your game on Playdate hardware</a></li>
<li><a href="#_using_your_playdate_to_control_the_simulator">Using your Playdate to control the Simulator</a></li>
</ul>
</li>
<li><a href="#usingNova">4.5. Using the Nova extension</a></li>
<li><a href="#pdxinfo">4.6. Game metadata</a></li>
<li><a href="#saving-state">4.7. Saving game state</a></li>
<li><a href="#localization">4.8. Localization</a></li>
<li><a href="#_game_size">4.9. Game size</a></li>
</ul>
</li>
<li><a href="#developing-in-lua">5. Developing in Lua</a>
<ul class="sectlevel2">
<li><a href="#basic-playdate-game">5.1. A Basic Playdate Game in Lua</a></li>
<li><a href="#_playdate_lua_api_conventions">5.2. Playdate Lua API conventions</a>
<ul class="sectlevel3">
<li><a href="#_arrays">Arrays</a></li>
<li><a href="#_calling_functions">Calling functions</a></li>
<li><a href="#_return_values">Return values</a></li>
</ul>
</li>
<li><a href="#lua-tips">5.3. Lua Tips</a>
<ul class="sectlevel3">
<li><a href="#_initialize_variables_with_local">Initialize variables with <code>local</code></a></li>
<li><a href="#_assign_frequently_used_objects_to_local_variables">Assign frequently-used objects to local variables</a></li>
</ul>
</li>
<li><a href="#_object_oriented_programming_in_lua">5.4. Object-oriented programming in Lua</a></li>
<li><a href="#_corelibs">5.5. CoreLibs</a></li>
</ul>
</li>
<li><a href="#developing-in-c">6. Developing in C</a></li>
<li><a href="#api-reference">7. API reference</a>
<ul class="sectlevel2">
<li><a href="#playdate-sdk-lua-enhancements">7.1. Playdate SDK Lua enhancements</a>
<ul class="sectlevel3">
<li><a href="#additional-assignment-operators">Additional assignment operators</a></li>
<li><a href="#table-additions">Table additions</a></li>
</ul>
</li>
<li><a href="#system-and-game-metadata">7.2. System and Game Metadata</a></li>
<li><a href="#game-flow">7.3. Game flow</a>
<ul class="sectlevel3">
<li><a href="#_callbacks">Callbacks</a>
<ul class="sectlevel4">
<li><a href="#_coroutines_and_playdate_update">Coroutines and playdate.update()</a></li>
</ul>
</li>
<li><a href="#_functions">Functions</a></li>
</ul>
</li>
<li><a href="#game-lifecycle">7.4. Game lifecycle</a></li>
<li><a href="#system-menu">7.5. Interacting with the System Menu</a>
<ul class="sectlevel3">
<li><a href="#menu-item">Menu Item operations</a></li>
</ul>
</li>
<li><a href="#_localization">7.6. Localization</a></li>
<li><a href="#M-accessibility">7.7. Accessibility</a></li>
<li><a href="#accelerometer">7.8. Accelerometer</a></li>
<li><a href="#buttons">7.9. Buttons</a>
<ul class="sectlevel3">
<li><a href="#_querying_buttons_directly">Querying buttons directly</a></li>
<li><a href="#buttonCallbacks">Button callbacks</a></li>
<li><a href="#_input_handlers">Input handlers</a></li>
</ul>
</li>
<li><a href="#crank">7.10. Crank</a>
<ul class="sectlevel3">
<li><a href="#_reading_crank_input">Reading crank input</a>
<ul class="sectlevel4">
<li><a href="#_querying_crank_status_directly">Querying crank status directly</a></li>
<li><a href="#_crank_callbacks">Crank callbacks</a></li>
<li><a href="#_input_handlers_2">Input handlers</a></li>
</ul>
</li>
<li><a href="#_crank_sounds">Crank sounds</a></li>
</ul>
</li>
<li><a href="#M-inputHandlers">7.11. Input Handlers</a></li>
<li><a href="#M-autoLock">7.12. Device Auto Lock</a></li>
<li><a href="#date-and-time">7.13. Date &amp; Time</a></li>
<li><a href="#M-debug">7.14. Debugging</a>
<ul class="sectlevel3">
<li><a href="#_advanced_debugging">Advanced Debugging</a></li>
</ul>
</li>
<li><a href="#M-profiling">7.15. Profiling</a>
<ul class="sectlevel3">
<li><a href="#_using_the_simulator">Using the Simulator</a>
<ul class="sectlevel4">
<li><a href="#_profiling_performance">Profiling performance</a></li>
<li><a href="#_profiling_memory_usage">Profiling memory usage</a></li>
<li><a href="#_profiling_malloc_calls_in_the_simulator">Profiling malloc calls in the Simulator</a></li>
<li><a href="#_profiling_malloc_calls_on_the_device">Profiling malloc calls on the Device</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#M-display">7.16. Display</a>
<ul class="sectlevel3">
<li><a href="#_display_updating">Display updating</a></li>
<li><a href="#_other_display_properties">Other display properties</a></li>
<li><a href="#_displaying_an_image">Displaying an image</a></li>
</ul>
</li>
<li><a href="#M-easingFunctions">7.17. Easing functions</a></li>
<li><a href="#file">7.18. Files</a>
<ul class="sectlevel3">
<li><a href="#M-datastore">playdate.datastore</a></li>
<li><a href="#M-file">playdate.file</a>
<ul class="sectlevel4">
<li><a href="#_file_reading_and_writing">File reading and writing</a></li>
</ul>
</li>
<li><a href="#_filesystem_operations">Filesystem operations</a></li>
<li><a href="#_pdz_files">.pdz files</a></li>
</ul>
</li>
<li><a href="#M-geometry">7.19. Geometry</a>
<ul class="sectlevel3">
<li><a href="#C-geometry.affineTransform">Affine transform</a></li>
<li><a href="#C-geometry.arc">Arc</a></li>
<li><a href="#C-geometry.lineSegment">Line segment</a></li>
<li><a href="#C-geometry.point">Point</a></li>
<li><a href="#C-geometry.polygon">Polygon</a></li>
<li><a href="#C-geometry.rect">Rect</a></li>
<li><a href="#C-geometry.size">Size</a></li>
<li><a href="#_utility_functions">Utility functions</a></li>
<li><a href="#C-geometry.vector2D">Vector</a></li>
</ul>
</li>
<li><a href="#M-graphics">7.20. Graphics</a>
<ul class="sectlevel3">
<li><a href="#_conventions">Conventions</a></li>
<li><a href="#_contexts">Contexts</a></li>
<li><a href="#_clearing_the_screen">Clearing the Screen</a></li>
<li><a href="#C-graphics.image">Image</a>
<ul class="sectlevel4">
<li><a href="#_image_basics">Image basics</a></li>
<li><a href="#_image_transformations">Image transformations</a></li>
<li><a href="#_image_masks">Image masks</a></li>
<li><a href="#_image_effects">Image effects</a></li>
<li><a href="#_other_image_stuff">Other image stuff</a></li>
</ul>
</li>
<li><a href="#_color_pattern">Color &amp; Pattern</a></li>
<li><a href="#_drawing">Drawing</a>
<ul class="sectlevel4">
<li><a href="#_line">Line</a></li>
<li><a href="#_pixel">Pixel</a></li>
<li><a href="#_rect">Rect</a></li>
<li><a href="#_round_rect">Round rect</a></li>
<li><a href="#_arc">Arc</a></li>
<li><a href="#_circle">Circle</a></li>
<li><a href="#_ellipse">Ellipse</a></li>
<li><a href="#_polygon">Polygon</a></li>
<li><a href="#_triangle">Triangle</a></li>
<li><a href="#C-graphics.nineSlice">Nine slice</a></li>
<li><a href="#_perlin_noise">Perlin noise</a></li>
<li><a href="#_qrcode">QRCode</a></li>
<li><a href="#_sine_wave">Sine wave</a></li>
</ul>
</li>
<li><a href="#_drawing_modifiers">Drawing Modifiers</a>
<ul class="sectlevel4">
<li><a href="#_clipping">Clipping</a></li>
<li><a href="#_stencil">Stencil</a></li>
<li><a href="#_drawing_mode">Drawing mode</a></li>
<li><a href="#_lines_strokes">Lines &amp; Strokes</a></li>
</ul>
</li>
<li><a href="#_offscreen_drawing">Offscreen Drawing</a></li>
<li><a href="#_animation">Animation</a>
<ul class="sectlevel4">
<li><a href="#C-graphics.animation.loop">Animation loop</a></li>
<li><a href="#C-graphics.animator">Animator</a></li>
<li><a href="#C-graphics.animation.blinker">Blinker</a></li>
</ul>
</li>
<li><a href="#_scrolling">Scrolling</a></li>
<li><a href="#_frame_buffer">Frame buffer</a></li>
<li><a href="#C-graphics.imagetable">Image table</a></li>
<li><a href="#C-graphics.tilemap">Tilemap</a>
<ul class="sectlevel4">
<li><a href="#_how_to">How-To</a></li>
<li><a href="#_configuring">Configuring</a></li>
<li><a href="#_setting_tile_values">Setting tile values</a></li>
<li><a href="#_drawing_2">Drawing</a></li>
<li><a href="#_collisions">Collisions</a></li>
<li><a href="#_other_tilemap_functions">Other tilemap functions</a></li>
</ul>
</li>
<li><a href="#C-graphics.sprite">Sprite</a>
<ul class="sectlevel4">
<li><a href="#_sprite_basics">Sprite Basics</a></li>
<li><a href="#_drawing_images_alongside_sprites">Drawing images alongside sprites</a></li>
<li><a href="#_automatically_animating_sprites">Automatically animating sprites</a></li>
<li><a href="#_clipping_2">Clipping</a></li>
<li><a href="#_drawing_3">Drawing</a></li>
<li><a href="#_group_operations">Group operations</a></li>
<li><a href="#_sprite_callbacks">Sprite callbacks</a></li>
<li><a href="#M-sprite-collisions">Sprite collision detection</a></li>
<li><a href="#_sprites_in_tilemap_based_games">Sprites in tilemap-based games</a></li>
</ul>
</li>
<li><a href="#_text">Text</a>
<ul class="sectlevel4">
<li><a href="#C-graphics.font">Fonts</a></li>
<li><a href="#_drawing_text">Drawing Text</a></li>
</ul>
</li>
<li><a href="#C-graphics.video">Video</a></li>
</ul>
</li>
<li><a href="#M-json">7.21. JSON</a></li>
<li><a href="#M-keyboard">7.22. Keyboard</a></li>
<li><a href="#M-math">7.23. Math</a></li>
<li><a href="#M-network">7.24. Networking</a>
<ul class="sectlevel3">
<li><a href="#C-network.http">HTTP </a></li>
<li><a href="#M-network.tcp">TCP </a></li>
</ul>
</li>
<li><a href="#M-pathfinder">7.25. Pathfinding</a>
<ul class="sectlevel3">
<li><a href="#C-pathfinder.graph">Graph </a></li>
<li><a href="#C-playdate.pathfinder.node">Node</a></li>
</ul>
</li>
<li><a href="#power">7.26. Power</a></li>
<li><a href="#simulator">7.27. Simulator-only functionality</a>
<ul class="sectlevel3">
<li><a href="#_simulator_debug_callbacks">Simulator debug callbacks</a></li>
</ul>
</li>
<li><a href="#M-sound">7.28. Sound</a>
<ul class="sectlevel3">
<li><a href="#C-sound.sampleplayer">Sampleplayer</a></li>
<li><a href="#C-sound.fileplayer">Fileplayer</a></li>
<li><a href="#C-sound.sample">Sample</a></li>
<li><a href="#C-sound.channel">Channel</a></li>
<li><a href="#C-sound.source">Source</a></li>
<li><a href="#C-sound.synth">Synth</a>
<ul class="sectlevel4">
<li><a href="#_synth_parameters">Synth parameters</a></li>
</ul>
</li>
<li><a href="#C-sound.signal">Signal</a></li>
<li><a href="#C-sound.lfo">LFO</a></li>
<li><a href="#C-sound.envelope">Envelope</a></li>
<li><a href="#C-sound.effect">Effects</a></li>
<li><a href="#C-sound.bitcrusher">Bitcrusher</a></li>
<li><a href="#C-sound.ringmod">Ring Modulator</a></li>
<li><a href="#C-sound.onepolefilter">One pole filter</a></li>
<li><a href="#C-sound.twopolefilter">Two pole filter</a></li>
<li><a href="#C-sound.overdrive">Overdrive</a></li>
<li><a href="#C-sound.delayline">Delay line</a></li>
<li><a href="#C-sound.delaylinetap">Delay line tap</a></li>
<li><a href="#C-sound.sequence">Sequence</a></li>
<li><a href="#C-sound.track">Track</a></li>
<li><a href="#C-sound.instrument">Instrument</a></li>
<li><a href="#C-sound.controlsignal">Control Signal</a></li>
<li><a href="#_mic_input">Mic Input</a></li>
<li><a href="#C-sound.output">Audio Output</a></li>
<li><a href="#C-sound.time">Audio Device Time</a></li>
</ul>
</li>
<li><a href="#C-string">7.29. Strings</a></li>
<li><a href="#C-timer">7.30. Timers</a>
<ul class="sectlevel3">
<li><a href="#_standard_timers">Standard timers</a></li>
<li><a href="#_delay_timers">Delay timers</a></li>
<li><a href="#_value_timers">Value timers</a></li>
<li><a href="#_key_repeat_timers">Key repeat timers</a></li>
<li><a href="#C-commonTimerMethods">Common timer methods</a></li>
<li><a href="#C-commonTimerProperties">Common timer properties</a></li>
<li><a href="#_timer_sample_code">Timer sample code</a></li>
</ul>
</li>
<li><a href="#C-frameTimer">7.31. Frame timers</a>
<ul class="sectlevel3">
<li><a href="#_standard_frame_timers">Standard frame timers</a></li>
<li><a href="#_delay_frame_timers">Delay frame timers</a></li>
<li><a href="#_value_frame_timers">Value frame timers</a></li>
<li><a href="#C-commonFrameTimerMethods">Common frame timer methods</a></li>
<li><a href="#C-commonFrameTimerProperties">Common frame timer properties</a></li>
<li><a href="#_frame_timer_sample_code">Frame timer sample code</a></li>
</ul>
</li>
<li><a href="#M-ui">7.32. UI components</a>
<ul class="sectlevel3">
<li><a href="#C-ui.crankIndicator">Crank indicator</a></li>
<li><a href="#C-ui.gridview">Grid view</a>
<ul class="sectlevel4">
<li><a href="#_drawing_4">Drawing</a></li>
<li><a href="#_configuration">Configuration</a></li>
<li><a href="#_scrolling_2">Scrolling</a></li>
<li><a href="#_selection">Selection</a></li>
<li><a href="#_properties">Properties</a></li>
<li><a href="#_grid_view_sample_code">Grid view sample code</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#M-wired-networking">7.33. Serial communication</a></li>
<li><a href="#M-mirror">7.34. Playdate Mirror</a></li>
<li><a href="#M-garbage-collection">7.35. Garbage collection</a></li>
</ul>
</li>
<li><a href="#hidden-gems">8. Hidden Gems</a>
<ul class="sectlevel2">
<li><a href="#_lua_enhancements">8.1. Lua enhancements</a></li>
<li><a href="#_debugging">8.2. Debugging</a></li>
<li><a href="#_enhancing_your_games_user_experience">8.3. Enhancing your game&#8217;s user experience</a></li>
<li><a href="#_buttons">8.4. Buttons</a></li>
<li><a href="#_responding_to_device_events">8.5. Responding to device events</a></li>
<li><a href="#_drawing_5">8.6. Drawing</a></li>
<li><a href="#_effects">8.7. Effects</a></li>
<li><a href="#_accessibility">8.8. Accessibility</a></li>
<li><a href="#_file_io">8.9. File I/O</a></li>
<li><a href="#_game_logic">8.10. Game logic</a></li>
<li><a href="#_deployment">8.11. Deployment</a></li>
<li><a href="#_odds_ends">8.12. Odds &amp; ends</a></li>
</ul>
</li>
<li><a href="#getting-help">9. Getting Help</a>
<ul class="sectlevel2">
<li><a href="#_where_can_i_download_the_sdk">9.1. Where can I download the SDK?</a></li>
<li><a href="#_where_do_i_go_if_i_have_questions_about_the_sdk">9.2. Where do I go if I have questions about the SDK?</a></li>
<li><a href="#_where_do_i_report_bugs_or_issues_relating_to_the_sdk">9.3. Where do I report bugs or issues relating to the SDK?</a></li>
<li><a href="#_list_of_helpful_libraries_and_code">9.4. List of Helpful Libraries and Code</a></li>
</ul>
</li>
<li><a href="#_legal_information">10. Legal information</a></li>
</ul>
</div>
</div>
</div>
<div class="sect1 section">
<h2 id="_what_is_playdate">1. What is Playdate?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Playdate is a curious handheld gaming console.</p>
</div>
<div class="paragraph">
<p>Playdate players collectively share the experience of a curated selection of video games made by independent developers, revealed one at a time on a fixed schedule.  A collection of these games is known as a "season", analogous to a season of a television show.</p>
</div>
<div class="paragraph">
<p>Playdate developers write their games using the simple scripting language Lua, and asset creation tools they are already familiar with.</p>
</div>
<div class="sect2 section">
<h3 id="_playdate_specifications">1.1. Playdate specifications</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Display</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Monochrome (1-bit) memory LCD display</p>
</li>
<li>
<p>400 x 240 pixel resolution</p>
</li>
<li>
<p>Refreshed at 30 frames-per-second (fps) by default, maximum 50 fps</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Controls</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Eight-way directional control (D-pad)</p>
</li>
<li>
<p>Two primary buttons</p>
</li>
<li>
<p>Menu button</p>
</li>
<li>
<p>Lock button</p>
</li>
<li>
<p>Collapsible crank</p>
</li>
<li>
<p>Accelerometer</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Sound</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Internal speaker</p>
</li>
<li>
<p>Microphone</p>
</li>
<li>
<p>Headphone jack supporting mic input</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Connectivity</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Wi-Fi</p>
</li>
<li>
<p>Bluetooth</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Memory &amp; Storage</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>16MB RAM</p>
</li>
<li>
<p>4GB flash storage</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_playdate_hardware_naming_conventions">1.2. Playdate hardware naming conventions</h3>
<div class="imageblock diagram">
<div class="content">
<img src="Inside%20Playdate/playdate-definitions.png" alt="playdate definitions">
</div>
<div class="title">Figure 1. A Playdate and the name of its components.</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Lock button</dt>
<dd>
<p>The top-edge metal button, which sleeps and wakes the system. Referred to as the capital-L "Lock button".</p>
</dd>
<dt class="hdlist1">Menu button</dt>
<dd>
<p>The top-right button on the face of the device, with a dot in its center. This presents the System Menu. Referred to as the capital-M "Menu button".</p>
</dd>
<dt class="hdlist1">D-pad</dt>
<dd>
<p>The D is capitalized if the term is at the beginning of the sentence; otherwise, it is "d-pad".</p>
</dd>
<dt class="hdlist1">A button/B button</dt>
<dd>
<p>"A" and "B" are capitalized; the "b" in "button" is not.</p>
</dd>
<dt class="hdlist1">Crank</dt>
<dd>
<p>The action of taking out the crank is called <em>extending</em> the crank. Putting it away is <em>stowing</em> the crank. If the crank is turned in the direction shown in the illustration below, it is said to be turning <em>forward</em>. The opposite direction is <em>backward</em>.</p>
</dd>
</dl>
</div>
<div class="imageblock diagram">
<div class="content">
<img src="Inside%20Playdate/crank-rotation.png" alt="crank rotation">
</div>
<div class="title">Figure 2. Playdate cranking direction.</div>
</div>
</div>
</div>
</div>
<div class="sect1 section">
<h2 id="_contents_of_the_sdk">2. Contents of the SDK</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This SDK contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Software tools to compile your game</p>
</li>
<li>
<p>A device Simulator to test your game</p>
</li>
<li>
<p>A set of libraries for common functions you can use in your game</p>
</li>
<li>
<p>Some fonts and other assets you can use in your game</p>
</li>
<li>
<p>Some example code and games</p>
</li>
<li>
<p>Documentation</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1 section">
<h2 id="_installation">3. Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After <a href="https://play.date/dev/">downloading the SDK</a> for your desired platform you will need to complete the installation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>MacOS: Run the SDK installer application</p>
</li>
<li>
<p>Windows: Extract the SDK and run the SDK installer application</p>
</li>
<li>
<p>Linux</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Extract the SDK folder archive</p>
</li>
<li>
<p>Move the SDK folder to your desired user-writable location</p>
</li>
<li>
<p>Run the <code>setup.sh</code> script inside the SDK folder to complete the installation</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1 section">
<h2 id="_writing_a_game">4. Writing a game</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_choosing_your_development_language">4.1. Choosing your development language</h3>
<div class="paragraph">
<p>Most Playdate games are <a href="#developing-in-lua">written in Lua</a> for ease of development, but games with the strictest performance needs can be <a href="#developing-in-c">written partially or entirely in C</a>. See the associated sections for information on which might be the right choice for you.</p>
</div>
</div>
<div class="sect2">
<h3 id="_structuring_your_project">4.2. Structuring your project</h3>
<div class="paragraph">
<p>Place all scripts and assets together in a single project directory.</p>
</div>
<div class="paragraph">
<p>Your source directory must, at minimum, contain one Lua script called <em>main.lua</em>. This script can source other scripts if necessary via the <em>import</em> statement. The Playdate runtime uses <em>import</em> instead of the standard Lua <em>require</em> function, and it behaves a little differently: All files imported from main.lua (and imported from files imported from main.lua, and so on) are compiled into a single pdz file, and <em>import</em> runs the code from the file only once. A second <em>import</em> call from <strong>anywhere</strong> in the pdz will do nothing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">a.lua:
  <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>

b.lua:
  <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">b says </span><span class="delimiter">&quot;</span></span> .. import <span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span> <span class="keyword">or</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">nil</span><span class="delimiter">&quot;</span></span>)

main.lua:
  <span class="predefined">print</span>(import <span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span> <span class="keyword">or</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">nil</span><span class="delimiter">&quot;</span></span>)
  import <span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>prints the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">  hello
  b says <span class="predefined-constant">nil</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Though Lua projects can be organized in many ways, here is a suggested structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">[myProjectName]/
    source/
        main.lua
        ...<span class="keyword">and</span> other .lua files
        images/
            [myImageFile1].png
            [myImageFile2].png
            ...<span class="keyword">and</span> so on
        sounds/
            [myAudioFile1].wav
            [myAudioFile2].mp3
            ...<span class="keyword">and</span> other ADPCM- <span class="keyword">or</span> MP3-formatted files
    support/
        Project files including Photoshop assets, project outlines, etc.</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this structure, you can do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Import a Lua file</em> via an <code>import "myLuaFile"</code> at the start of your file.</p>
</li>
<li>
<p><em>Load an image</em> with <code>myImage = playdate.graphics.image.new("images/myImageFile")</code></p>
</li>
<li>
<p><em>Load a sound</em> with <code>mySound = playdate.sound.sampleplayer.new("sounds/mySoundFile")</code></p>
</li>
<li>
<p>If your project will be object-oriented, <em>create a subclass</em> <strong><em>B</em></strong> of class <strong><em>A</em></strong> in file <code>B.lua</code>, like so:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">import <span class="string"><span class="delimiter">&quot;</span><span class="content">A</span><span class="delimiter">&quot;</span></span>
class(<span class="string"><span class="delimiter">&quot;</span><span class="content">B</span><span class="delimiter">&quot;</span></span>).extends(A)

<span class="keyword">function</span> B:<span class="function">init</span>()
    B.super.init(self) <span class="comment">-- calls superclass initializer</span>
    <span class="comment">-- initialization code goes here</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that we use forward slashes <code>/</code> for path separators everywhere. Windows style backslashes <code>\</code> might work in the Windows simulator but will break everywhere else, including on the device.</p>
</div>
</div>
<div class="sect2 section">
<h3 id="_compiling_a_project">4.3. Compiling a project</h3>
<div class="paragraph">
<p>Playdate projects are compiled with the command line tool <strong><code>pdc</code></strong> (for "Playdate Compiler").</p>
</div>
<div class="sect3">
<h4 id="_set_playdate_sdk_path_environment_variable">Set <code>PLAYDATE_SDK_PATH</code> Environment Variable</h4>
<div class="paragraph">
<p>On <strong>macOS</strong>, it is recommended, but not required.</p>
</div>
<div class="paragraph">
<p>On <strong>Linux</strong>, it is required for CMake and Make files, and recommended for Lua projects.</p>
</div>
<div class="paragraph">
<p>On <strong>Windows</strong>, it is required for CMake files (see the <em>Building on Windows</em> section in the <a href="#developing-in-c"><strong><em>Inside Playdate for C</em></strong></a> docs for instructions), and recommended for Lua projects</p>
</div>
<div class="paragraph">
<p>Add the following line to your shell&#8217;s startup file (<em>~/.bash_profile</em> or <em>~/.bashrc</em> for <strong>bash</strong>, or <em>~/.zprofile</em> if you use <strong>zsh</strong>, etc.). Replace <code>&lt;path to SDK&gt;</code> placeholder text with the SDK location:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>export PLAYDATE_SDK_PATH=&lt;path to SDK&gt;</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <strong><code>pdc</code></strong> compiler will use this value for the default location of the SDK if it is not specified using the <code>-sdkpath</code> flag.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
You may also want to add <code>&lt;path to SDK&gt;/bin</code> to your shell <code>$PATH</code> variable. This allows running <code>pdc</code>, <code>pdutil</code> and the Simulator from any location without a fully qualified path.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong><code>pdc</code></strong> requires two arguments: the input (source) directory, and an output directory.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ pdc MyGameSource MyGame.pdx</pre>
</div>
</div>
<div class="paragraph">
<p>The output directory, by convention, should end with the extension <em>.pdx</em>.  This directory will appear as a single-icon bundle in Finder.  It will contain the compiled source as well as any files that weren’t recognized as Lua source, such as images, sounds, or data files.</p>
</div>
<div class="paragraph">
<p>Passing the <code>-s</code> option to <strong><code>pdc</code></strong> will strip debugging information from the output files.</p>
</div>
<div class="paragraph">
<p>To specify folders outside of the project source folder or the SDK as locations for files to be imported, you can set the <code>PLAYDATE_LIB_PATH</code> environment variable, or pass them in using the <code>-I</code> or <code>--libpath</code> command-line flag.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ export PLAYDATE_LIB_PATH=~/pddev/Libs
$ pdc -I ~/pddev/OtherLibs MyGameSource MyGame.pdx</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, <strong><code>pdc</code></strong> will first search the <code>MyGameSource</code> folder, then the <code>OtherLibs</code> folder, then <code>Libs</code>, and finally the SDK folder when locating files via the <code>import</code> command.</p>
</div>
<div class="paragraph">
<p>A few other helpful command line arguments:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>-v/--verbose: verbose mode, gives info about what the compiler is doing
-q/--quiet: quiet mode, suppresses non-error output
-k/--skip-unknown: skip unrecognized files instead of copying them to the pdx folder</pre>
</div>
</div>
<div class="paragraph">
<p>And finally, to tell <strong><code>pdc</code></strong> to ignore specific files or folders (other than expected files like main.lua) in the source folder, add it to a file called <code>.pdcignore</code> in the source folder; e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>images/logo.bak.png
test</pre>
</div>
</div>
<div class="paragraph">
<p>will keep both the file <code>logo-old.png</code> in the <code>images</code> subfolder and the entire <code>test</code> folder from getting compiled. Empty lines and lines starting with <code>#</code> are ignored. Wildcard/regex is not currently supported.</p>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="using-playdate-simulator">4.4. Using the Playdate Simulator</h3>
<div class="paragraph">
<p>The <strong>Playdate Simulator</strong> is an application that mimics the Playdate device, and makes Playdate development quick and easy. The Simulator not only runs Playdate applications, but can also emulate the functionality of Playdate&#8217;s controls, including its crank and accelerometer.</p>
</div>
<div class="paragraph">
<p>Games running in the Simulator can be controlled by the on-screen GUI, or keyboard equivalents. The Simulator can also be controlled by a select number of a compatible game controllers or the Playdate console itself, if connected.</p>
</div>
<div class="sect3">
<h4 id="_running_your_game">Running your game</h4>
<div class="paragraph">
<p>To run your game, take one of these three approaches:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Launch the Playdate Simulator app.</p>
<div class="ulist">
<ul>
<li>
<p>Do one of the following to choose which game to run:</p>
<div class="ulist">
<ul>
<li>
<p>Choose <strong>Open</strong> from the <strong>File</strong> menu to select the <em>.pdx</em> folder you&#8217;d like to run.</p>
</li>
<li>
<p>Drag your <em>.pdx</em> folder onto the Simulator window.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Double-click on a <em>.pdx</em> folder.</p>
</li>
<li>
<p>If you&#8217;re using Nova as your development environment, press Command+R to launch the Simulator and start your game.</p>
</li>
</ol>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Game performance is considerably faster in the Simulator than on the Playdate hardware. Please take that into consideration when developing your game, and make sure to periodically test on Playdate hardware.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_running_your_game_on_playdate_hardware">Running your game on Playdate hardware</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Attach your Playdate to your computer via USB cable.</p>
</li>
<li>
<p>Turn on your Playdate by pushing the <strong><em>Unlock</em></strong> button on top.</p>
</li>
<li>
<p>Run your game in the Playdate Simulator.</p>
</li>
<li>
<p>Choose <strong>Upload Game to Device</strong> from the Simulator&#8217;s <strong>Device</strong> menu. After the game is uploaded to your Playdate, it will start running automatically.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you do not see a <strong>Device</strong> menu in the Simulator&#8217;s menubar, check to ensure your Playdate is <em>unlocked</em> (via the metal button on top of Playdate), <em>powered</em>, and <em>properly connected</em> to your computer via USB cable.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_using_your_playdate_to_control_the_simulator">Using your Playdate to control the Simulator</h4>
<div class="paragraph">
<p>If you enjoy the rapid development the Playdate Simulator offers, while also wanting the tactile feel of Playdate controls, you can put your Playdate device into <em>controller mode</em> to control the Simulator with your Playdate hardware.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Attach your Playdate to your computer via USB cable.</p>
</li>
<li>
<p>Unlock your Playdate by pushing the metal <em>Lock</em> button on Playdate&#8217;s top edge.</p>
</li>
<li>
<p>Press the button with the little Playdate on it that will appear in the lower right corner of the Simulator window.</p>
</li>
<li>
<p>Choose <strong>Use Device as Controller</strong> in the menu that appears. Your Playdate&#8217;s inputs will now control the Simulator.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="Inside%20Playdate/device-menu.png" alt="device menu">
</div>
<div class="title">Figure 3. The Playdate Simulator&#8217;s "Device" menu.</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you do not see a button with a Playdate icon on the lower edge of the Simulator window, check to ensure your Playdate is <em>unlocked</em> (via the metal button on top of Playdate), <em>powered</em>, and <em>properly connected</em> to your computer via USB cable.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="usingNova">4.5. Using the Nova extension</h3>
<div class="paragraph">
<p>Mac users with Nova installed can make use of additional features provided by the Playdate extension. It offers syntax highlighting, autocompletion for Playdate API and allows you to compile, run and debug your project in the Simulator with a single keypress.</p>
</div>
<div class="paragraph">
<p>To install the extension:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install Nova on your Mac.</p>
</li>
<li>
<p>Find the <a href="https://extensions.panic.com/extensions/com.panic/com.panic.Playdate/">Playdate extension in the Nova extension repository</a>.</p>
</li>
<li>
<p>Click the "Install" button on the web page.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The best way to develop for Playdate using Nova is to create a Project for each Playdate game.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After creating your project, click on the project name in the top left of the window tooolbar.</p>
</li>
<li>
<p>In the <strong>Build &amp; Run</strong> section of the resulting dialog, click the <strong>plus (+)</strong> button.</p>
</li>
<li>
<p>Choose <strong>Playdate Simulator</strong> from the list of options to create a new configuration.</p>
</li>
<li>
<p>Specify our project&#8217;s <em>Source</em> folder. If it is the default <em>./Source</em> or <em>./source</em>, then you don&#8217;t need to do anything.</p>
</li>
<li>
<p>Click <strong>Done</strong> to finish.</p>
</li>
<li>
<p>Press the <strong>Run</strong> (▶️) button in the upper left corner of the window to invoke the Playdate Simulator and run your game. (Make sure you have a <em>main.lua</em> file in your project.)</p>
</li>
</ol>
</div>
</div>
<div class="sect2 section">
<h3 id="pdxinfo">4.6. Game metadata</h3>
<div class="paragraph">
<p>If a file named <strong><em>pdxinfo</em></strong> is present at the root of your project&#8217;s source directory, it will be used by the system to gather information about your game.</p>
</div>
<div class="paragraph">
<p>Here is a sample <em>pdxinfo</em> file:</p>
</div>
<div class="listingblock">
<div class="title">Sample pdxinfo file</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">name=b360
author=Panic Inc.
description=When all you have is a ton of bricks, everything looks like a paddle.
bundleID=com.panic.b360
version=<span class="float">1.0</span>
buildNumber=<span class="integer">123</span>
imagePath=path/to/launcher/assets
launchSoundPath=path/to/launch/sound/file
contentWarning=This game contains mild realistic violence <span class="keyword">and</span> bloodshed.
contentWarning2=This game contains flashing content that may <span class="keyword">not</span> be suitable <span class="keyword">for</span> photosensitive epilepsy.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The compiler will automatically copy your game&#8217;s metadata from your project folder into the resulting game. The contents of the <em>pdxinfo</em> file are accessible via <a href="#f-metadata"><code>playdate.metadata</code></a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Image files are compiled to Playdate <em>.pdi</em> files by the <code>pdc</code> compiler. When referencing images use no extension or the <em>.pdi</em> extension.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">bundleID</div>
<p>A unique identifier for your game, in reverse DNS notation.</p>
</div>
<div class="paragraph">
<div class="title">version</div>
<p>A game version number, formatted any way you wish, that is displayed to players. It is not used to compute when updates should occur.</p>
</div>
<div class="paragraph">
<div class="title">buildNumber</div>
<p>A monotonically-increasing integer value used to indicate a unique version of your game. This can be set using an automated build process like Continuous Integration to avoid having to set the value by hand.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
For sideloaded games, <code>buildNumber</code> is required and is used to determine when a newer version is available to download.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">imagePath</div>
<p>A <em>directory of images</em> that will be used by the launcher.</p>
</div>
<div class="paragraph">
<p>Images should be named as follows:</p>
</div>
<div class="paragraph">
<div class="title"><em>card.png</em></div>
<p>The game’s main card image, visible in the launcher when the view mode is set to "cards". Must be 350 x 155 pixels.</p>
</div>
<div class="paragraph">
<div class="title"><em>card-highlighted/</em></div>
<p>A folder of images that will be played in a loop when your game is selected in the launcher when the view mode is set to "cards". Images should be named <code><em>1.png</em></code>, <code><em>2.png</em></code>, etc. Each image must be 350 x 155 pixels. This folder can optionally contain a text file called <code>animation.txt</code> with the format:</p>
</div>
<div class="listingblock">
<div class="title">animation.txt</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">loopCount = <span class="integer">2</span>
frames = <span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>x4, <span class="integer">4</span>x2, <span class="integer">5</span>, <span class="integer">5</span>
introFrames = <span class="integer">1</span>, <span class="integer">2</span>x2, <span class="integer">3</span>, <span class="integer">4</span>x2</code></pre>
</div>
</div>
<div class="paragraph">
<p>All three lines are optional. <code>loopCount</code> indicates the number of times the animation will repeat (indefinitely by default). <code>frames</code> is the sequence in which the frames will be shown. Add an <code>x#</code> after the frame image number to repeat the image for multiple animation frames. <code>introFrames</code> is a sequence of frames that will play once before the <code>frames</code> sequence begins, when the card is first highlighted. If a frame sequence is not specified, images will play in order from 1 to the last sequentially numbered image found.</p>
</div>
<div class="paragraph">
<div class="title"><em>card-pressed.png</em></div>
<p>Displayed on A button down in the launcher when the view mode is set to "cards". Must be 350 x 155 pixels.</p>
</div>
<div class="paragraph">
<div class="title"><em>icon.png</em></div>
<p>The game’s main icon image, visible in the launcher when the view mode is set to "list". Must be 32 x 32 pixels.</p>
</div>
<div class="paragraph">
<div class="title"><em>icon-highlighted/</em></div>
<p>A folder of images that will be played in a loop when your game is selected in the launcher when the view mode is set to "list". Images should be named <code><em>1.png</em></code>, <code><em>2.png</em></code>, etc. Each image must be 32 x 32 pixels. This folder can optionally contain a text file called <code>animation.txt</code> with same format as described for <em>card-highlighted</em>.</p>
</div>
<div class="paragraph">
<div class="title"><em>icon-pressed.png</em></div>
<p>Displayed on A button down in the launcher when the view mode is set to "list". Must be 32 x 32 pixels.</p>
</div>
<div class="paragraph">
<div class="title"><em>launchImage.png</em></div>
<p>An image that displays while your game is loading, before it is responsive, when the launcher is set to "card" view mode, or in "list" view mode if <em>launchImage-list.png</em> is not provided. Must be fullscreen 400 x 240 pixels, and should not contain transparency. In "card" view mode, this image will be used as the last frame in the game launch animation, if <em>launchImages/</em> are provided.</p>
</div>
<div class="paragraph">
<div class="title"><em>launchImage-list.png</em></div>
<p>An image that displays while your game is loading, before it is responsive, when the launcher is set to "list" view mode. Must be fullscreen 400 x 240 pixels, and should not contain transparency.</p>
</div>
<div class="paragraph">
<div class="title"><em>launchImages/</em></div>
<p>A folder of images (named <em>1.png</em>, <em>2.png</em>, …) that will be played as a transition animation at 20 frames per second when your game is launched when the view mode in the launcher is set to "cards".</p>
</div>
<div class="paragraph">
<p>Images can contain transparency, but should all be 400 x 240 pixels. See the provided sample game <em>Level 1-1</em> for an example. Before the game launch animation your game’s card image (or <em>card-highlighted</em>, or <em>card-pressed</em> image, if available) is drawn by the launcher centered on the screen, drawn in the rect (25, 43, 350, 155) so your animation should assume that image with transparent surrounding space as a starting frame.</p>
</div>
<div class="paragraph">
<div class="title"><em>wrapping-pattern.png</em></div>
<p>Optional, but if present, will be used as the pattern for the wrapping paper on newly-downloaded games that have yet to be unwrapped. The image dimensions should be 400 x 240 pixels. (<a href="./Inside%20Playdate/wrapping-pattern-templates.zip">Template files</a> are available to help you design the wrapping-paper art for your game. This functionality can be tested in the simulator by selecting "Wrap Current Game" from the Playdate menu.)</p>
</div>
<div class="paragraph">
<p>At minimum, all games should include <strong><em>card.png</em></strong>, <strong><em>icon.png</strong> and a <strong>_launchImage.png</em></strong> which will be displayed as the system loads the game.</p>
</div>
<div class="paragraph">
<div class="title">launchSoundPath</div>
<p><em>Optional.</em> Should point to the path of a short audio file to be played as the game launch animation is taking place.</p>
</div>
<div class="paragraph">
<div class="title">contentWarning</div>
<p><em>Optional.</em> A content warning that displays when the user launches your game for the first time. The user will have the option of backing out and not launching your game if they choose.</p>
</div>
<div class="paragraph">
<div class="title">contentWarning2</div>
<p><em>Optional.</em> A <em>second</em> content warning that displays on a second screen when the user launches your game for the first time. The user will have the option of backing out and not launching your game if they choose. Note: <code>contentWarning2</code> will only display if a <code>contentWarning</code> attribute is also specified.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
The string displayed on the content warning screen can only be so long before it will be truncated with an "…" character. Be sure to keep this in mind when designing your <code>contentWarning</code> and <code>contentWarning2</code> text.
</td>
</tr>
</table>
</div>
<div class="imageblock diagram">
<div class="content">
<img src="Inside%20Playdate/content-warning.png" alt="Content warning displayed on Playdate screen" width="400" height="240">
</div>
<div class="title">Figure 4. Content warning displayed on a Playdate&#8217;s screen.</div>
</div>
</div>
<div class="sect2 section">
<h3 id="saving-state">4.7. Saving game state</h3>
<div class="paragraph">
<p>In most games, your users will expect that if they exit your game and come back, they&#8217;ll find the game in the same — or similar — state as when they left it.</p>
</div>
<div class="paragraph">
<p>To implement basic state saving functionality, do the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Write a function that saves pertinent game data into a table.</p>
</li>
<li>
<p>Serialize your table to a <a href="#M-datastore">playdate.datastore</a>. (If you need greater flexibility, you can use any of Playdate&#8217;s <a href="#files">File APIs</a>.)</p>
</li>
<li>
<p>Implement the functions <a href="#c-gameWillTerminate">playdate.gameWillTerminate()</a> and <a href="#c-deviceWillSleep">playdate.deviceWillSleep()</a> and invoke your <code>saveGameData</code> function in each.</p>
</li>
<li>
<p>Write code that executes near the beginning of your game that will load game state data from your <a href="#M-datastore">datastore</a> into a table. Populate your game structures with the saved data in the table.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">An example of basic state saving functionality</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- Some examples of game data</span>
<span class="keyword">local</span> <span class="local-variable">level</span> = <span class="integer">1</span>
<span class="keyword">local</span> <span class="local-variable">health</span> = <span class="integer">100</span>

<span class="comment">-- Function that saves game data</span>
<span class="keyword">function</span> <span class="function">saveGameData</span>()
    <span class="comment">-- Save game data into a table first</span>
    <span class="keyword">local</span> <span class="local-variable">gameData</span> = <span class="map"><span class="delimiter">{</span>
        <span class="key">currentLevel</span> = level,
        <span class="key">currentHealth</span> = health
    <span class="delimiter">}</span></span>
    <span class="comment">-- Serialize game data table into the datastore</span>
    playdate.datastore.write(gameData)
<span class="keyword">end</span>

<span class="comment">-- Automatically save game data when the player chooses</span>
<span class="comment">-- to exit the game via the System Menu or Menu button</span>
<span class="keyword">function</span> playdate.<span class="function">gameWillTerminate</span>()
    saveGameData()
<span class="keyword">end</span>

<span class="comment">-- Automatically save game data when the device goes</span>
<span class="comment">-- to low-power sleep mode because of a low battery</span>
<span class="keyword">function</span> playdate.<span class="function">gameWillSleep</span>()
    saveGameData()
<span class="keyword">end</span>

<span class="comment">-- Call near the start of your game to load saved data</span>
<span class="keyword">local</span> <span class="local-variable">gameData</span> = playdate.datastore.read()
<span class="comment">-- If game data has never been saved, the read value will</span>
<span class="comment">-- be 'nil', so check if the game data exists first</span>
<span class="keyword">if</span> gameData <span class="keyword">then</span>
    <span class="comment">-- Populate game structures with the saved data</span>
    level = gameData.currentLevel
    health = gameData.currentHealth
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="localization">4.8. Localization</h3>
<div class="paragraph">
<p>Localization in Playdate is achieved through the use of string lookup files. Currently, English and Japanese are supported. The files should be called <em>en.strings</em> and <em>jp.strings</em> respectively and should be placed in the root of the game&#8217;s <em>source</em> folder.</p>
</div>
<div class="paragraph">
<p>The format of a <em>.strings</em> file is as follows:</p>
</div>
<div class="literalblock">
<div class="title">Sample en.strings file</div>
<div class="content">
<pre>"greeting" = "Howdy"
"farewell" = "Goodbye"
-- comments are allowed
"video game" = "video game"</pre>
</div>
</div>
<div class="paragraph">
<p>The corresponding <em>jp.strings</em> file would be:</p>
</div>
<div class="literalblock">
<div class="title">Sample jp.strings file</div>
<div class="content">
<pre>"greeting" = "こんにちは"
"farewell" = "さようなら"
-- comments are allowed
"video game" = "ビデオゲーム"</pre>
</div>
</div>
<div class="paragraph">
<p>Refer to the API reference for how to retrieve or draw localized text.</p>
</div>
</div>
<div class="sect2">
<h3 id="_game_size">4.9. Game size</h3>
<div class="paragraph">
<p>Playdate has 4GB of flash storage. While that is a decent amount, it isn&#8217;t inexhaustible.</p>
</div>
<div class="paragraph">
<p>What&#8217;s a good size for a Playdate game? From what we&#8217;ve seen so far, a typical Playdate game might be in the 20-40MB range. Some — primarily those that use synthesized audio — are much smaller, even less than 100KB. Large games with a lot of audio can grow to be 100MB or more.</p>
</div>
<div class="paragraph">
<p>Out of respect for Playdate owners, we ask that you try to keep your games closer to that average size of 20-40MB. (Of course, you can make your game as big as you want — and maybe there is some spectacular 400MB game out there just waiting to be written. Shy of that, however, we — and the Playdate owners you&#8217;re targeting — would prefer it if you keep the size down.)</p>
</div>
<div class="paragraph">
<p>The biggest culprit in blowing up game size is <strong><em>audio</em></strong>. If your game is large due to the inclusion of a lot of audio, we recommend:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensuring your audio is compressed. <a href="#M-sound-prep">See here for some tips</a>.</p>
</li>
<li>
<p>If your audio is already compressed, consider <a href="#C-sound.synth">synthesized audio</a>, using the rich set of APIs provided. Or consider simply using less audio.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1 section">
<h2 id="developing-in-lua">5. Developing in Lua</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Lua is a great language for writing Playdate games. Its easy to use, and enables speedy development. Lua&#8217;s main drawback is performance, including sporadic hits due to garbage collection. For games with moderate performance requirements, these drawbacks should be manageable.</p>
</div>
<div class="paragraph">
<p>Your game can use any of Lua&#8217;s standard features. Please refer to the <a href="http://www.lua.org/manual/5.4/">Lua 5.4 manual</a> for detailed information on the language itself.</p>
</div>
<div class="paragraph">
<p>Our build of the Lua runtime is configured to use 32-bit numbers.</p>
</div>
<div class="sect2">
<h3 id="basic-playdate-game">5.1. A Basic Playdate Game in Lua</h3>
<div class="paragraph">
<p>To showcase basic Playdate API features, we&#8217;ll implement a little game in Lua. (You can code this in C if you want as well — the concepts are similar.) All this game does is display a sprite on a background. The sprite can be moved by pressing on the Playdate&#8217;s d-pad.</p>
</div>
<div class="paragraph">
<p>And that&#8217;s it! But there&#8217;s hopefully enough here to provide a good framework for your own game.</p>
</div>
<div class="listingblock">
<div class="title">A sample Playdate main.lua file.</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- Name this file `main.lua`. Your game can use multiple source files if you wish</span>
<span class="comment">-- (use the `import &quot;myFilename&quot;` command), but the simplest games can be written</span>
<span class="comment">-- with just `main.lua`.</span>

<span class="comment">-- You'll want to import these in just about every project you'll work on.</span>

import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/object</span><span class="delimiter">&quot;</span></span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/graphics</span><span class="delimiter">&quot;</span></span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/sprites</span><span class="delimiter">&quot;</span></span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/timer</span><span class="delimiter">&quot;</span></span>

<span class="comment">-- Declaring this &quot;gfx&quot; shorthand will make your life easier. Instead of having</span>
<span class="comment">-- to preface all graphics calls with &quot;playdate.graphics&quot;, just use &quot;gfx.&quot;</span>
<span class="comment">-- Performance will be slightly enhanced, too.</span>
<span class="comment">-- NOTE: Because it's local, you'll have to do it in every .lua source file.</span>

<span class="keyword">local</span> <span class="local-variable">gfx</span> <span class="error">&lt;</span><span class="local-variable">const</span><span class="error">&gt;</span> = playdate.graphics

<span class="comment">-- Here's our player sprite declaration. We'll scope it to this file because</span>
<span class="comment">-- several functions need to access it.</span>

<span class="keyword">local</span> <span class="local-variable">playerSprite</span> = <span class="predefined-constant">nil</span>

<span class="comment">-- A function to set up our game environment.</span>

<span class="keyword">function</span> <span class="function">myGameSetUp</span>()

    <span class="comment">-- Set up the player sprite.</span>

    <span class="keyword">local</span> <span class="local-variable">playerImage</span> = gfx.image.new(<span class="string"><span class="delimiter">&quot;</span><span class="content">Images/playerImage</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined">assert</span>( playerImage ) <span class="comment">-- make sure the image was where we thought</span>

    playerSprite = gfx.sprite.new( playerImage )
    playerSprite:moveTo( <span class="integer">200</span>, <span class="integer">120</span> ) <span class="comment">-- this is where the center of the sprite is placed; (200,120) is the center of the Playdate screen</span>
    playerSprite:add() <span class="comment">-- This is critical!</span>

    <span class="comment">-- We want an environment displayed behind our sprite.</span>
    <span class="comment">-- There are generally two ways to do this:</span>
    <span class="comment">-- 1) Use setBackgroundDrawingCallback() to draw a background image. (This is what we're doing below.)</span>
    <span class="comment">-- 2) Use a tilemap, assign it to a sprite with sprite:setTilemap(tilemap),</span>
    <span class="comment">--       and call :setZIndex() with some low number so the background stays behind</span>
    <span class="comment">--       your other sprites.</span>

    <span class="keyword">local</span> <span class="local-variable">backgroundImage</span> = gfx.image.new( <span class="string"><span class="delimiter">&quot;</span><span class="content">Images/background</span><span class="delimiter">&quot;</span></span> )
    <span class="predefined">assert</span>( backgroundImage )

    gfx.sprite.setBackgroundDrawingCallback(
        <span class="keyword">function</span>( x, y, width, height )
            <span class="comment">-- x,y,width,height is the updated area in sprite-local coordinates</span>
            <span class="comment">-- The clip rect is already set to this area, so we don't need to set it ourselves</span>
            backgroundImage:draw( <span class="integer">0</span>, <span class="integer">0</span> )
        <span class="keyword">end</span>
    )

<span class="keyword">end</span>

<span class="comment">-- Now we'll call the function above to configure our game.</span>
<span class="comment">-- After this runs (it just runs once), nearly everything will be</span>
<span class="comment">-- controlled by the OS calling `playdate.update()` 30 times a second.</span>

myGameSetUp()

<span class="comment">-- `playdate.update()` is the heart of every Playdate game.</span>
<span class="comment">-- This function is called right before every frame is drawn onscreen.</span>
<span class="comment">-- Use this function to poll input, run game logic, and move sprites.</span>

<span class="keyword">function</span> playdate.<span class="function">update</span>()

    <span class="comment">-- Poll the d-pad and move our player accordingly.</span>
    <span class="comment">-- (There are multiple ways to read the d-pad; this is the simplest.)</span>
    <span class="comment">-- Note that it is possible for more than one of these directions</span>
    <span class="comment">-- to be pressed at once, if the user is pressing diagonally.</span>

    <span class="keyword">if</span> playdate.buttonIsPressed( playdate.kButtonUp ) <span class="keyword">then</span>
        playerSprite:moveBy( <span class="integer">0</span>, <span class="integer">-2</span> )
    <span class="keyword">end</span>
    <span class="keyword">if</span> playdate.buttonIsPressed( playdate.kButtonRight ) <span class="keyword">then</span>
        playerSprite:moveBy( <span class="integer">2</span>, <span class="integer">0</span> )
    <span class="keyword">end</span>
    <span class="keyword">if</span> playdate.buttonIsPressed( playdate.kButtonDown ) <span class="keyword">then</span>
        playerSprite:moveBy( <span class="integer">0</span>, <span class="integer">2</span> )
    <span class="keyword">end</span>
    <span class="keyword">if</span> playdate.buttonIsPressed( playdate.kButtonLeft ) <span class="keyword">then</span>
        playerSprite:moveBy( <span class="integer">-2</span>, <span class="integer">0</span> )
    <span class="keyword">end</span>

    <span class="comment">-- Call the functions below in playdate.update() to draw sprites and keep</span>
    <span class="comment">-- timers updated. (We aren't using timers in this example, but in most</span>
    <span class="comment">-- average-complexity games, you will.)</span>

    gfx.sprite.update()
    playdate.timer.updateTimers()

<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Playdate&#8217;s API is exposed in a Lua namespace called <code>playdate</code>.  Our API is explained in detail <a href="#api-reference">later in this document</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_playdate_lua_api_conventions">5.2. Playdate Lua API conventions</h3>
<div class="sect3">
<h4 id="_arrays">Arrays</h4>
<div class="paragraph">
<p>By convention, Lua arrays are 1-indexed. It is recommended that you follow this idiom to avoid confusion with other Lua code. (Arrays are in fact implemented as a specialized form of tables, which are the only container type in Lua. One of the most notable consequences of this is that arrays cannot contain nil values, since a nil value represents the end of the array.)</p>
</div>
</div>
<div class="sect3">
<h4 id="_calling_functions">Calling functions</h4>
<div class="paragraph">
<p><strong><em>Class/table functions</em></strong> are invoked with a <em>period</em>, as in <code>myTable.function(a, b, c)</code>.</p>
</div>
<div class="paragraph">
<p><strong><em>Instance functions</em></strong> are invoked with a <em>colon</em>, as in <code>myObject:function(a, b, c)</code>.</p>
</div>
<div class="paragraph">
<p>Why is this? The colon version passes the table itself as an implicit first argument to the function.  This is generally used to simulate the object-oriented programming concept of "self" in Lua, which does not have "objects", "classes" or any other OOP affordances built-in. Again, we recommend you review the <a href="https://www.lua.org/manual/5.4/">official Lua 5.4 reference manual</a> to make sure you understand the difference. Playdate, through CoreLibs, provides a simple implementation of Lua "objects" which you can choose to use or not use as you see fit.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Confusing these two invocation methods can result in very-difficult-to-track-down bugs, so be careful!
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_return_values">Return values</h4>
<div class="paragraph">
<p>Some APIs return <em>objects</em> and others return a list of scalar values. Make sure you know what type of value is being returned! To make things even more confusing, some "objects" are Lua tables but others are Lua <em>userdata</em> that can have metamethods defined to provide table-like access to properties.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- returns a rect object</span>
r1 = playdate.geometry.rect.new(<span class="integer">5</span>, <span class="integer">5</span>, <span class="integer">10</span>, <span class="integer">10</span>)
r2 = playdate.geometry.rect.new(<span class="integer">8</span>, <span class="integer">8</span>, <span class="integer">10</span>, <span class="integer">10</span>)
intersection = r1:intersection(r2)
<span class="predefined">print</span>(intersection.x, intersection.y, intersection.width, intersection.height)

<span class="comment">-- returns a rect using a list of return values</span>
x, y, w, h = playdate.geometry.rect.fast_intersection(<span class="integer">5</span>, <span class="integer">8</span>, <span class="integer">5</span>, <span class="integer">8</span>, <span class="integer">10</span>, <span class="integer">10</span>, <span class="integer">10</span>, <span class="integer">10</span>)
<span class="predefined">print</span>(x, y, w, h)</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
You can use the Lua function <code>table.unpack(table)</code> to turn any table&#8217;s values into a list.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="lua-tips">5.3. Lua Tips</h3>
<div class="sect3">
<h4 id="_initialize_variables_with_local">Initialize variables with <code>local</code></h4>
<div class="paragraph">
<p>You should almost always use <code>local</code> in your variable initializers to narrow your variable&#8217;s scope to the current block. Not doing this will perhaps unnecessarily broaden your variable&#8217;s scope. Also, globals are slower to access during runtime than locals.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">function</span> MyClass:<span class="function">myFunction</span>(a, b, c)

    <span class="comment">-- You probably want to do this:</span>
    <span class="keyword">local</span> <span class="local-variable">x</span>, <span class="local-variable">y</span>, <span class="local-variable">z</span> = a*a, b*b, c*c

    <span class="comment">-- …and not this. Here, x, y, and z are defined as globals.</span>
    x, y, z = a*a, b*b, c*c

    <span class="keyword">return</span> x, y, z
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_assign_frequently_used_objects_to_local_variables">Assign frequently-used objects to local variables</h4>
<div class="paragraph">
<p>If you are frequently accessing playdate API objects like <code>playdate.graphics</code>, performance will increase by assigning that object to a local variable at the beginning of your source file. (It&#8217;ll also make your code less verbose.) So instead of this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">playdate.graphics.setColor(playdate.graphics.kColorWhite)
playdate.graphics.drawRect(<span class="integer">14</span>, <span class="integer">14</span>, <span class="integer">22</span>, <span class="integer">22</span>)
playdate.graphics.setColor(playdate.graphics.kColorBlack)
playdate.graphics.fillRect(<span class="integer">15</span>, <span class="integer">15</span>, <span class="integer">20</span>, <span class="integer">20</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Do this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">gfx</span> <span class="error">&lt;</span><span class="local-variable">const</span><span class="error">&gt;</span> = playdate.graphics <span class="comment">-- do this at the top of your source file</span>
<span class="comment">-- (&lt;const&gt; is a Lua constant declaration that will improve performance slightly)</span>

...

gfx.setColor(gfx.kColorWhite)
gfx.drawRect(<span class="integer">14</span>, <span class="integer">14</span>, <span class="integer">22</span>, <span class="integer">22</span>)
gfx.setColor(gfx.kColorBlack)
gfx.fillRect(<span class="integer">15</span>, <span class="integer">15</span>, <span class="integer">20</span>, <span class="integer">20</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>...and you&#8217;ll only be doing <em>one</em> look-up of the <code>playdate</code> and <code>graphics</code> objects in the global namespace, instead of six.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_object_oriented_programming_in_lua">5.4. Object-oriented programming in Lua</h3>
<div class="paragraph">
<p>Lua does not offer built-in support for object-oriented programming of any kind.  Some developers like to use language extensions to provide an "OOP-like" environment, but you should have an understanding of what is happening behind the scenes.</p>
</div>
<div class="paragraph">
<p>This is purely a personal preference. There is no need for you to use object-oriented programming techniques, unless you want to.</p>
</div>
<div class="paragraph">
<p>CoreLibs provides a basic object-oriented class system. <strong><em>Object</em></strong> is the base class all new subclasses inherit from.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/object</em> to use these functions.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>New Object subclasses can be created as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">class(ClassName, [properties], [namespace]).extends(ParentClass)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>properties</code> is a table of default key/value pairs for the class. If a parent class is not provided, Object will be used.</p>
</div>
<div class="paragraph">
<p>So, to create a <code>Tree</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">class(<span class="string"><span class="delimiter">'</span><span class="content">Tree</span><span class="delimiter">'</span></span>).extends()</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">class(<span class="string"><span class="delimiter">'</span><span class="content">Tree</span><span class="delimiter">'</span></span>, <span class="map"><span class="delimiter">{</span><span class="key">color</span> = <span class="string"><span class="delimiter">'</span><span class="content">Brown</span><span class="delimiter">'</span></span><span class="delimiter">}</span></span>).extends(Object)</code></pre>
</div>
</div>
<div class="paragraph">
<p>And to create a subclass of <code>Tree</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">class(<span class="string"><span class="delimiter">'</span><span class="content">Oak</span><span class="delimiter">'</span></span>).extends(Tree)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Classes are provided with an <strong><em>init</em></strong> function. The subclass decides how many and what type of arguments its init function takes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">function</span> Oak:<span class="function">init</span>(age, height)
    Oak.super.init(self, age)
    self.height = height
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The init function will normally want to call its superclass&#8217;s implementation of init and must use the syntax above. (Calling <code>Oak.super:init(age)</code> would pass <em>super</em> as self, which will lead to incorrect behavior.)</p>
</div>
<div class="paragraph">
<p>Instances of a class are created by calling the class as a function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">oakInstance = Oak(age, height)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Class names can be accessed via the <strong><em>className</em></strong> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">oakInstance.className <span class="comment">-- equals 'Oak'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The base Object class defines an <code>isa()</code> function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">oakInstance:isa(Tree) <span class="comment">-- returns true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A debugging function <code>Object:tableDump([indent], [table])</code> is provided to print all key/value pairs from the object and its superclasses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">oakInstance:tableDump()</code></pre>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="_corelibs">5.5. CoreLibs</h3>
<div class="paragraph">
<p>In addition to the default Playdate functions, a set of optional utility libraries named <strong><em>CoreLibs</em></strong> is available for you to use. CoreLibs provides functionality for such things as managing sprites, handling timers, animation curves, collision detection, and more.</p>
</div>
<div class="paragraph">
<p>CoreLibs is itself written in Lua and can be inspected in the SDK in the <em>CoreLibs</em> directory. Documentation for each of the CoreLibs is detailed later in this document. Use of each of the CoreLibs requires an <code>import "CoreLibs/[nameOfLibrary]"</code> in your game source file, and will be noted when necessary.</p>
</div>
</div>
</div>
</div>
<div class="sect1 section">
<h2 id="developing-in-c">6. Developing in C</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If your Playdate game requires maximum performance, C is the best choice.</p>
</div>
<div class="paragraph">
<p>Parts of your game, or the entire game if desired, can be written in C using the Playdate C API. For details, see <a href="./Inside%20Playdate%20with%20C.html">Inside Playdate with C</a>. There are also a few examples in the C_API/Examples folder that should help get you started.</p>
</div>
<div class="paragraph">
<p>We are still in the process of adding more functions to the C API, and creating more examples.</p>
</div>
</div>
</div>
<div class="sect1 section">
<h2 id="api-reference">7. API reference</h2>
<div class="sectionbody">
<div class="sect2 section">
<h3 id="playdate-sdk-lua-enhancements">7.1. Playdate SDK Lua enhancements</h3>
<div class="sect3">
<h4 id="additional-assignment-operators">Additional assignment operators</h4>
<div class="paragraph">
<p>Lua does not by default support assignment operators like <code>+=</code> and <code>-=</code> that are common in other languages. As a convenience for developers, the Playdate SDK adds the following:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Addition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subtraction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiplication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Division</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>//=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer division</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modulo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;&lt;=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shift left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;&gt;=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shift right</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bitwise AND</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bitwise OR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exponent (not bitwise XOR)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3 section">
<h4 id="table-additions">Table additions</h4>
<div class="paragraph">
<p>The Playdate SDK offers some convenience functions for handling Lua tables, beyond what is available in Lua itself:</p>
</div>
<div id="t-table.indexOfElement" class="openblock item function">
<div class="title">table.indexOfElement(table, element)</div>
<div class="content">
<div class="paragraph">
<p>Returns the first index of <em>element</em> in the given array-style table. If the table does not contain <em>element</em>, the function returns nil.</p>
</div>
</div>
</div>
<div id="t-table.getsize" class="openblock item function">
<div class="title">table.getsize(table)</div>
<div class="content">
<div class="paragraph">
<p>Returns the size of the given table as multiple values (<em>arrayCount</em>, <em>hashCount</em>).</p>
</div>
</div>
</div>
<div id="t-table.create" class="openblock item function">
<div class="title">table.create(arrayCount, hashCount)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new Lua table with the array and hash parts preallocated to accommodate <em>arrayCount</em> and <em>hashCount</em> elements respectively.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If you can make a decent estimation of how big your table will need to be, <code>table.create()</code> can be much more efficient than the alternative, especially in loops. For example, if you know your array is always going to contain approximately ten elements, say <code>myArray = table.create( 10, 0 )</code> instead of <code>myArray = {}</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="t-table.shallowcopy" class="openblock item function">
<div class="title">table.shallowcopy(source, [destination])</div>
<div class="content">
<div class="paragraph">
<p><code>shallowcopy</code> returns a shallow copy of the <em>source</em> table. If a <em>destination</em> table is provided, it copies the contents of <em>source</em> into <em>destination</em> and returns <em>destination</em>. The copy will contain references to any nested tables.</p>
</div>
</div>
</div>
<div id="t-table.deepcopy" class="openblock item function">
<div class="title">table.deepcopy(source)</div>
<div class="content">
<div class="paragraph">
<p><code>deepcopy</code> returns a deep copy of the <em>source</em> table. The copy will contain copies of any nested tables.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="system-and-game-metadata">7.2. System and Game Metadata</h3>
<div id="f-apiVersion" class="openblock item function">
<div class="title">playdate.apiVersion()</div>
<div class="content">
<div class="paragraph">
<p>Returns two values, the current API version of the Playdate runtime and the minimum API version supported by the runtime.</p>
</div>
</div>
</div>
<div id="f-metadata" class="openblock item function">
<div class="title">playdate.metadata</div>
<div class="content">
<div class="paragraph">
<p>The <code>playdate.metadata</code> table contains the values in the current game&#8217;s <a href="#pdxinfo">pdxinfo</a> file, keyed by variable name. To retrieve the version number of the game, for example, you would use <code>playdate.metadata.version</code>.</p>
</div>
<div class="paragraph">
<p>Changing values in this table at run time has no effect.</p>
</div>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="game-flow">7.3. Game flow</h3>
<div class="sect3">
<h4 id="_callbacks">Callbacks</h4>
<div id="c-update" class="openblock item callback">
<div class="title">playdate.update()</div>
<div class="content">
<div class="paragraph">
<p>Implement this callback and Playdate OS will call it once per frame. This is the place to put the main update-and-draw code for your game. Playdate will attempt to call this function by default 30 times per second; that value can be changed by calling <a href="#f-display.setRefreshRate">playdate.display.setRefreshRate()</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If your <code>update()</code> function takes too long to execute, Playdate OS may not be able to call it as often as specified by the current refresh rate. In this case, Playdate OS will simply try and call it as often as it can, with a not-to-exceed rate of <a href="#f-display.getRefreshRate">playdate.display.getRefreshRate()</a> frames per second.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_coroutines_and_playdate_update">Coroutines and playdate.update()</h5>
<div class="paragraph">
<p>If you are familiar with <a href="https://www.lua.org/pil/9.1.html">Lua coroutines</a>, it&#8217;s useful to know that <code>playdate.update()</code> is invoked as a coroutine. This allows you to call <code>coroutine.yield()</code> during execution of lengthy processes inside <code>update()</code>, facilitating more frequent screen updates by Playdate OS.</p>
</div>
<div class="paragraph">
<p>For example, while loading assets at the beginning of execution, you could use coroutines to aid in displaying a progress bar:</p>
</div>
<div class="listingblock">
<div class="title">Example: How to use coroutine.yield() in playdate.update().</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">allImagesProcessed</span> = <span class="predefined-constant">false</span>

<span class="comment">-- our main update function, called every 0.033 seconds by Playdate OS.</span>
<span class="keyword">function</span> playdate.<span class="function">update</span>()

    <span class="keyword">if</span> allImagesProcessed == <span class="predefined-constant">false</span> <span class="keyword">then</span>

        <span class="comment">-- process images</span>
        <span class="keyword">for</span> i = <span class="integer">1</span>, #images <span class="keyword">do</span>

            <span class="comment">-- some time-consuming process…</span>
            processImage( images[i] )

            <span class="comment">-- draw a progress bar</span>
            <span class="keyword">local</span> <span class="local-variable">progressPercentage</span> = i / #images
            playdate.graphics.fillRect( <span class="integer">100</span>, <span class="integer">20</span>, <span class="integer">200</span>*progressPercentage, <span class="integer">40</span> )

            <span class="comment">-- yield to the OS, giving it a chance to update the screen</span>
            coroutine.yield()

            <span class="comment">-- execution will resume here when the OS calls coroutine.resume()</span>

        <span class="keyword">end</span>

        allImagesProcessed = <span class="predefined-constant">true</span>

    <span class="keyword">else</span>

        <span class="comment">-- main game update and drawing code</span>

    <span class="keyword">end</span>

<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As an exercise, it&#8217;s worth removing the <code>coroutine.yield()</code> call from the above code to see how its execution differs. (Spoiler: all images will be processed before there are any screen redraws, rendering the progress bar useless.) It&#8217;s also an interesting exercise to attempt code that performs the same as above without use of the <code>.yield()</code> function. In this simple case it&#8217;s not terribly difficult — you need to save off your loop&#8217;s state after each iteration — but the code is messier, and it can quickly get unwieldy in more complex cases. <code>.yield()</code> makes things much easier.</p>
</div>
<div class="paragraph">
<p>For more on coroutine usage in games, <a href="https://edw.is/how-to-implement-action-sequences-and-cutscenes/#coroutines-basics">view this tutorial</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_functions">Functions</h4>
<div id="f-wait" class="openblock item function">
<div class="title">playdate.wait(milliseconds)</div>
<div class="content">
<div class="paragraph">
<p>Suspends callbacks to <a href="#c-update"><code>playdate.update()</code></a> for the specified number of milliseconds.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<code>playdate.wait()</code> is ideal for pausing game execution to, for example, show a message to the player. Because <code>.update()</code> will not be called, the screen will freeze during <code>.wait()</code>. Audio will continue to play. Animation during this wait period is possible, but you will need to explicitly call <a href="#f-display.flush"><code>playdate.display.flush()</code></a> once per frame.
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
While timers should pause during <code>playdate.wait()</code> (assuming <a href="#f-timer.updateTimers"><code>playdate.timer.updateTimers()</code></a> and <a href="#f-frameTimer.updateTimers"><code>playdate.frameTimer.updateTimers()</code></a> are invoked during <code>playdate.update()</code>), <a href="#C-graphics.animator">animators</a> will <em>not</em> pause during <code>playdate.wait()</code>. Be sure to account for this in your code.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-stop" class="openblock item function">
<div class="title">playdate.stop()</div>
<div class="content">
<div class="paragraph">
<p>Stops per-frame callbacks to <a href="#c-update">playdate.update()</a>. Useful in conjunction with <a href="#f-display.flush">playdate.display.flush()</a> if your program only does things in response to button presses.</p>
</div>
</div>
</div>
<div id="f-start" class="openblock item function">
<div class="title">playdate.start()</div>
<div class="content">
<div class="paragraph">
<p>Resumes per-frame callbacks to <a href="#c-update">playdate.update()</a>.</p>
</div>
</div>
</div>
<div id="f-restart" class="openblock item function">
<div class="title">playdate.restart(arg)</div>
<div class="content">
<div class="paragraph">
<p>Reinitializes the Playdate runtime and restarts the currently running game. The optional string <code>arg</code> passed in is available after restart in <a href="#v-argv">playdate.argv</a> as if it had been passed in on the command line when launching the simulator. The <code>arg</code> string will be split on spaces, but respecting quotes, when added to the argv list.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="game-lifecycle">7.4. Game lifecycle</h3>
<div id="c-gameWillTerminate" class="openblock item callback">
<div class="title">playdate.gameWillTerminate()</div>
<div class="content">
<div class="paragraph">
<p>Called when the player chooses to exit the game via the System Menu or Menu button.</p>
</div>
</div>
</div>
<div id="c-deviceWillSleep" class="openblock item callback">
<div class="title">playdate.deviceWillSleep()</div>
<div class="content">
<div class="paragraph">
<p>Called before the device goes to low-power sleep mode because of a low battery.</p>
</div>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
If your game saves its state, <code>playdate.gameWillTerminate()</code> and <code>playdate.deviceWillSleep()</code> are good opportunities to do it.
</td>
</tr>
</table>
</div>
<div id="c-deviceWillLock" class="openblock item callback">
<div class="title">playdate.deviceWillLock()</div>
<div class="content">
<div class="paragraph">
<p>If your game is running on the Playdate when the device is locked, this function will be called. Implementing this function allows your game to take special action when the Playdate is locked, e.g., saving state.</p>
</div>
</div>
</div>
<div id="c-deviceDidUnlock" class="openblock item callback">
<div class="title">playdate.deviceDidUnlock()</div>
<div class="content">
<div class="paragraph">
<p>If your game is running on the Playdate when the device is unlocked, this function will be called.</p>
</div>
</div>
</div>
<div id="c-gameWillPause" class="openblock item callback">
<div class="title">playdate.gameWillPause()</div>
<div class="content">
<div class="paragraph">
<p>Called before the system pauses the game. (In the current version of Playdate OS, this only happens when the device&#8217;s Menu button is pushed.) Implementing these functions allows your game to take special action when it is paused, e.g., updating the <a href="#f-setMenuImage">menu image</a>.</p>
</div>
</div>
</div>
<div id="c-gameWillResume" class="openblock item callback">
<div class="title">playdate.gameWillResume()</div>
<div class="content">
<div class="paragraph">
<p>Called before the system resumes the game.</p>
</div>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="system-menu">7.5. Interacting with the System Menu</h3>
<div class="paragraph">
<p>Your game can add up to three menu items to the System Menu. Three types of menu items are supported: normal action menu items, checkmark menu items, and options menu items.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
When titling your System Menu additions, try to give them names that demonstrate that they pertain to your game, and not Playdate overall. For example, the title "restart game" will be clearer to the player than just "restart" — the player might assume the latter will restart the hardware.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">menu</span> = playdate.getSystemMenu()

<span class="keyword">local</span> <span class="local-variable">menuItem</span>, <span class="local-variable">error</span> = menu:addMenuItem(<span class="string"><span class="delimiter">&quot;</span><span class="content">Item 1</span><span class="delimiter">&quot;</span></span>, <span class="keyword">function</span>()
    <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Item 1 selected</span><span class="delimiter">&quot;</span></span>)
<span class="keyword">end</span>)

<span class="keyword">local</span> <span class="local-variable">checkmarkMenuItem</span>, <span class="local-variable">error</span> = menu:addCheckmarkMenuItem(<span class="string"><span class="delimiter">&quot;</span><span class="content">Item 2</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">true</span>, <span class="keyword">function</span>(value)
    <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Checkmark menu item value changed to: </span><span class="delimiter">&quot;</span></span>, value)
<span class="keyword">end</span>)</code></pre>
</div>
</div>
<div id="f-menu.getSystemMenu" class="openblock item function">
<div class="title">playdate.getSystemMenu()</div>
<div class="content">
<div class="paragraph">
<p>Returns a <code>playdate.menu</code> object. Use this to add your custom menu items.</p>
</div>
</div>
</div>
<div id="m-menu.addMenuItem" class="openblock item method">
<div class="title">playdate.menu:addMenuItem(title, callback)</div>
<div class="content">
<div class="paragraph">
<p><em>title</em> will be the title displayed by the menu item.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>When this menu item is selected, the OS will:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Hide the System Menu.</p>
</li>
<li>
<p>Invoke your <code>callback</code> function.</p>
</li>
<li>
<p>Unpause your game and call <a href="#c-gameWillResume">playdate.gameWillResume</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the returned <a href="#menu-item">playdate.menu.item</a> is nil, a second <code>errorMessage</code> return value will indicate the reason the operation failed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Playdate OS allows a maximum of <strong>three</strong> custom menu items to be added to the System Menu.
</td>
</tr>
</table>
</div>
<div id="m-menu.addCheckmarkMenuItem" class="openblock item method">
<div class="title">playdate.menu:addCheckmarkMenuItem(title, [initialValue], callback)</div>
<div class="content">
<div class="paragraph">
<p>Creates a new menu item that can be checked or unchecked by the player.</p>
</div>
<div class="paragraph">
<p><em>title</em> will be the title displayed by the menu item.</p>
</div>
<div class="paragraph">
<p><em>initialValue</em> can be set to <code>true</code> or <code>false</code>, indicating the checked state of the menu item. Optional, defaults to <code>false</code>.</p>
</div>
<div class="paragraph">
<p>If this menu item is interacted with while the system menu is open, <em>callback</em> will be called when the menu is closed, before <a href="#c-gameWillResume">playdate.gameWillResume</a> is called. The callback function will be passed one argument, a boolean value, indicating the current value of the menu item.</p>
</div>
<div class="paragraph">
<p>If the returned <a href="#menu-item">playdate.menu.item</a> is nil, a second <code>errorMessage</code> return value will indicate the reason the operation failed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Playdate OS allows a maximum of <strong>three</strong> custom menu items to be added to the System Menu.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-menu.addOptionsMenuItem" class="openblock item method">
<div class="title">playdate.menu:addOptionsMenuItem(title, options, [initalValue], callback)</div>
<div class="content">
<div class="paragraph">
<p>Creates a menu item that allows the player to cycle through a set of options.</p>
</div>
<div class="paragraph">
<p><em>title</em> will be the title displayed by the menu item.</p>
</div>
<div class="paragraph">
<p><em>options</em> should be an array-style table of strings representing the states the menu item can have. Due to limited horizontal space, the option strings and title should be kept short for this type of menu item.</p>
</div>
<div class="paragraph">
<p><em>initialValue</em> can optionally be set to any of the values in the options array.</p>
</div>
<div class="paragraph">
<p>If the value of this menu item is changed while the system menu is open, <em>callback</em> will be called when the menu is closed, before <a href="#c-gameWillResume">playdate.gameWillResume</a> is called. The callback function will be passed one string argument indicating the currently selection option.</p>
</div>
<div class="paragraph">
<p>If the returned <a href="#menu-item">playdate.menu.item</a> is nil, a second <code>errorMessage</code> return value will indicate the reason the operation failed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Playdate OS allows a maximum of <strong>three</strong> custom menu items to be added to the System Menu.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-menu.getMenuItems" class="paragraph item method">
<div class="title">playdate.menu:getMenuItems()</div>
<p>Returns an array-style table containing all <a href="#menu-item">playdate.menu.item</a>s your game has added to the menu.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Items that were added to the System Menu by the operating system will not be returned via <code>getMenuItems()</code>, or via any other method call.
</td>
</tr>
</table>
</div>
<div id="m-menu.removeMenuItem" class="openblock item method">
<div class="title">playdate.menu:removeMenuItem(menuItem)</div>
<div class="content">
<div class="paragraph">
<p>Removes the specified <a href="#menu-item">playdate.menu.item</a> from the menu.</p>
</div>
</div>
</div>
<div id="m-menu.removeAllMenuItems" class="openblock item method">
<div class="title">playdate.menu:removeAllMenuItems()</div>
<div class="content">
<div class="paragraph">
<p>Removes from the referenced menu object all <a href="#menu-item">playdate.menu.item</a>s added by your game.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Items that were added to the System Menu by the operating system cannot be removed by this operation, or any other.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-setMenuImage" class="openblock item function">
<div class="title">playdate.setMenuImage(image, [xOffset])</div>
<div class="content">
<div class="paragraph">
<p>While the game is paused it can optionally provide an image to be displayed alongside the System Menu. Use this function to set that image.</p>
</div>
<div class="paragraph">
<p><em>image</em> should be a 400 x 240 pixel <a href="#C-graphics.image">playdate.graphics.image</a>. All important content should be in the left half of the image in an area 200 pixels wide, as the menu will obscure the rest. The right side of the image will be visible briefly as the menu animates in and out.</p>
</div>
<div class="paragraph">
<p>Optionally, <em>xOffset</em> can be provided which must be a number between 0 and 200 and will cause the menu image to animate to a position offset left by <em>xOffset</em> pixels as the menu is animated in.</p>
</div>
<div class="paragraph">
<p>To remove a previously-set menu image, pass <code>nil</code> for the <em>image</em> argument.</p>
</div>
</div>
</div>
<div class="sect3 section">
<h4 id="menu-item">Menu Item operations</h4>
<div id="m-menu.item.setCallback" class="openblock item method">
<div class="title">playdate.menu.item:setCallback(callback)</div>
<div class="content">
<div class="paragraph">
<p>Sets the callback function for this menu item.</p>
</div>
</div>
</div>
<div id="m-menu.item.setTitle" class="openblock item method">
<div class="title">playdate.menu.item:setTitle(newTitle)</div>
<div class="content">
<div class="paragraph">
<p>Sets the title displayed for this menu item.</p>
</div>
<div class="paragraph">
<p>The <code>title</code> for a menu item can also be set using dot syntax.</p>
</div>
</div>
</div>
<div id="m-menu.item.getTitle" class="openblock item method">
<div class="title">playdate.menu.item:getTitle()</div>
<div class="content">
<div class="paragraph">
<p>Returns the title displayed for this menu item.</p>
</div>
</div>
</div>
<div id="m-menu.item.setValue" class="openblock item method">
<div class="title">playdate.menu.item:setValue(newValue)</div>
<div class="content">
<div class="paragraph">
<p>Sets the value for this menu item. The value is of a different type depending on the type of menu item:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>normal: integer</p>
</li>
<li>
<p>checkmark: boolean</p>
</li>
<li>
<p>options: string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Values for any menu type can also be set using integers.</p>
</div>
<div class="paragraph">
<p>The <code>value</code> for a menu item can also be set using dot syntax.</p>
</div>
</div>
</div>
<div id="m-menu.item.getValue" class="openblock item method">
<div class="title">playdate.menu.item:getValue()</div>
<div class="content">
<div class="paragraph">
<p>Returns the value for this menu item.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_localization">7.6. Localization</h3>
<div id="f-getSystemLanguage" class="openblock item function">
<div class="title">playdate.getSystemLanguage()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current language of the system, which will be one of the constants <em>playdate.graphics.font.kLanguageEnglish</em> or
<em>playdate.graphics.font.kLanguageJapanese</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-accessibility">7.7. Accessibility</h3>
<div id="f-getReduceFlashing" class="openblock item function">
<div class="title">playdate.getReduceFlashing()</div>
<div class="content">
<div class="paragraph">
<p>Returns <em>true</em> if the user has checked the "Reduce Flashing" option in Playdate Settings; <em>false</em> otherwise. Games should read this value and, if <em>true</em>, avoid visuals that could be problematic for people with sensitivities to flashing lights or patterns.</p>
</div>
</div>
</div>
<div id="f-getFlipped" class="openblock item function">
<div class="title">playdate.getFlipped()</div>
<div class="content">
<div class="paragraph">
<p>Returns <em>true</em> if the user has checked the "Upside Down" option in Playdate Settings; <em>false</em> otherwise. (Upside Down mode can be convenient for players wanting to hold Playdate upside-down so they can use their left hand to operate the crank.)</p>
</div>
<div class="paragraph">
<p>Typically your game doesn&#8217;t need to anything in regards to this setting. But it is available in case your game wants to take some special actions, display special instructions, etc.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Reported d-pad directions are flipped when in Upside Down mode — RIGHT will be reported as LEFT, UP as DOWN, etc. — so that the d-pad will make sense to a user holding Playdate upside-down. However, the A and B buttons — since they are still labeled as "A" and "B" — retain their normal meanings and will be reported as usual.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="accelerometer">7.8. Accelerometer</h3>
<div id="f-startAccelerometer" class="openblock item function">
<div class="title">playdate.startAccelerometer()</div>
<div class="content">
<div class="paragraph">
<p>The accelerometer is off by default, to save a bit of power. If you will be using the accelerometer in your game, you&#8217;ll first need to call <code>playdate.startAccelerometer()</code> then wait for the next update cycle before reading its values. If you won&#8217;t be using the accelerometer again for a while, calling <code>playdate.stopAccelerometer()</code> will put it back into a low-power idle state.</p>
</div>
</div>
</div>
<div id="f-stopAccelerometer" class="openblock item function">
<div class="title">playdate.stopAccelerometer()</div>
<div class="content">
<div class="paragraph">
<p>Puts the accelerometer into a low-power idle state. (Though, to be honest, the accelerometer draws so little power when it&#8217;s running you&#8217;d never notice the difference.)</p>
</div>
</div>
</div>
<div id="f-readAccelerometer" class="openblock item function">
<div class="title">playdate.readAccelerometer()</div>
<div class="content">
<div class="paragraph">
<p>If the accelerometer has been turned on with <a href="#f-startAccelerometer">playdate.startAccelerometer()</a>, returns the x, y, and z values from the accelerometer as a list. Positive x points right, positive y points to the bottom of the screen, and positive z points through the screen away from the viewer. For example, with the device held upright this function returns the values (0,1,0). With it flat on its back, it returns (0,0,1).</p>
</div>
</div>
</div>
<div id="f-accelerometerIsRunning" class="openblock item function">
<div class="title">playdate.accelerometerIsRunning()</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the accelerometer is currently running.</p>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example: A simple ball rolling demo using the accelerometer</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- You can copy and paste this example directly as your main.lua file to see it in action</span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/graphics</span><span class="delimiter">&quot;</span></span>

<span class="keyword">local</span> <span class="keyword">function</span> <span class="function">clamp</span>(value, min, max)
    <span class="keyword">return</span> math.max(math.min(value, max), min)
<span class="keyword">end</span>

<span class="keyword">local</span> <span class="local-variable">x</span>, <span class="local-variable">y</span> = <span class="integer">200</span>, <span class="integer">120</span>
<span class="comment">-- Make sure to start the accelerometer to begin reading!</span>
playdate.startAccelerometer()

<span class="comment">-- A simple example of rolling around a ball on the screen using the accelerometer</span>
<span class="keyword">function</span> playdate.<span class="function">update</span>()
    playdate.graphics.clear()

    <span class="comment">-- We can get the accelerometer values by storing them in multiple variables</span>
    <span class="keyword">local</span> <span class="local-variable">gravityX</span>, <span class="local-variable">gravityY</span>, <span class="local-variable">_gravityZ</span> = playdate.readAccelerometer()

    <span class="comment">-- Try orienting the Playdate flat and tilting it around</span>
    x = clamp(x + gravityX * <span class="integer">10</span>, <span class="integer">0</span>, <span class="integer">400</span>)
    y = clamp(y + gravityY * <span class="integer">10</span>, <span class="integer">0</span>, <span class="integer">240</span>)
    playdate.graphics.fillCircleAtPoint(x, y, <span class="integer">10</span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="buttons">7.9. Buttons</h3>
<div class="paragraph">
<p>There are several different methods for determining button presses.</p>
</div>
<div class="sect3">
<h4 id="_querying_buttons_directly">Querying buttons directly</h4>
<div id="f-buttonIsPressed" class="openblock item function">
<div class="title">playdate.buttonIsPressed(button)</div>
<div class="content">
<div class="paragraph">
<p>Returns true if <em>button</em> is currently being pressed.</p>
</div>
<div class="paragraph">
<p><em>button</em> should be one of the constants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.kButtonA</em></p>
</li>
<li>
<p><em>playdate.kButtonB</em></p>
</li>
<li>
<p><em>playdate.kButtonUp</em></p>
</li>
<li>
<p><em>playdate.kButtonDown</em></p>
</li>
<li>
<p><em>playdate.kButtonLeft</em></p>
</li>
<li>
<p><em>playdate.kButtonRight</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Or one of the strings "a", "b", "up", "down", "left", "right".</p>
</div>
</div>
</div>
<div id="f-buttonJustPressed" class="openblock item function">
<div class="title">playdate.buttonJustPressed(button)</div>
<div class="content">
<div class="paragraph">
<p>Returns true for <em>just one update cycle</em> if <em>button</em> was pressed. <code>buttonJustPressed</code> will not return true again until the button is released and pressed again. This is useful for, say, a player "jump" action, so the jump action is taken only once and not on every single update.</p>
</div>
<div class="paragraph">
<p><em>button</em> should be one of the constants listed in <a href="#f-buttonIsPressed">playdate.buttonIsPressed()</a></p>
</div>
</div>
</div>
<div id="f-buttonJustReleased" class="openblock item function">
<div class="title">playdate.buttonJustReleased(button)</div>
<div class="content">
<div class="paragraph">
<p>Returns true for <em>just one update cycle</em> if <em>button</em> was released. <code>buttonJustReleased</code> will not return true again until the button is pressed and released again.</p>
</div>
<div class="paragraph">
<p><em>button</em> should be one of the constants listed in <a href="#f-buttonIsPressed">playdate.buttonIsPressed()</a></p>
</div>
</div>
</div>
<div id="f-getButtonState" class="openblock item function">
<div class="title">playdate.getButtonState()</div>
<div class="content">
<div class="paragraph">
<p>Returns the above data in one call, with multiple return values (<em>current</em>, <em>pressed</em>, <em>released</em>) containing bitmasks indicating which buttons are currently down, and which were pressed and released since the last update. For example, if the d-pad left button and the A button are both down, the <em>current</em> value will be (<em>playdate.kButtonA</em>|<em>playdate.kButtonLeft</em>).</p>
</div>
</div>
</div>
<div id="f-setButtonQueueSize" class="openblock item function">
<div class="title">playdate.setButtonQueueSize(size)</div>
<div class="content">
<div class="paragraph">
<p>When set, button up/down events on the D pad and the A and B buttons are added to a list instead of simply polled at the beginning of a frame, allowing the code to handle multiple taps on a given button in a single frame. At the default 30 FPS, a queue size of 5 should be adequate. At lower frame rates/longer frame times, the queue size should be extended until all button presses are caught. Additionally, when the button queue is enabled the button callbacks listed below are passed the event time as an argument.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="buttonCallbacks">Button callbacks</h4>
<div class="paragraph">
<p>Playdate will attempt to call the following functions in your script when input events occur:</p>
</div>
<div id="c-AButtonDown" class="openblock item callback">
<div class="title">playdate.AButtonDown()</div>
<div class="content">
<div class="paragraph">
<p>Called immediately after the player presses the A Button.</p>
</div>
</div>
</div>
<div id="c-AButtonHeld" class="openblock item callback">
<div class="title">playdate.AButtonHeld()</div>
<div class="content">
<div class="paragraph">
<p>Called after the A Button is held down for one second. This can be used for secondary actions (e.g., displaying a game world map, changing weapons).</p>
</div>
</div>
</div>
<div id="c-AButtonUp" class="openblock item callback">
<div class="title">playdate.AButtonUp()</div>
<div class="content">
<div class="paragraph">
<p>Called immediately after the player releases the A Button.</p>
</div>
</div>
</div>
<div id="c-BButtonDown" class="openblock item callback">
<div class="title">playdate.BButtonDown()</div>
<div class="content">
<div class="paragraph">
<p>Called immediately after the player presses the B Button.</p>
</div>
</div>
</div>
<div id="c-BButtonHeld" class="openblock item callback">
<div class="title">playdate.BButtonHeld()</div>
<div class="content">
<div class="paragraph">
<p>Called after the B Button is held down for one second. This can be used for secondary actions (e.g., displaying a game world map, changing weapons).</p>
</div>
</div>
</div>
<div id="c-BButtonUp" class="openblock item callback">
<div class="title">playdate.BButtonUp()</div>
<div class="content">
<div class="paragraph">
<p>Called immediately after the player releases the B Button.</p>
</div>
</div>
</div>
<div id="c-downButtonDown" class="openblock item callback">
<div class="title">playdate.downButtonDown()</div>
<div class="content">
<div class="paragraph">
<p>Called immediately after the player presses the down direction on the d-pad.</p>
</div>
</div>
</div>
<div id="c-downButtonUp" class="openblock item callback">
<div class="title">playdate.downButtonUp()</div>
<div class="content">
<div class="paragraph">
<p>Called immediately after the player releases the down direction on the d-pad.</p>
</div>
</div>
</div>
<div id="c-leftButtonDown" class="openblock item callback">
<div class="title">playdate.leftButtonDown()</div>
<div class="content">
<div class="paragraph">
<p>Called immediately after the player presses the left direction on the d-pad.</p>
</div>
</div>
</div>
<div id="c-leftButtonUp" class="openblock item callback">
<div class="title">playdate.leftButtonUp()</div>
<div class="content">
<div class="paragraph">
<p>Called immediately after the player releases the left direction on the d-pad.</p>
</div>
</div>
</div>
<div id="c-rightButtonDown" class="openblock item callback">
<div class="title">playdate.rightButtonDown()</div>
<div class="content">
<div class="paragraph">
<p>Called immediately after the player presses the right direction on the d-pad.</p>
</div>
</div>
</div>
<div id="c-rightButtonUp" class="openblock item callback">
<div class="title">playdate.rightButtonUp()</div>
<div class="content">
<div class="paragraph">
<p>Called immediately after the player releases the right direction on the d-pad.</p>
</div>
</div>
</div>
<div id="c-upButtonDown" class="openblock item callback">
<div class="title">playdate.upButtonDown()</div>
<div class="content">
<div class="paragraph">
<p>Called immediately after the player presses the up direction on the d-pad.</p>
</div>
</div>
</div>
<div id="c-upButtonUp" class="openblock item callback">
<div class="title">playdate.upButtonUp()</div>
<div class="content">
<div class="paragraph">
<p>Called immediately after the player releases the up direction on the d-pad.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_input_handlers">Input handlers</h4>
<div class="paragraph">
<p>Button interactions can also be observed via <a href="#M-inputHandlers">input handlers</a>.</p>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="crank">7.10. Crank</h3>
<div class="sect3">
<h4 id="_reading_crank_input">Reading crank input</h4>
<div class="paragraph">
<p>There are multiple ways to determine how the player is interacting with the crank control:</p>
</div>
<div class="sect4">
<h5 id="_querying_crank_status_directly">Querying crank status directly</h5>
<div id="f-isCrankDocked" class="openblock item function">
<div class="title">playdate.isCrankDocked()</div>
<div class="content">
<div class="paragraph">
<p>Returns a boolean indicating whether or not the crank is folded into the unit.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If your game requires the crank and <code>:isCrankDocked()</code> is true, you can use a <a href="#C-ui.crankIndicator">crank alert</a> to notify the user that the crank should be extended.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-getCrankPosition" class="openblock item function">
<div class="title">playdate.getCrankPosition()</div>
<div class="content">
<div class="paragraph">
<p>Returns the absolute position of the crank (in degrees). Zero is pointing straight up parallel to the device. Turning the crank clockwise (when looking at the right edge of an upright device) increases the angle, up to a maximum value 359.9999. The value then resets back to zero as the crank continues its rotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">crankPosition</span> = playdate.getCrankPosition()</code></pre>
</div>
</div>
</div>
</div>
<div id="f-getCrankChange" class="openblock item function">
<div class="title">playdate.getCrankChange()</div>
<div class="content">
<div class="paragraph">
<p>Returns two values, <em>change</em> and <em>acceleratedChange</em>. <em>change</em> represents the angle change (in degrees) of the crank since the last time this function (or the <a href="#c-cranked">playdate.cranked()</a> callback) was called. Negative values are anti-clockwise. <em>acceleratedChange</em> is change multiplied by a value that increases as the crank moves faster, similar to the way mouse acceleration works.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">change</span>, <span class="local-variable">acceleratedChange</span> = playdate.getCrankChange()</code></pre>
</div>
</div>
</div>
</div>
<div id="f-getCrankTicks" class="openblock item function">
<div class="title">playdate.getCrankTicks(ticksPerRevolution)</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of "ticks" — whose frequency is defined by the value of <em>ticksPerRevolution</em>  — the crank has turned through since the last time this function was called. Tick boundaries are set at absolute positions along the crank&#8217;s rotation. Ticks can be positive or negative, depending upon the direction of rotation.</p>
</div>
<div class="paragraph">
<p>For example, say you have a movie player and you want your movie to advance 6 frames for every one revolution of the crank. Calling <code>playdate.getCrankTicks(6)</code> during each update will give you a return value of 1 as the crank turns past each 60 degree increment. (Since we passed in a 6, each tick represents 360 ÷ 6 = 60 degrees.) So <code>getCrankTicks(6)</code> will return a 1 as the crank turns past the 0 degree absolute position, the 60 degree absolute position, and so on for the 120, 180, 240, and 300 degree positions. Otherwise, 0 will be returned. (-1 will be returned if the crank moves past one of these mentioned positions while going in a backward direction.)</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/crank</em> to use <code>getCrankTicks()</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example: Reading crank input using getCrankTicks</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/crank</span><span class="delimiter">&quot;</span></span>

<span class="keyword">local</span> <span class="local-variable">ticksPerRevolution</span> = <span class="integer">6</span>

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    <span class="keyword">local</span> <span class="local-variable">crankTicks</span> = playdate.getCrankTicks(ticksPerRevolution)

    <span class="keyword">if</span> crankTicks == <span class="integer">1</span> <span class="keyword">then</span>
        <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Forward tick</span><span class="delimiter">&quot;</span></span>)
    <span class="keyword">elseif</span> crankTicks == <span class="integer">-1</span> <span class="keyword">then</span>
        <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Backward tick</span><span class="delimiter">&quot;</span></span>)
    <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_crank_callbacks">Crank callbacks</h5>
<div id="c-cranked" class="openblock item callback">
<div class="title">playdate.cranked(change, acceleratedChange)</div>
<div class="content">
<div class="paragraph">
<p>For playdate.cranked(), <em>change</em> is the angle change in degrees. <em>acceleratedChange</em> is <em>change</em> multiplied by a value that increases as the crank moves faster, similar to the way mouse acceleration works. Negative values are anti-clockwise.</p>
</div>
</div>
</div>
<div id="c-crankDocked" class="openblock item callback">
<div class="title">playdate.crankDocked()</div>
<div class="content">
<div class="paragraph">
<p>This function, if defined, is called when the crank is docked.</p>
</div>
</div>
</div>
<div id="c-crankUndocked" class="openblock item callback">
<div class="title">playdate.crankUndocked()</div>
<div class="content">
<div class="paragraph">
<p>This function, if defined, is called when the crank is undocked.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_input_handlers_2">Input handlers</h5>
<div class="paragraph">
<p>Crank interactions can also be observed via <a href="#M-inputHandlers">input handlers</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_crank_sounds">Crank sounds</h4>
<div id="f-setCrankSoundsDisabled" class="openblock item function">
<div class="title">playdate.setCrankSoundsDisabled(disable)</div>
<div class="content">
<div class="paragraph">
<p><em>True</em> disables the default crank docking/undocking sound effects. <em>False</em> re-enables them. Useful if the crank sounds seem out-of-place in your game.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When your game terminates, crank sounds will automatically be re-enabled.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-inputHandlers">7.11. Input Handlers</h3>
<div class="paragraph">
<p>The InputHandlers architecture allows you to push and pop a series of <code>playdate.inputHandler</code> objects, each capable of handling any or all button and crank interactions. New input is propagated down the stack until it finds the first responder (or drops it altogether), which allows for switching out control schemes and temporarily stealing focus.</p>
</div>
<div class="paragraph">
<p>You can define an inputHandler as in the sample below, implementing just as few or as many handler functions as you want.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
An inputHandlers object is just an ordinary Lua table. No subclassing is required.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">myInputHandlers</span> = <span class="map"><span class="delimiter">{</span>

    <span class="key">AButtonDown</span> = <span class="keyword">function</span>()
        <span class="comment">-- do stuff</span>
    <span class="keyword">end</span>,

    <span class="key">cranked</span> = <span class="keyword">function</span>(change, acceleratedChange)
        <span class="comment">-- do other stuff</span>
    <span class="keyword">end</span>,

    <span class="comment">-- etc.</span>
<span class="delimiter">}</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>...and later, put them into effect by pushing them on the stack:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">playdate.inputHandlers.push(myInputHandlers)
<span class="comment">-- myInputHandlers are in effect</span>

playdate.inputHandlers.pop()
<span class="comment">-- original handlers are back now</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following functions can be defined in your custom inputHandlers table:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AButtonDown()</code></p>
</li>
<li>
<p><code>AButtonHeld()</code></p>
</li>
<li>
<p><code>AButtonUp()</code></p>
</li>
<li>
<p><code>BButtonDown()</code></p>
</li>
<li>
<p><code>BButtonHeld()</code></p>
</li>
<li>
<p><code>BButtonUp()</code></p>
</li>
<li>
<p><code>downButtonDown()</code></p>
</li>
<li>
<p><code>downButtonUp()</code></p>
</li>
<li>
<p><code>leftButtonDown()</code></p>
</li>
<li>
<p><code>leftButtonUp()</code></p>
</li>
<li>
<p><code>rightButtonDown()</code></p>
</li>
<li>
<p><code>rightButtonUp()</code></p>
</li>
<li>
<p><code>upButtonDown()</code></p>
</li>
<li>
<p><code>upButtonUp()</code></p>
</li>
<li>
<p><code>cranked(change, acceleratedChange)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For definitions of how each of these functions works, see <a href="#buttonCallbacks">Button Callbacks</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Since the playdate table is always at the bottom of the stack, existing <em>playdate.BButtonDown</em> definitions will work out of the box.
</td>
</tr>
</table>
</div>
<div id="f-inputHandlers.push" class="openblock item function">
<div class="title">playdate.inputHandlers.push(handler, [masksPreviousHandlers])</div>
<div class="content">
<div class="paragraph">
<p>Pushes a new input handler onto the stack.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>handler:</em> A table containing one or more custom input functions.</p>
</li>
<li>
<p><em>masksPreviousHandlers:</em> If true, input functions not defined in <em>handler</em> will not be called. If missing or false, the previously-pushed input handler tables will be searched for input functions missing from <em>handler</em>, cascading down to the default <code>playdate</code> table.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="f-inputHandlers.pop" class="openblock item function">
<div class="title">playdate.inputHandlers.pop()</div>
<div class="content">
<div class="paragraph">
<p>Pops the last input handler off of the stack.</p>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-autoLock">7.12. Device Auto Lock</h3>
<div class="paragraph">
<p>Playdate will automatically lock if the user doesn&#8217;t press any buttons or use the crank for more than 3 minutes. In order for games that expect longer periods without interaction to continue to function, it is possible to manually disable the auto lock feature.</p>
</div>
<div id="f-setAutoLockDisabled" class="openblock item function">
<div class="title">playdate.setAutoLockDisabled(disable)</div>
<div class="content">
<div class="paragraph">
<p><em>True</em> disables the 3 minute auto-lock feature. <em>False</em> re-enables it and resets the timer back to 3 minutes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Auto-lock will automatically be re-enabled when your game terminates.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If disabling auto-lock, developers should look for opportunities to re-enable auto-lock when appropriate. (For example, if your game is an MP3 audio player, auto-lock could be re-enabled when the user pauses the audio.)
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="date-and-time">7.13. Date &amp; Time</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<code>playdate.getCurrentTimeMilliseconds()</code> and <code>playdate.getElapsedTime()</code> report game time, not real time. That is, when the game is not active — say, when the System Menu is visible, or when the Playdate is locked — that time is not counted by these functions.
</td>
</tr>
</table>
</div>
<div id="f-getCurrentTimeMilliseconds" class="openblock item function">
<div class="title">playdate.getCurrentTimeMilliseconds()</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of milliseconds the game has been <em>active</em> since launched.</p>
</div>
</div>
</div>
<div id="f-resetElapsedTime" class="openblock item function">
<div class="title">playdate.resetElapsedTime()</div>
<div class="content">
<div class="paragraph">
<p>Resets the high-resolution timer.</p>
</div>
</div>
</div>
<div id="f-getElapsedTime" class="openblock item function">
<div class="title">playdate.getElapsedTime()</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of seconds since <code>playdate.resetElapsedTime()</code> was called. The value is a floating-point number with microsecond accuracy.</p>
</div>
</div>
</div>
<div id="f-getSecondsSinceEpoch" class="openblock item function">
<div class="title">playdate.getSecondsSinceEpoch()</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of seconds and milliseconds elapsed since midnight (hour 0), January 1 2000 UTC, as a list: <em>(seconds, milliseconds)</em>. This function is suitable for seeding the random number generator:</p>
</div>
<div class="listingblock">
<div class="title">Sample code for seeding the random number generator</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">math.randomseed(playdate.getSecondsSinceEpoch())</code></pre>
</div>
</div>
</div>
</div>
<div id="f-getTime" class="openblock item function">
<div class="title">playdate.getTime()</div>
<div class="content">
<div class="paragraph">
<p>Returns a table with values for the local time, accessible via the following keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>year</em>: 4-digit year (until 10,000 AD)</p>
</li>
<li>
<p><em>month</em>: month of the year, where 1 is January and 12 is December</p>
</li>
<li>
<p><em>day</em>: day of the month, 1 - 31</p>
</li>
<li>
<p><em>weekday</em>: day of the week, where 1 is Monday and 7 is Sunday</p>
</li>
<li>
<p><em>hour</em>: 0 - 23</p>
</li>
<li>
<p><em>minute</em>: 0 - 59</p>
</li>
<li>
<p><em>second</em>: 0 - 59 (or 60 on a leap second)</p>
</li>
<li>
<p><em>millisecond</em>: 0 - 999</p>
</li>
</ul>
</div>
</div>
</div>
<div id="f-getGMTTime" class="openblock item function">
<div class="title">playdate.getGMTTime()</div>
<div class="content">
<div class="paragraph">
<p>Returns a table in the same format as <a href="#f-getTime">playdate.getTime()</a>, but in GMT rather than local time.</p>
</div>
</div>
</div>
<div id="f-epochFromTime" class="openblock item function">
<div class="title">playdate.epochFromTime(time)</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of seconds and milliseconds between midnight (hour 0), January 1 2000 UTC and <em>time</em>, specified in local time, as a list: <em>(seconds, milliseconds)</em>.</p>
</div>
<div class="paragraph">
<p><em>time</em> should be a table of the same format as the one returned by <a href="#f-getTime">playdate.getTime()</a>.</p>
</div>
</div>
</div>
<div id="f-epochFromGMTTime" class="openblock item function">
<div class="title">playdate.epochFromGMTTime(time)</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of seconds and milliseconds between midnight (hour 0), January 1 2000 UTC and <em>time</em>, specified in GMT time, as a list: <em>(seconds, milliseconds)</em>.</p>
</div>
<div class="paragraph">
<p><em>time</em> should be a table of the same format as the one returned by <a href="#f-getTime">playdate.getTime()</a>.</p>
</div>
</div>
</div>
<div id="f-timeFromEpoch" class="openblock item function">
<div class="title">playdate.timeFromEpoch(seconds, milliseconds)</div>
<div class="content">
<div class="paragraph">
<p>Converts the epoch to a local date and time table, in the same format as the table returned by <a href="#f-getTime">playdate.getTime()</a>.</p>
</div>
</div>
</div>
<div id="f-GMTTimeFromEpoch" class="openblock item function">
<div class="title">playdate.GMTTimeFromEpoch(seconds, milliseconds)</div>
<div class="content">
<div class="paragraph">
<p>Converts the epoch to a GMT date and time table, in the same format as the table returned by <a href="#f-getTime">playdate.getTime()</a>.</p>
</div>
</div>
</div>
<div id="f-getServerTime" class="openblock item function">
<div class="title">playdate.getServerTime(function(time, error))</div>
<div class="content">
<div class="paragraph">
<p>Queries the Playdate server for the current time, in seconds elapsed since midnight (hour 0), January 1 2000 UTC. This provides games with a reliable clock source, since the internal clock can be set by the user. The function is asynchronous, returning the server time to a callback function passed in. The callback function is given two arguments: the time (as a string, to avoid 32-bit rollover) if the query was successful, otherwise nil and an error string.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>playdate.getServerTime(function(time, error)
    if time ~= nil then print("server time: "..time)
    else print("server error: "..error)
    end
end)</pre>
</div>
</div>
</div>
</div>
<div id="f-shouldDisplay24HourTime" class="openblock item function">
<div class="title">playdate.shouldDisplay24HourTime()</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the user has set the 24-Hour Time preference in the Settings program.</p>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-debug">7.14. Debugging</h3>
<div class="paragraph">
<p>Note that some <a href="#simulator">simulator-only functions</a> may also provide assistance in debugging.</p>
</div>
<div id="f-print" class="openblock item function">
<div class="title">print(string)</div>
<div class="content">
<div class="paragraph">
<p>Text output from <code>print()</code> will be displayed in the simulator&#8217;s console, in black if generated by a game running in the simulator or in blue if it&#8217;s coming from a plugged-in Playdate device. Printed text is also copied to stdout, which is helpful if you run the simulator from the command line.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
You should ideally remove debugging print statements from your final games to improve performance.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-printTable" class="openblock item function">
<div class="title">printTable(table)</div>
<div class="content">
<div class="paragraph">
<p>Identical to <code>print()</code>, but instead of a string <code>printTable()</code> prints the contents of a table formatted for legibility.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/object</em> to use <code>printTable</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
You should ideally remove debugging print statements from your final games to improve performance.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="v-argv" class="openblock item variable">
<div class="title">playdate.argv</div>
<div class="content">
<div class="paragraph">
<p>The first item in the <code>playdate.argv</code> array is the filename of the currently running pdx. If the simulator is launched from the command line, any extra arguments passed there are added to this array; additionally, the <a href="#f-restart">playdate.restart(arg)</a> function puts its <code>arg</code> argument into the argv array, splitting the string on spaces outside of quoted ranges.</p>
</div>
</div>
</div>
<div id="f-setNewlinePrinted" class="openblock item function">
<div class="title">playdate.setNewlinePrinted(flag)</div>
<div class="content">
<div class="paragraph">
<p><em>flag</em> determines whether or not the print() function adds a newline to the end of the printed text.  Default is <em>true</em>.</p>
</div>
</div>
</div>
<div id="f-drawFPS" class="openblock item function">
<div class="title">playdate.drawFPS(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Calculates the current frames per second and draws that value at <em>x, y</em>.</p>
</div>
</div>
</div>
<div id="f-getFPS" class="openblock item function">
<div class="title">playdate.getFPS()</div>
<div class="content">
<div class="paragraph">
<p>Returns the <em>measured, actual</em> refresh rate in frames per second. This value may be different from the <em>specified</em> refresh rate (see <a href="#f-display.getRefreshRate">playdate.display.getRefreshRate()</a>) by a little or a lot depending upon how much calculation is being done per frame.</p>
</div>
</div>
</div>
<div id="f-where" class="openblock item function">
<div class="title">where()</div>
<div class="content">
<div class="paragraph">
<p>Returns a single-line stack trace as a string. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">main.lua:<span class="integer">10</span> foo() &lt; main.lua:<span class="integer">18</span> (from C)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use <code>print(where())</code> to see this trace written to the console.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/utilities/where</em> to use this function.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_advanced_debugging">Advanced Debugging</h4>
<div class="paragraph">
<p>The Simulator supports the <a href="https://microsoft.github.io/debug-adapter-protocol/">Debug Adapter Protocol</a> to do advanced debugging such as setting breakpoints, stepping code and inspecting variables in Lua. On the Mac we recommend using the <a href="#usingNova">Nova extension</a> for debugging. On Windows and Linux we recommend using the <a href="https://github.com/midouest/vscode-playdate-debug">Playdate Debug</a> extension for Visual Studio Code.</p>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-profiling">7.15. Profiling</h3>
<div id="lua-sample" class="openblock item function">
<div class="title">sample(name, function)</div>
<div class="content">
<div class="paragraph">
<p>Suspect some code is running hot? Wrap it in an anonymous function and pass it to <code>sample()</code> like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">sample(<span class="string"><span class="delimiter">&quot;</span><span class="content">name of this sample</span><span class="delimiter">&quot;</span></span>, <span class="keyword">function</span>()
        <span class="comment">-- nested for loops, lots of table creation, member access...</span>
<span class="keyword">end</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>By moving around where you start and end the anonymous function in your code, you can get a better idea of where the problem lies.</p>
</div>
<div class="paragraph">
<p>Multiple code paths can be sampled at once by using different names for each sample.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/utilities/sampler</em> to use this function.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-getStats" class="openblock item function">
<div class="title">playdate.getStats()</div>
<div class="content">
<div class="paragraph">
<p>Returns a table containing percentages of time spent in each system task over the last interval, if more than zero. Possible keys are</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>kernel</code></p>
</li>
<li>
<p><code>serial</code></p>
</li>
<li>
<p><code>game</code></p>
</li>
<li>
<p><code>GC</code></p>
</li>
<li>
<p><code>wifi</code></p>
</li>
<li>
<p><code>audio</code></p>
</li>
<li>
<p><code>trace</code></p>
</li>
<li>
<p><code>idle</code></p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<code>playdate.getStats()</code> only functions on a Playdate device. In the Simulator, this function returns <code>nil</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-setStatsInterval" class="openblock item function">
<div class="title">playdate.setStatsInterval(seconds)</div>
<div class="content">
<div class="paragraph">
<p><code>setStatsInterval()</code> sets the length of time for each sample frame of runtime stats. Set <em>seconds</em> to zero to disable stats collection.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_the_simulator">Using the Simulator</h4>
<div class="sect4">
<h5 id="_profiling_performance">Profiling performance</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Press the Sampler button.</p>
<div class="imageblock">
<div class="content">
<img src="Inside%20Playdate/sampler-button.png" alt="sampler button">
</div>
</div>
</li>
<li>
<p>The Sampler window appears.</p>
<div class="imageblock">
<div class="content">
<img src="Inside%20Playdate/sampling-menu.png" alt="sampling menu">
</div>
</div>
<div class="paragraph">
<p>Choose whether you want to sample:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Simulator performance in Lua code</p>
</li>
<li>
<p>Device performance in Lua code</p>
</li>
<li>
<p>Device performance in C code</p>
</li>
</ul>
</div>
</li>
<li>
<p>Press the <code>Sample</code> button in the upper right corner to start.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_profiling_memory_usage">Profiling memory usage</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Press the Memory button.</p>
<div class="imageblock">
<div class="content">
<img src="Inside%20Playdate/memory-button.png" alt="memory button">
</div>
</div>
</li>
<li>
<p>The Memory window appears:</p>
<div class="imageblock">
<div class="content">
<img src="Inside%20Playdate/memory-window.png" alt="memory window">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The first item displayed, <code>_G</code>, is the table where Lua stores global variables.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_profiling_malloc_calls_in_the_simulator">Profiling malloc calls in the Simulator</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the Simulator menubar, choose <strong>16MB</strong> from the <strong>Playdate</strong> → <strong>Malloc Pool</strong> menu.</p>
</li>
<li>
<p>From the Simulator menubar, choose <strong>Malloc Log</strong> from the <strong>Window</strong> menu.</p>
</li>
<li>
<p>To make your life easier, click on the <strong>Autorefresh</strong> checkbox at the bottom of the window.</p>
<div class="imageblock">
<div class="content">
<img src="Inside%20Playdate/malloc-log.png" alt="malloc log">
</div>
</div>
</li>
<li>
<p>There&#8217;s also a <strong>Map</strong> mode. See below.</p>
<div class="imageblock">
<div class="content">
<img src="Inside%20Playdate/malloc-log-map.png" alt="malloc log map">
</div>
<div class="title">Figure 5. <em>Gray</em> denotes the total 16MB memory space; <em>white</em> is the total amount of heap allocated so far; <em>purple</em> — which overlaps the white region — is currently active or "in-use" memory.</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_profiling_malloc_calls_on_the_device">Profiling malloc calls on the Device</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the Simulator menubar, choose the <strong>Device Info</strong> menu item.</p>
</li>
<li>
<p>In the Device Info window you can observe frames per second data, CPU usage data, and total memory usage.</p>
<div class="imageblock">
<div class="content">
<img src="Inside%20Playdate/device-info.png" alt="device info">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If large amounts of time spent in GC is reported it does not necessarily mean your game has a problem: if your game doesn&#8217;t use all of its allotted CPU, the Lua runtime will try and grab as much time as it can for GC, causing the GC percentage to balloon. See <a href="#M-garbage-collection">Garbage Collection</a> for details on how to modify the behavior of the garbage collector, including having it run for a shorter amount of time.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Select "Memory" to see the memory map:</p>
<div class="paragraph">
<p><span class="image"><img src="Inside%20Playdate/device-info-map.png" alt="device info map"></span></p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-display">7.16. Display</h3>
<div class="paragraph">
<p>The playdate.display module contains functions pertaining to Playdate&#8217;s screen. Functions related to drawing can be found in <a href="#M-graphics">playdate.graphics</a>.</p>
</div>
<div class="sect3">
<h4 id="_display_updating">Display updating</h4>
<div id="f-display.setRefreshRate" class="openblock item function xref">
<div class="title">playdate.display.setRefreshRate(rate)</div>
<div class="content">
<div class="paragraph">
<p>Sets the desired refresh rate in frames per second. The default is 30 fps, which is a recommended figure that balances animation smoothness with performance and power considerations. Maximum is 50 fps.</p>
</div>
<div class="paragraph">
<p>If <em>rate</em> is 0, <a href="#c-update">playdate.update()</a> is called as soon as possible. Since the display refreshes line-by-line, and unchanged lines aren&#8217;t sent to the display, the update cycle will be faster than 30 times a second but at an indeterminate rate. <a href="#f-getCurrentTimeMilliseconds">playdate.getCurrentTimeMilliseconds()</a> should then be used as a steady time base.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-display.setRefreshRate"><code>playdate-&gt;display-&gt;setRefreshRate()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-display.getRefreshRate" class="openblock item function">
<div class="title">playdate.display.getRefreshRate()</div>
<div class="content">
<div class="paragraph">
<p>Returns the specified refresh rate in frames per second. See also <a href="#f-getFPS">playdate.getFPS()</a> for <em>measured, actual</em> frame rate.</p>
</div>
</div>
</div>
<div id="f-display.flush" class="openblock item function">
<div class="title">playdate.display.flush()</div>
<div class="content">
<div class="paragraph">
<p>Sends the contents of the frame buffer to the display immediately. Useful if you have called <a href="#f-stop">playdate.stop()</a> to disable update callbacks in, say, the case where your app updates the display only in reaction to button presses.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_other_display_properties">Other display properties</h4>
<div id="f-display.getHeight" class="openblock item function xref">
<div class="title">playdate.display.getHeight()</div>
<div class="content">
<div class="paragraph">
<p>Returns the height the Playdate display, taking the current display scale into account; e.g., if the scale is 2, the values returned will be based off of a 200 x 120-pixel screen rather than the native 400 x 240. (See <a href="#f-display.setScale">playdate.display.setScale()</a>.)</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-display.getHeight"><code>playdate-&gt;display-&gt;getHeight()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-display.getWidth" class="openblock item function xref">
<div class="title">playdate.display.getWidth()</div>
<div class="content">
<div class="paragraph">
<p>Returns the width the Playdate display, taking the current display scale into account; e.g., if the scale is 2, the values returned will be based off of a 200 x 120-pixel screen rather than the native 400 x 240. (See <a href="#f-display.setScale">playdate.display.setScale()</a>.)</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-display.getWidth"><code>playdate-&gt;display-&gt;getWidth()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-display.getSize" class="openblock item function">
<div class="title">playdate.display.getSize()</div>
<div class="content">
<div class="paragraph">
<p>Returns the values <em>(width, height)</em> describing the Playdate display size. Takes the current display scale into account; e.g., if the scale is 2, the values returned will be based off of a 200 x 120-pixel screen rather than the native 400 x 240. (See <a href="#f-display.setScale">playdate.display.setScale()</a>.)</p>
</div>
</div>
</div>
<div id="f-display.getRect" class="openblock item function">
<div class="title">playdate.display.getRect()</div>
<div class="content">
<div class="paragraph">
<p>Returns the values <em>(x, y, width, height)</em> describing the Playdate display size. Takes the current display scale into account; e.g., if the scale is 2, the values returned will be based off of a 200 x 120-pixel screen rather than the native 400 x 240. (See <a href="#f-display.setScale">playdate.display.setScale()</a>.)</p>
</div>
</div>
</div>
<div id="f-display.setScale" class="openblock item function xref">
<div class="title">playdate.display.setScale(scale)</div>
<div class="content">
<div class="paragraph">
<p>Sets the display scale factor. Valid values for <em>scale</em> are 1, 2, 4, and 8.</p>
</div>
<div class="paragraph">
<p>The top-left corner of the frame buffer is scaled up to fill the display; e.g., if the scale is set to 4, the pixels in rectangle [0,100] x [0,60] are drawn on the screen as 4 x 4 squares.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-display.setScale"><code>playdate-&gt;display-&gt;setScale()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-display.getScale" class="openblock item function">
<div class="title">playdate.display.getScale()</div>
<div class="content">
<div class="paragraph">
<p>Gets the display scale factor. Valid values for <em>scale</em> are 1, 2, 4, and 8.</p>
</div>
</div>
</div>
<div id="f-display.setInverted" class="openblock item function xref">
<div class="title">playdate.display.setInverted(flag)</div>
<div class="content">
<div class="paragraph">
<p>If the argument passed to <code>setInverted()</code> is true, the frame buffer will be drawn inverted (everything onscreen that was black will now be white, etc.)</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-display.setInverted"><code>playdate-&gt;display-&gt;setInverted()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-display.getInverted" class="openblock item function">
<div class="title">playdate.display.getInverted()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current value of the display invert flag.</p>
</div>
</div>
</div>
<div id="f-display.setMosaic" class="openblock item function xref">
<div class="title">playdate.display.setMosaic(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Adds a mosaic effect to the display. Valid <em>x</em> and <em>y</em> values are between 0 and 3, inclusive.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-display.setMosaic"><code>playdate-&gt;display-&gt;setMosaic()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-display.getMosaic" class="openblock item function">
<div class="title">playdate.display.getMosaic()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current mosaic effect settings as multiple values (<em>x</em>, <em>y</em>).</p>
</div>
</div>
</div>
<div id="f-display.setOffset" class="openblock item function xref">
<div class="title">playdate.display.setOffset(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Offsets the entire display by <em>x</em>, <em>y</em>. Offset values can be negative. The "exposed" part of the display is black or white, according to the value set in <a href="#f-graphics.setBackgroundColor">playdate.graphics.setBackgroundColor()</a>. This is an efficient way to make a "shake" effect without redrawing anything.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
This function is different from <a href="#f-graphics.setDrawOffset">playdate.graphics.setDrawOffset()</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-display.setOffset"><code>playdate-&gt;display-&gt;setOffset()</code></a> in the C API.</p>
</div>
<div class="listingblock">
<div class="title">Example: A screen shake effect using setOffset</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- You can copy and paste this example directly as your main.lua file to see it in action</span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/graphics</span><span class="delimiter">&quot;</span></span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/timer</span><span class="delimiter">&quot;</span></span>

<span class="comment">-- This function relies on the use of timers, so the timer core library</span>
<span class="comment">-- must be imported, and updateTimers() must be called in the update loop</span>
<span class="keyword">local</span> <span class="keyword">function</span> <span class="function">screenShake</span>(shakeTime, shakeMagnitude)
    <span class="comment">-- Creating a value timer that goes from shakeMagnitude to 0, over</span>
    <span class="comment">-- the course of 'shakeTime' milliseconds</span>
    <span class="keyword">local</span> <span class="local-variable">shakeTimer</span> = playdate.timer.new(shakeTime, shakeMagnitude, <span class="integer">0</span>)
    <span class="comment">-- Every frame when the timer is active, we shake the screen</span>
    shakeTimer.updateCallback = <span class="keyword">function</span>(timer)
        <span class="comment">-- Using the timer value, so the shaking magnitude</span>
        <span class="comment">-- gradually decreases over time</span>
        <span class="keyword">local</span> <span class="local-variable">magnitude</span> = math.floor(timer.value)
        <span class="keyword">local</span> <span class="local-variable">shakeX</span> = math.random(-magnitude, magnitude)
        <span class="keyword">local</span> <span class="local-variable">shakeY</span> = math.random(-magnitude, magnitude)
        playdate.display.setOffset(shakeX, shakeY)
    <span class="keyword">end</span>
    <span class="comment">-- Resetting the display offset at the end of the screen shake</span>
    shakeTimer.timerEndedCallback = <span class="keyword">function</span>()
        playdate.display.setOffset(<span class="integer">0</span>, <span class="integer">0</span>)
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    playdate.timer.updateTimers()
    <span class="keyword">if</span> playdate.buttonJustPressed(playdate.kButtonA) <span class="keyword">then</span>
        <span class="comment">-- Shake the screen for 500ms, with the screen</span>
        <span class="comment">-- shaking around by about 5 pixels on each side</span>
        screenShake(<span class="integer">500</span>, <span class="integer">5</span>)
    <span class="keyword">end</span>

    <span class="comment">-- A circle to be able to view what the shaking looks like</span>
    playdate.graphics.fillCircleAtPoint(<span class="integer">200</span>, <span class="integer">120</span>, <span class="integer">10</span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div id="f-display.getOffset" class="openblock item function">
<div class="title">playdate.display.getOffset()</div>
<div class="content">
<div class="paragraph">
<p><code>getOffset()</code> returns the current display offset as multiple values (<em>x</em>, <em>y</em>).</p>
</div>
</div>
</div>
<div id="f-display.setFlipped" class="openblock item function xref">
<div class="title">playdate.display.setFlipped(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Flips the display on the x or y axis, or both.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Function arguments are booleans, and in Lua <code>0</code> evaluates to <code>true</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-display.setFlipped"><code>playdate-&gt;display-&gt;setFlipped()</code></a> in the C API.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_displaying_an_image">Displaying an image</h4>
<div id="f-display.loadImage" class="openblock item function">
<div class="title">playdate.display.loadImage(path)</div>
<div class="content">
<div class="paragraph">
<p>The simplest method for putting an image on the display. Copies the contents of the image at <em>path</em> directly to the frame buffer. The image must be 400x240 pixels with no transparency.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Loading an image via <a href="#f-graphics.image.new-path">playdate.graphics.image.new()</a> and drawing it at a desired coordinate with <a href="#m-graphics.imgDraw">playdate.graphics.image:draw()</a> offers more flexibility.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-easingFunctions">7.17. Easing functions</h3>
<div class="paragraph">
<p>A set of easing functions to aid with animation timing.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/easing</em> to use these functions.
</td>
</tr>
</table>
</div>
<div id="f-easingFunctions" class="openblock item function">
<div class="title"><a id="f-easingFunctions.linear"></a> playdate.easingFunctions.linear(t, b, c, d) <br> <a id="f-easingFunctions.inQuad"></a> playdate.easingFunctions.inQuad(t, b, c, d) <br> <a id="f-easingFunctions.outQuad"></a> playdate.easingFunctions.outQuad(t, b, c, d) <br> <a id="f-easingFunctions.inOutQuad"></a> playdate.easingFunctions.inOutQuad(t, b, c, d) <br> <a id="f-easingFunctions.outInQuad"></a> playdate.easingFunctions.outInQuad(t, b, c, d) <br> <a id="f-easingFunctions.inCubic"></a> playdate.easingFunctions.inCubic(t, b, c, d) <br> <a id="f-easingFunctions.outCubic"></a> playdate.easingFunctions.outCubic(t, b, c, d) <br> <a id="f-easingFunctions.inOutCubic"></a> playdate.easingFunctions.inOutCubic(t, b, c, d) <br> <a id="f-easingFunctions.outInCubic"></a> playdate.easingFunctions.outInCubic(t, b, c, d) <br> <a id="f-easingFunctions.inQuart"></a> playdate.easingFunctions.inQuart(t, b, c, d) <br> <a id="f-easingFunctions.outQuart"></a> playdate.easingFunctions.outQuart(t, b, c, d) <br> <a id="f-easingFunctions.inOutQuart"></a> playdate.easingFunctions.inOutQuart(t, b, c, d) <br> <a id="f-easingFunctions.outInQuart"></a> playdate.easingFunctions.outInQuart(t, b, c, d) <br> <a id="f-easingFunctions.inQuint"></a> playdate.easingFunctions.inQuint(t, b, c, d) <br> <a id="f-easingFunctions.outQuint"></a> playdate.easingFunctions.outQuint(t, b, c, d) <br> <a id="f-easingFunctions.inOutQuint"></a> playdate.easingFunctions.inOutQuint(t, b, c, d) <br> <a id="f-easingFunctions.outInQuint"></a> playdate.easingFunctions.outInQuint(t, b, c, d) <br> <a id="f-easingFunctions.inSine"></a> playdate.easingFunctions.inSine(t, b, c, d) <br> <a id="f-easingFunctions.outSine"></a> playdate.easingFunctions.outSine(t, b, c, d) <br> <a id="f-easingFunctions.inOutSine"></a> playdate.easingFunctions.inOutSine(t, b, c, d) <br> <a id="f-easingFunctions.outInSine"></a> playdate.easingFunctions.outInSine(t, b, c, d) <br> <a id="f-easingFunctions.inExpo"></a> playdate.easingFunctions.inExpo(t, b, c, d) <br> <a id="f-easingFunctions.outExpo"></a> playdate.easingFunctions.outExpo(t, b, c, d) <br> <a id="f-easingFunctions.inOutExpo"></a> playdate.easingFunctions.inOutExpo(t, b, c, d) <br> <a id="f-easingFunctions.outInExpo"></a> playdate.easingFunctions.outInExpo(t, b, c, d) <br> <a id="f-easingFunctions.inCirc"></a> playdate.easingFunctions.inCirc(t, b, c, d) <br> <a id="f-easingFunctions.outCirc"></a> playdate.easingFunctions.outCirc(t, b, c, d) <br> <a id="f-easingFunctions.inOutCirc"></a> playdate.easingFunctions.inOutCirc(t, b, c, d) <br> <a id="f-easingFunctions.outInCirc"></a> playdate.easingFunctions.outInCirc(t, b, c, d) <br> <a id="f-easingFunctions.inElastic"></a> playdate.easingFunctions.inElastic(t, b, c, d, [a, p]) <br> <a id="f-easingFunctions.outElastic"></a> playdate.easingFunctions.outElastic(t, b, c, d, [a, p]) <br> <a id="f-easingFunctions.inOutElastic"></a> playdate.easingFunctions.inOutElastic(t, b, c, d, [a, p]) <br> <a id="f-easingFunctions.outInElastic"></a> playdate.easingFunctions.outInElastic(t, b, c, d, [a, p]) <br> <a id="f-easingFunctions.inBack"></a> playdate.easingFunctions.inBack(t, b, c, d, [s]) <br> <a id="f-easingFunctions.outBack"></a> playdate.easingFunctions.outBack(t, b, c, d, [s]) <br> <a id="f-easingFunctions.inOutBack"></a> playdate.easingFunctions.inOutBack(t, b, c, d, [s]) <br> <a id="f-easingFunctions.outInBack"></a> playdate.easingFunctions.outInBack(t, b, c, d, [s]) <br> <a id="f-easingFunctions.outBounce"></a> playdate.easingFunctions.outBounce(t, b, c, d) <br> <a id="f-easingFunctions.inBounce"></a> playdate.easingFunctions.inBounce(t, b, c, d) <br> <a id="f-easingFunctions.inOutBounce"></a> playdate.easingFunctions.inOutBounce(t, b, c, d) <br> <a id="f-easingFunctions.outInBounce"></a> playdate.easingFunctions.outInBounce(t, b, c, d)</div>
<div class="content">
<div class="ulist">
<ul>
<li>
<p><em>t</em> is elapsed time</p>
</li>
<li>
<p><em>b</em> is the beginning value</p>
</li>
<li>
<p><em>c</em> is the change (or end value - start value)</p>
</li>
<li>
<p><em>d</em> is the duration</p>
</li>
<li>
<p><em>a</em> - amplitude</p>
</li>
<li>
<p><em>p</em> - period parameter</p>
</li>
<li>
<p><em>s</em> - amount of "overshoot"</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>See <a href="#C-graphics.animator">playdate.graphics.animator</a>, <a href="#C-timer">playdate.timer</a>, or <a href="#C-frameTimer">playdate.frameTimer</a> for use-cases.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<a href="https://easings.net/en">This page</a> does a great job illustrating the shape of each easing function. (A mouseover will show an animation.)
</td>
</tr>
</table>
</div>
</div>
<div class="sect2 section">
<h3 id="file">7.18. Files</h3>
<div class="paragraph">
<p>The Playdate SDK offers a few different approaches to writing and reading data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#M-datastore"><em>playdate.datastore</em></a> is the simplest way to write or read tables and images.</p>
</li>
<li>
<p>Advanced file access functions are implemented in <a href="#M-file">playdate.file</a>.</p>
</li>
<li>
<p>To encode or decode a JSON file or string, see <a href="#M-json">playdate.json</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When running in the Simulator, all Playdate file operations will happen in the SDK&#8217;s <em>Disk/Data/(bundleID)</em> folder. <em>bundleID</em> is as specified in your project&#8217;s <a href="#pdxinfo">metadata file</a>.
</td>
</tr>
</table>
</div>
<div class="sect3 module">
<h4 id="M-datastore">playdate.datastore</h4>
<div class="paragraph">
<p>If you&#8217;re looking for a simple way to save data, the Datastore APIs allow easy serialization of Lua tables and images.</p>
</div>
<div id="f-datastore.write" class="openblock item function">
<div class="title">playdate.datastore.write(table, [filename], [pretty-print])</div>
<div class="content">
<div class="paragraph">
<p>Encodes the given table into the named file. (The <code>.json</code> extension should be omitted from the file name.) The default file name is "data". If <em>pretty-print</em> is true, the JSON will be nicely formatted.</p>
</div>
</div>
</div>
<div id="f-datastore.read" class="openblock item function">
<div class="title">playdate.datastore.read([filename])</div>
<div class="content">
<div class="paragraph">
<p>Returns a table instantiated with the data in the JSON-encoded file you specify. (The <code>.json</code> extension should be omitted.)  The default file name is "data". If no file is found, this function returns nil.</p>
</div>
</div>
</div>
<div id="f-datastore.delete" class="openblock item function">
<div class="title">playdate.datastore.delete([filename])</div>
<div class="content">
<div class="paragraph">
<p>Deletes the specified datastore file. The default file name is "data". Returns <code>false</code> if the datastore file could not be deleted.</p>
</div>
</div>
</div>
<div id="f-datastore.writeImage" class="openblock item function">
<div class="title">playdate.datastore.writeImage(image, path)</div>
<div class="content">
<div class="paragraph">
<p>Saves a <a href="#C-graphics.image">playdate.graphics.image</a> to a file. If <em>path</em> doesn&#8217;t contain a folder name, the image is stored in a folder named "images".</p>
</div>
<div class="paragraph">
<p>By default, this method writes out a PDI file, a custom image format used by Playdate that can be read back in using <a href="#f-datastore.readImage">readImage()</a>. If you want to write out a GIF file, append a <code>.gif</code> extension to your <em>path</em>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Because <code>writeImage()</code> doesn&#8217;t currently support GIF transparency, if you attempt to write a GIF from an image buffer you instantiated, you must call <a href="#f-graphics.image.new">playdate.graphics.image.new( <em>width, height, bgcolor</em> )</a> with <em>bgcolor</em> set to <code>playdate.graphics.kColorWhite</code> or <code>playdate.graphics.kColorBlack</code>, otherwise your image will render improperly to the file.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-datastore.readImage" class="openblock item function">
<div class="title">playdate.datastore.readImage(path)</div>
<div class="content">
<div class="paragraph">
<p>Reads a <a href="#C-graphics.image">playdate.graphics.image</a> from a file in the data folder. If <em>path</em> doesn&#8217;t contain a folder name, the image is searched for in a folder named "images".</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<code>readImage()</code> can only load compiled pdi files. (<a href="#f-datastore.writeImage"><code>writeImage()</code></a> by default creates compiled pdi files.)
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect3 module">
<h4 id="M-file">playdate.file</h4>
<div class="paragraph">
<p>The <em>playdate.file</em> module contains functions which allow you to interact with files on Playdate&#8217;s filesystem. It contains the <em>playdate.file.file</em> submodule for interacting with an opened file.</p>
</div>
<div id="about-playdate-filesystem" class="sidebarblock">
<div class="content">
<div class="title">About the Playdate filesystem</div>
<div class="paragraph">
<p>Behind the scenes, there are two directories your game has access to: <strong>the root of your app bundle</strong> (read-only), and a <strong>Data directory</strong> unique to your game (readable and writeable) where you can store your game&#8217;s saved state or other data.</p>
</div>
<div class="paragraph">
<p>From your game&#8217;s perspective, these two locations are treated as one. If you attempt to read a file, the Playdate OS will first look for the file in the Data directory, then look in the app bundle. If you attempt to create or append to a file, this file will be created in your game&#8217;s Data directory. Calling <a href="#f-file.listFiles"><code>playdate.file.listFiles()</code></a> returns a list of files and directories at the root of <em>both</em> your app bundle and your game&#8217;s Data directory.</p>
</div>
<div class="paragraph">
<p>You are not permitted access to files outside of these two directories.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_file_reading_and_writing">File reading and writing</h5>
<div id="f-file.open" class="openblock item function xref">
<div class="title">playdate.file.open(path, [mode])</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#M-file">playdate.file.file</a> corresponding to the opened file. <em>mode</em> should be one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>playdate.file.kFileRead</strong>: the file is opened for reading; the system first looks in the /Data/&lt;bundleid&gt; folder for the given file, then in the game&#8217;s pdx folder if it isn&#8217;t found</p>
</li>
<li>
<p><strong>playdate.file.kFileWrite</strong>: the file is created if it doesn&#8217;t exist, truncated to zero length if it does, then opened for writing</p>
</li>
<li>
<p><strong>playdate.file.kFileAppend</strong>: the file is created if it doesn&#8217;t exist, opened for writing, with new data written to the end of the file</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <em>mode</em> is not specified, the default is <em>playdate.file.kFileRead</em>.</p>
</div>
<div class="paragraph">
<p>If the file couldn&#8217;t be opened, a second return value indicates the error. The filesystem has a limit of 64 simultaneous open files.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-file.open"><code>playdate-&gt;file-&gt;open()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="m-file.close" class="openblock item method xref">
<div class="title">playdate.file.file:close()</div>
<div class="content">
<div class="paragraph">
<p>Closes the file.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-file.close"><code>playdate-&gt;file-&gt;close()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="m-file.write" class="openblock item method">
<div class="title">playdate.file.file:write(string)</div>
<div class="content">
<div class="paragraph">
<p>Writes the given string to the file and returns the number of bytes written if successful, or 0 and a second return value describing the error. If you wish to include line termination characters (<code>\n</code>, <code>\r</code>), please include them in the string.</p>
</div>
</div>
</div>
<div id="m-file.flush" class="openblock item method xref">
<div class="title">playdate.file.file:flush()</div>
<div class="content">
<div class="paragraph">
<p>Flushes any buffered data written to the file to the disk.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-file.flush"><code>playdate-&gt;file-&gt;flush()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="m-file.readline" class="openblock item method">
<div class="title">playdate.file.file:readline()</div>
<div class="content">
<div class="paragraph">
<p>Returns the next line of the file, delimited by either <code>\n</code> or <code>\r\n</code>. The returned string does not include newline characters.</p>
</div>
</div>
</div>
<div id="m-file.read" class="openblock item method xref">
<div class="title">playdate.file.file:read(numberOfBytes)</div>
<div class="content">
<div class="paragraph">
<p>Returns a buffer containing up to <em>numberOfBytes</em> bytes from the file, and the number of bytes read. If the read failed, the function returns <code>nil</code> and a second value describing the error.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-file.read"><code>playdate-&gt;file-&gt;read()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="m-file.seek" class="openblock item method xref">
<div class="title">playdate.file.file:seek(offset, [whence])</div>
<div class="content">
<div class="paragraph">
<p>Sets the file read/write position to the given byte offset. <code>whence</code>, if given is one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>playdate.file.kSeekSet</strong>: <code>offset</code> is an absolute offset from the start of the file</p>
</li>
<li>
<p><strong>playdate.file.kSeekFromCurrent</strong>: <code>offset</code> is relative to the current position</p>
</li>
<li>
<p><strong>playdate.file.kSeekFromEnd</strong>: <code>offset</code> is an offset from the end of the file (negative values are before the end, positive are past the end)</p>
</li>
</ul>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-file.seek"><code>playdate-&gt;file-&gt;seek()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="m-file.tell" class="openblock item method xref">
<div class="title">playdate.file.file:tell()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current byte offset of the read/write position in the file.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-file.tell"><code>playdate-&gt;file-&gt;tell()</code></a> in the C API.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_filesystem_operations">Filesystem operations</h4>
<div id="f-file.listFiles" class="openblock item function xref">
<div class="title">playdate.file.listFiles(path, [showhidden])</div>
<div class="content">
<div class="paragraph">
<p>Returns an array containing the file names in the given directory path as strings. Folders are indicated by a slash <code>/</code> at the end of the filename. If <em>showhidden</em> is set, files beginning with a period will be included; otherwise, they are skipped.</p>
</div>
<div class="paragraph">
<p>Call with no argument to get a list of all files and folders your game has access to. (For a game with default access permissions, <code>listFiles()</code>, <code>listFiles("/")</code>, and <code>listFiles(".")</code> should all return the same result.)</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-file.listfiles"><code>playdate-&gt;file-&gt;listfiles()</code></a> in the C API.</p>
</div>
<div class="paragraph">
<p><a href="#about-playdate-filesystem">Learn more about the Playdate filesystem</a>.</p>
</div>
</div>
</div>
<div id="f-file.exists" class="openblock item function">
<div class="title">playdate.file.exists(path)</div>
<div class="content">
<div class="paragraph">
<p>Returns true if a file exists at the given path. Unlike the <a href="#f-graphics.image.new-path">image</a> or <a href="#f-sound.sample.new-path">sound</a> loading functions, this function requires <em>path</em> to include the file extension since it cannot be inferred from context. Additionally, note that asset files are compiled into a format easier for Playdate to use and will have a different extension: <code>.wav</code> and <code>.aiff</code> audio files are compiled to <code>.pda</code> format, and <code>.gif</code> and <code>.png</code> files become `.pdi`s.</p>
</div>
</div>
</div>
<div id="f-file.isdir" class="openblock item function">
<div class="title">playdate.file.isdir(path)</div>
<div class="content">
<div class="paragraph">
<p>Returns true if a directory exists at the given path.</p>
</div>
</div>
</div>
<div id="f-file.mkdir" class="openblock item function xref">
<div class="title">playdate.file.mkdir(path)</div>
<div class="content">
<div class="paragraph">
<p>Creates a directory at the given path, under the /Data/&lt;bundleid&gt; folder. See <a href="#about-playdate-filesystem">About the Playdate Filesystem</a> for details.</p>
</div>
<div class="paragraph">
<p><code>playdate.file.mkdir()</code> will create all intermediate directories, if a succession of directories ("testdir/testdir/testdir/") is specified in <em>path</em>.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-file.mkdir"><code>playdate-&gt;file-&gt;mkdir()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-file.delete" class="openblock item function">
<div class="title">playdate.file.delete(path, [recursive])</div>
<div class="content">
<div class="paragraph">
<p>Deletes the file at the given path. Returns true if successful, else false.</p>
</div>
<div class="paragraph">
<p>If <em>recursive</em> is <code>true</code>, this function will delete the directory at <em>path</em> and its contents, otherwise the directory must be empty to be deleted.</p>
</div>
</div>
</div>
<div id="f-file.getSize" class="openblock item function">
<div class="title">playdate.file.getSize(path)</div>
<div class="content">
<div class="paragraph">
<p>Returns the size of the file at the given path.</p>
</div>
</div>
</div>
<div id="f-file.getType" class="openblock item function">
<div class="title">playdate.file.getType(path)</div>
<div class="content">
<div class="paragraph">
<p>Returns the type of the file at the given path.</p>
</div>
</div>
</div>
<div id="f-file.modtime" class="openblock item function">
<div class="title">playdate.file.modtime(path)</div>
<div class="content">
<div class="paragraph">
<p>Returns the modification date/time of the file at the given path, as a table with keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>year</em>: 4-digit year (until 10,000 AD)</p>
</li>
<li>
<p><em>month</em>: month of the year, where 1 is January and 12 is December</p>
</li>
<li>
<p><em>day</em>: day of the month, 1 - 31</p>
</li>
<li>
<p><em>hour</em>: 0 - 23</p>
</li>
<li>
<p><em>minute</em>: 0 - 59</p>
</li>
<li>
<p><em>second</em>: 0 - 59 (or 60 on a leap second)</p>
</li>
</ul>
</div>
</div>
</div>
<div id="f-file.rename" class="openblock item function xref">
<div class="title">playdate.file.rename(path, newPath)</div>
<div class="content">
<div class="paragraph">
<p>Renames the file at <em>path</em>, if it exists, to the value of newPath. This can result in the file being moved to a new directory, but directories will not be created. Returns true if the operation was successful.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-file.rename"><code>playdate-&gt;file-&gt;rename()</code></a> in the C API.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_pdz_files">.pdz files</h4>
<div id="f-file.load" class="openblock item function">
<div class="title">playdate.file.load(path, [env])</div>
<div class="content">
<div class="paragraph">
<p>Loads the compiled <em>.pdz</em> file at the given location and returns the contents as a function. The .pdz extension on <em>path</em> is optional.</p>
</div>
<div class="paragraph">
<p><em>env</em>, if specified, is a table to use as the function&#8217;s global namespace instead of <em>_G</em>.</p>
</div>
</div>
</div>
<div id="f-file.run" class="openblock item function">
<div class="title">playdate.file.run(path, [env])</div>
<div class="content">
<div class="paragraph">
<p>Runs the pdz file at the given location. Equivalent to <code>playdate.file.load(path, env)()</code>.</p>
</div>
<div class="paragraph">
<p>The <em>.pdz</em> extension on <em>path</em> is optional. Values returned from the pdz file are left on the stack.</p>
</div>
<div class="paragraph">
<p><em>env</em>, if specified, is a table to use as the function&#8217;s global namespace instead of <em>_G</em>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-geometry">7.19. Geometry</h3>
<div class="paragraph">
<p>The playdate.geometry library allows you to store and manipulate points, sizes, rectangles, line segments, 2D vectors, polygons, and affine transforms.</p>
</div>
<div class="paragraph">
<p>All new geometry objects are created with a new() function using syntax like:</p>
</div>
<div class="literalblock">
<div class="title">Example of creating a new rect</div>
<div class="content">
<pre>r = playdate.geometry.rect.new(x, y, width, height)</pre>
</div>
</div>
<div class="paragraph">
<p>They can be output to the Simulator console:</p>
</div>
<div class="literalblock">
<div class="title">Example of printing a rect to the console</div>
<div class="content">
<pre>print('rect', r)</pre>
</div>
</div>
<div class="paragraph">
<p>And tested for equality:</p>
</div>
<div class="literalblock">
<div class="title">Example of testing two rects for equality</div>
<div class="content">
<pre>b = r1 == r2</pre>
</div>
</div>
<div class="paragraph">
<p>Fields on most geometry objects can be set directly:</p>
</div>
<div class="literalblock">
<div class="title">Example of directly setting a rect&#8217;s x coordinate</div>
<div class="content">
<pre>r.x = 42.0</pre>
</div>
</div>
<div class="paragraph">
<p>Functions for drawing playdate.geometry objects to screen are available in <a href="#M-graphics">playdate.graphics</a>.</p>
</div>
<div class="sect3 class">
<h4 id="C-geometry.affineTransform">Affine transform</h4>
<div class="paragraph">
<p>Affine transforms can be used to modify the coordinates of points, rects (as axis aligned bounding boxes (AABBs)), line segments, and polygons. The underlying matrix is of the form:</p>
</div>
<div class="listingblock">
<div class="title">The matrix of an affine transform</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">[m11 m12 tx]
[m21 m22 ty]
[ <span class="integer">0</span>   <span class="integer">0</span>  <span class="integer">1</span> ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can directly read and write the <em>m11</em>, <em>m12</em>, <em>m21</em>, <em>m22</em>, <em>tx</em> and <em>ty</em> values of an <code>affineTransform</code>.</p>
</div>
<div id="f-geometry.affineTransform.new" class="openblock item function">
<div class="title">playdate.geometry.affineTransform.new(m11, m12, m21, m22, tx, ty)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.geometry.affineTransform. Use new() instead to get a new copy of the identity transform.</p>
</div>
</div>
</div>
<div id="f-geometry.affineTransform.new-1" class="openblock item function">
<div class="title">playdate.geometry.affineTransform.new()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.geometry.affineTransform that is the identity transform.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.copy" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:copy()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new copy of the affine transform.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.invert" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:invert()</div>
<div class="content">
<div class="paragraph">
<p>Mutates the caller so that it is an affine transformation matrix constructed by inverting itself.</p>
</div>
<div class="paragraph">
<p>Inversion is generally used to provide reverse transformation of points within transformed objects. Given the coordinates (x, y), which have been transformed by a given matrix to new coordinates (x’, y’), transforming the coordinates (x’, y’) by the inverse matrix produces the original coordinates (x, y).</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.reset" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:reset()</div>
<div class="content">
<div class="paragraph">
<p>Mutates the the caller, changing it to an identity transform matrix.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.concat" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:concat(af)</div>
<div class="content">
<div class="paragraph">
<p>Mutates the the caller. The affine transform <em>af</em> is concatenated to the caller.</p>
</div>
<div class="paragraph">
<p>Concatenation combines two affine transformation matrices by multiplying them together. You might perform several concatenations in order to create a single affine transform that contains the cumulative effects of several transformations.</p>
</div>
<div class="paragraph">
<p>Note that matrix operations are not commutative &mdash; the order in which you concatenate matrices is important. That is, the result of multiplying matrix t1 by matrix t2 does not necessarily equal the result of multiplying matrix t2 by matrix t1.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.translate" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:translate(dx, dy)</div>
<div class="content">
<div class="paragraph">
<p>Mutates the caller by applying a translate transformation.  x values are moved by <em>dx</em>, y values by <em>dy</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.translatedBy" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:translatedBy(dx, dy)</div>
<div class="content">
<div class="paragraph">
<p>Returns a copy of the calling affine transform with a translate transformation appended.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.scale" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:scale(sx, [sy])</div>
<div class="content">
<div class="paragraph">
<p>Mutates the caller by applying a scaling transformation.</p>
</div>
<div class="paragraph">
<p>If both parameters are passed, <em>sx</em> is used to scale the x values of the transform, <em>sy</em> is used to scale the y values.</p>
</div>
<div class="paragraph">
<p>If only one parameter is passed, it is used to scale both x and y values.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.scaledBy" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:scaledBy(sx, [sy])</div>
<div class="content">
<div class="paragraph">
<p>Returns a copy of the calling affine transform with a scaling transformation appended.</p>
</div>
<div class="paragraph">
<p>If both parameters are passed, <em>sx</em> is used to scale the x values of the transform, <em>sy</em> is used to scale the y values.</p>
</div>
<div class="paragraph">
<p>If only one parameter is passed, it is used to scale both x and y values.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.rotate" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:rotate(angle, [x, y])</div>
<div class="content">
<div class="paragraph">
<p>Mutates the caller by applying a rotation transformation.</p>
</div>
<div class="paragraph">
<p><em>angle</em> is the value, in degrees, by which to rotate the affine transform. A positive value specifies clockwise rotation and a negative value specifies counterclockwise rotation. If the optional <em>x</em> and <em>y</em> arguments are given, the transform rotates around (<em>x</em>,<em>y</em>) instead of (0,0).</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform:rotate-point" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:rotate(angle, [point])</div>
<div class="content">
<div class="paragraph">
<p>Mutates the caller by applying a rotation transformation.</p>
</div>
<div class="paragraph">
<p><em>angle</em> is the value, in degrees, by which to rotate the affine transform. A positive value specifies clockwise rotation and a negative value specifies counterclockwise rotation. If the optional <a href="#C-geometry.point">playdate.geometry.point</a> <em>point</em> argument is given, the transform rotates around the <em>point</em> instead of (0,0).</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.rotatedBy" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:rotatedBy(angle, [x, y])</div>
<div class="content">
<div class="paragraph">
<p>Returns a copy of the calling affine transform with a rotate transformation appended.</p>
</div>
<div class="paragraph">
<p><em>angle</em> is the value, in degrees, by which to rotate the affine transform. A positive value specifies clockwise rotation and a negative value specifies counterclockwise rotation.  If the optional <em>x</em> and <em>y</em> arguments are given, the transform rotates around (<em>x</em>,<em>y</em>) instead of (0,0).</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform:rotatedBy-point" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:rotatedBy(angle, [point])</div>
<div class="content">
<div class="paragraph">
<p>Returns a copy of the calling affine transform with a rotate transformation appended.</p>
</div>
<div class="paragraph">
<p><em>angle</em> is the value, in degrees, by which to rotate the affine transform. A positive value specifies clockwise rotation and a negative value specifies counterclockwise rotation.  If the optional <a href="#C-geometry.point">point</a> <em>point</em> argument is given, the transform rotates around the <em>point</em> instead of (0,0).</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.skew" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:skew(sx, sy)</div>
<div class="content">
<div class="paragraph">
<p>Mutates the caller, appending a skew transformation.  <em>sx</em> is the value by which to skew the x axis, and <em>sy</em> the value for the y axis. Values are in degrees.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.skewedBy" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:skewedBy(sx, sy)</div>
<div class="content">
<div class="paragraph">
<p>Returns the given transform with a skew transformation appended.  <em>sx</em> is the value by which to skew the x axis, and <em>sy</em> the value for the y axis. Values are in degrees.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.transformPoint" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:transformPoint(p)</div>
<div class="content">
<div class="paragraph">
<p>Modifies the <a href="#C-geometry.point">point</a> <em>p</em> by applying the affine transform.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.transformedPoint" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:transformedPoint(p)</div>
<div class="content">
<div class="paragraph">
<p>As above, but returns a new point rather than modifying <em>p</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.transformXY" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:transformXY(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Returns two values calculated by applying the affine transform to the point (<em>x</em>, <em>y</em>)</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.transformLineSegment" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:transformLineSegment(ls)</div>
<div class="content">
<div class="paragraph">
<p>Modifies the <a href="#C-geometry.lineSegment">line segment</a> <em>ls</em> by applying the affine transform.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.transformedLineSegment" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:transformedLineSegment(ls)</div>
<div class="content">
<div class="paragraph">
<p>As above, but returns a new <a href="#C-geometry.lineSegment">line segment</a> rather than modifying <em>ls</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.transformAABB" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:transformAABB(r)</div>
<div class="content">
<div class="paragraph">
<p>Modifies the axis aligned bounding box <em>r</em> (a <a href="#C-geometry.rect">rect</a>) by applying the affine transform.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.transformedAABB" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:transformedAABB(r)</div>
<div class="content">
<div class="paragraph">
<p>As above, but returns a new <a href="#C-geometry.rect">rect</a> rather than modifying <em>r</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.transformPolygon" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:transformPolygon(p)</div>
<div class="content">
<div class="paragraph">
<p>Modifies the <a href="#C-geometry.polygon">polygon</a> <em>p</em> by applying the affine transform.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.transformedPolygon" class="openblock item method">
<div class="title">playdate.geometry.affineTransform:transformedPolygon(p)</div>
<div class="content">
<div class="paragraph">
<p>As above, but returns a new <a href="#C-geometry.polygon">polygon</a> rather than modifying <em>p</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.mul_t" class="openblock item method">
<div class="title">t1 * t2</div>
<div class="content">
<div class="paragraph">
<p>Returns the transform created by multiplying transform <em>t1</em> by transform <em>t2</em></p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.mul_v" class="openblock item method">
<div class="title">t * v</div>
<div class="content">
<div class="paragraph">
<p>Returns the vector2D created by applying the transform <em>t</em> to the <a href="#C-geometry.vector2D"><code>vector2D</code></a> <code>v</code></p>
</div>
</div>
</div>
<div id="m-geometry.affineTransform.mul_p" class="openblock item method">
<div class="title">t * p</div>
<div class="content">
<div class="paragraph">
<p>Returns the point created by applying the transform <em>t</em> to the <a href="#C-geometry.point"><code>point</code></a> <em>p</em></p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-geometry.arc">Arc</h4>
<div class="paragraph">
<p>playdate.geometry.arc implements an arc.</p>
</div>
<div class="paragraph">
<p>You can directly read or write the <em>x</em>, <em>y</em>, <em>radius</em>, <em>startAngle</em>, <em>endAngle</em> and <em>clockwise</em> values of an <code>arc</code>.</p>
</div>
<div id="f-geometry.arc.new" class="openblock item method">
<div class="title">playdate.geometry.arc.new(x, y, radius, startAngle, endAngle, [direction])</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.geometry.arc. Angles should be specified in degrees. Zero degrees represents the top of the circle.</p>
</div>
<div class="imageblock diagram">
<div class="content">
<img src="Inside%20Playdate/unitcircle.png" alt="unitcircle">
</div>
</div>
<div class="paragraph">
<p>If specified, <em>direction</em> should be true for clockwise, false for counterclockwise. If not specified, the direction is inferred from the start and end angles.</p>
</div>
</div>
</div>
<div id="m-geometry.arc.copy" class="openblock item method">
<div class="title">playdate.geometry.arc:copy()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new copy of the arc.</p>
</div>
</div>
</div>
<div id="m-geometry.arc.length" class="openblock item method">
<div class="title">playdate.geometry.arc:length()</div>
<div class="content">
<div class="paragraph">
<p>Returns the length of the arc.</p>
</div>
</div>
</div>
<div id="m-geometry.arc.isClockwise" class="openblock item method">
<div class="title">playdate.geometry.arc:isClockwise()</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the direction of the arc is clockwise.</p>
</div>
</div>
</div>
<div id="m-geometry.arc.setIsClockwise" class="openblock item method">
<div class="title">playdate.geometry.arc:setIsClockwise(flag)</div>
<div class="content">
<div class="paragraph">
<p>Sets the direction of the arc.</p>
</div>
</div>
</div>
<div id="m-geometry.arc.pointOnArc" class="openblock item method">
<div class="title">playdate.geometry.arc:pointOnArc(distance, [extend])</div>
<div class="content">
<div class="paragraph">
<p>Returns a new <a href="#C-geometry.point">point</a> on the arc, <code>distance</code> pixels from the arc&#8217;s start angle. If <code>extend</code> is true, the returned point is allowed to project past the arc&#8217;s endpoints; otherwise, it is constrained to the arc&#8217;s initial point if <code>distance</code> is negative, or the end point if <code>distance</code> is greater than the arc&#8217;s length.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-geometry.lineSegment">Line segment</h4>
<div class="paragraph">
<p>playdate.geometry.lineSegment implements a line segment between two points in two-dimensional space.</p>
</div>
<div class="paragraph">
<p>You can directly read or write <em>x1</em>, <em>y1</em>, <em>x2</em>, or <em>y2</em> values to a lineSegment.</p>
</div>
<div id="f-geometry.lineSegment.new" class="openblock item function">
<div class="title">playdate.geometry.lineSegment.new(x1, y1, x2, y2)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.geometry.lineSegment.</p>
</div>
</div>
</div>
<div id="m-geometry.lineSegment.copy" class="openblock item method">
<div class="title">playdate.geometry.lineSegment:copy()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new copy of the line segment.</p>
</div>
</div>
</div>
<div id="m-geometry.lineSegment.unpack" class="openblock item method">
<div class="title">playdate.geometry.lineSegment:unpack()</div>
<div class="content">
<div class="paragraph">
<p>Returns the values <em>x1, y1, x2, y2</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.lineSegment.length" class="openblock item method">
<div class="title">playdate.geometry.lineSegment:length()</div>
<div class="content">
<div class="paragraph">
<p>Returns the length of the line segment.</p>
</div>
</div>
</div>
<div id="m-geometry.lineSegment.offset" class="openblock item method">
<div class="title">playdate.geometry.lineSegment:offset(dx, dy)</div>
<div class="content">
<div class="paragraph">
<p>Modifies the line segment, offsetting its values by <em>dx</em>, <em>dy</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.lineSegment.offsetBy" class="openblock item method">
<div class="title">playdate.geometry.lineSegment:offsetBy(dx, dy)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new line segment, the given segment offset by <em>dx</em>, <em>dy</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.lineSegment.midPoint" class="openblock item method">
<div class="title">playdate.geometry.lineSegment:midPoint()</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-geometry.point">playdate.geometry.point</a> representing the mid point of the line segment.</p>
</div>
</div>
</div>
<div id="m-geometry.lineSegment.pointOnLine" class="openblock item method">
<div class="title">playdate.geometry.lineSegment:pointOnLine(distance, [extend])</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-geometry.point">playdate.geometry.point</a> on the line segment, <code>distance</code> pixels from the start of the line. If <code>extend</code> is true, the returned point is allowed to project past the segment&#8217;s endpoints; otherwise, it is constrained to the line segment&#8217;s initial point if <code>distance</code> is negative, or the end point if <code>distance</code> is greater than the segment&#8217;s length.</p>
</div>
</div>
</div>
<div id="m-geometry.lineSegment.segmentVector" class="openblock item method">
<div class="title">playdate.geometry.lineSegment:segmentVector()</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-geometry.vector2D">playdate.geometry.vector2D</a> representation of the line segment.</p>
</div>
</div>
</div>
<div id="m-geometry.lineSegment.closestPointOnLineToPoint" class="openblock item method">
<div class="title">playdate.geometry.lineSegment:closestPointOnLineToPoint(p)</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-geometry.point">playdate.geometry.point</a> that is the closest point to point <em>p</em> that is on the line segment.</p>
</div>
</div>
</div>
<div id="m-geometry.lineSegment.intersectsLineSegment" class="openblock item method">
<div class="title">playdate.geometry.lineSegment:intersectsLineSegment(ls)</div>
<div class="content">
<div class="paragraph">
<p>Returns true if there is an intersection between the caller and the line segment <em>ls</em>.</p>
</div>
<div class="paragraph">
<p>If there is an intersection, a <a href="#C-geometry.point">playdate.geometry.point</a> representing that point is also returned.</p>
</div>
</div>
</div>
<div id="m-geometry.lineSegment.fast_intersection" class="openblock item function">
<div class="title">playdate.geometry.lineSegment.fast_intersection(x1, y1, x2, y2, x3, y3, x4, y4)</div>
<div class="content">
<div class="paragraph">
<p>For use in inner loops where speed is the priority.</p>
</div>
<div class="paragraph">
<p>Returns true if there is an intersection between the line segments defined by <em>(x1, y1)</em>, <em>(x2, y2)</em> and <em>(x3, y3)</em>, <em>(x4, y4)</em>.
If there is an intersection, <em>x, y</em> values representing the intersection point are also returned.</p>
</div>
</div>
</div>
<div id="m-geometry.lineSegment.intersectsPolygon" class="openblock item method">
<div class="title">playdate.geometry.lineSegment:intersectsPolygon(poly)</div>
<div class="content">
<div class="paragraph">
<p>Returns the values (<em>intersects</em>, <em>intersectionPoints</em>).</p>
</div>
<div class="paragraph">
<p><em>intersects</em> is true if there is at least one intersection between the caller and <a href="#C-geometry.polygon">poly</a>.</p>
</div>
<div class="paragraph">
<p><em>intersectionPoints</em> is an array of <a href="#C-geometry.point">playdate.geometry.point</a>s containing all intersection points between the caller and <a href="#C-geometry.polygon">poly</a>.</p>
</div>
</div>
</div>
<div id="m-geometry.lineSegment.intersectsRect" class="openblock item method">
<div class="title">playdate.geometry.lineSegment:intersectsRect(rect)</div>
<div class="content">
<div class="paragraph">
<p>Returns the values (<em>intersects</em>, <em>intersectionPoints</em>).</p>
</div>
<div class="paragraph">
<p><em>intersects</em> is true if there is at least one intersection between the caller and <a href="#C-geometry.rect">rect</a>.</p>
</div>
<div class="paragraph">
<p><em>intersectionPoints</em> is an array of <a href="#C-geometry.point">playdate.geometry.point</a>s containing all intersection points between the caller and <a href="#C-geometry.rect">rect</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-geometry.point">Point</h4>
<div class="paragraph">
<p>playdate.geometry.point implements a two-dimensional point.
You can directly read or write the <em>x</em> and <em>y</em> values of a <code>point</code>.</p>
</div>
<div id="f-geometry.point.new" class="openblock item function">
<div class="title">playdate.geometry.point.new(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.geometry.point.</p>
</div>
</div>
</div>
<div id="m-geometry.point.copy" class="openblock item method">
<div class="title">playdate.geometry.point:copy()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new copy of the point.</p>
</div>
</div>
</div>
<div id="m-geometry.point.unpack" class="openblock item method">
<div class="title">playdate.geometry.point:unpack()</div>
<div class="content">
<div class="paragraph">
<p>Returns the values <em>x, y</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.point.offset" class="openblock item method">
<div class="title">playdate.geometry.point:offset(dx, dy)</div>
<div class="content">
<div class="paragraph">
<p>Modifies the point, offsetting its values by <em>dx</em>, <em>dy</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.point.offsetBy" class="openblock item method">
<div class="title">playdate.geometry.point:offsetBy(dx, dy)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new point object, the given point offset by <em>dx</em>, <em>dy</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.point.squaredDistanceToPoint" class="openblock item method">
<div class="title">playdate.geometry.point:squaredDistanceToPoint(p)</div>
<div class="content">
<div class="paragraph">
<p>Returns the square of the distance to point <em>p</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.point.distanceToPoint" class="openblock item method">
<div class="title">playdate.geometry.point:distanceToPoint(p)</div>
<div class="content">
<div class="paragraph">
<p>Returns the distance to point <em>p</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.point.add" class="openblock item method">
<div class="title">p + v</div>
<div class="content">
<div class="paragraph">
<p>Returns a new point by adding the <a href="#C-geometry.vector2D">vector</a> <em>v</em> to point <em>p</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.point.sub" class="openblock item method">
<div class="title">p1 - p2</div>
<div class="content">
<div class="paragraph">
<p>Returns the vector constructed by subtracting <em>p2</em> from <em>p1</em>. By this construction, <em>p2</em> + (<em>p1</em> - <em>p2</em>) == <em>p1</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.point.mul" class="openblock item method">
<div class="title">p * t</div>
<div class="content">
<div class="paragraph">
<p>Returns a new point by applying the <a href="#C-geometry.affineTransform">transform</a> <em>t</em> to point <em>p</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.point.concat" class="openblock item method">
<div class="title">p1 .. p2</div>
<div class="content">
<div class="paragraph">
<p>Returns a new <a href="#C-geometry.lineSegment">lineSegment</a> connecting points <em>p1</em> and <em>p2</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-geometry.polygon">Polygon</h4>
<div class="paragraph">
<p>playdate.geometry.polygon implements two-dimensional open or closed polygons.</p>
</div>
<div id="f-geometry.polygon.new" class="openblock item function">
<div class="title">playdate.geometry.polygon.new(x1, y1, x2, y2, ..., xn, yn) <br> playdate.geometry.polygon.new(p1, p2, ..., pn) <br> playdate.geometry.polygon.new(numberOfVertices)</div>
<div class="content">
<div class="paragraph">
<p><code>new(x1, y1, x2, y2, ..., xn, yn)</code> returns a new playdate.geometry.polygon with vertices <em>(x1, y1)</em> through <em>(xn, yn)</em>.  The Lua function <code>table.unpack()</code> can be used to turn an array into function arguments.</p>
</div>
<div class="paragraph">
<p><code>new(p1, p2, ..., pn)</code> does the same, except the points are expressed via <a href="#C-geometry.point">point objects</a>.</p>
</div>
<div class="paragraph">
<p><code>new(numberOfVertices)</code> returns a new playdate.geometry.polygon with space allocated for <em>numberOfVertices</em> vertices. All vertices are initially (0, 0). Vertex coordinates can be set with <a href="#m-geometry.polygon.setPointAt">playdate.geometry.polygon:setPointAt()</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If the polygon&#8217;s first and last points are coincident, the polygon will be considered <a href="#m-geometry.polygon.isClosed">closed</a>. Alternatively, you may call <a href="#m-geometry.polygon.close">:close()</a> to automatically close the polygon.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
To draw a polygon, use <a href="#f-graphics.drawPolygon"><code>playdate.graphics.drawPolygon()</code></a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-geometry.polygon.copy" class="openblock item method">
<div class="title">playdate.geometry.polygon:copy()</div>
<div class="content">
<div class="paragraph">
<p>Returns a copy of a polygon.</p>
</div>
</div>
</div>
<div id="m-geometry.polygon.close" class="openblock item method">
<div class="title">playdate.geometry.polygon:close()</div>
<div class="content">
<div class="paragraph">
<p><code>:close()</code> closes a polygon. If the polygon&#8217;s first and last point aren&#8217;t coincident, a line segment will be generated to connect them.</p>
</div>
</div>
</div>
<div id="m-geometry.polygon.isClosed" class="openblock item method">
<div class="title">playdate.geometry.polygon:isClosed()</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the polygon is closed, false if not.</p>
</div>
</div>
</div>
<div id="m-geometry.polygon.containsPoint" class="openblock item method">
<div class="title">playdate.geometry.polygon:containsPoint(p, [fillRule]) <br> playdate.geometry.polygon:containsPoint(x, y, [fillRule])</div>
<div class="content">
<div class="paragraph">
<p>Returns a boolean value, true if the <a href="#C-geometry.point">point</a> <em>p</em> or the point at <em>(x, y)</em> is contained within the caller polygon.</p>
</div>
<div class="paragraph">
<p><code>fillrule</code> is an optional argument that can be one of the values defined in <a href="#f-graphics.setPolygonFillRule">playdate.graphics.setPolygonFillRule</a>. By default <code><em>playdate.graphics.kPolygonFillEvenOdd</em></code> is used.</p>
</div>
</div>
</div>
<div id="m-geometry.polygon.getBounds" class="openblock item method">
<div class="title">playdate.geometry.polygon:getBounds()</div>
<div class="content">
<div class="paragraph">
<p>Returns multiple values (<em>x</em>, <em>y</em>, <em>width</em>, <em>height</em>) giving the axis-aligned bounding box for the polygon.</p>
</div>
</div>
</div>
<div id="m-geometry.polygon.getBoundsRect" class="openblock item method">
<div class="title">playdate.geometry.polygon:getBoundsRect()</div>
<div class="content">
<div class="paragraph">
<p>Returns the axis-aligned bounding box for the given polygon as a <a href="#C-geometry.rect"><code>playdate.geometry.rect</code></a> object.</p>
</div>
</div>
</div>
<div id="m-geometry.polygon.count" class="openblock item method">
<div class="title">playdate.geometry.polygon:count()</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of points in the polygon.</p>
</div>
</div>
</div>
<div id="m-geometry.polygon.length" class="openblock item method">
<div class="title">playdate.geometry.polygon:length()</div>
<div class="content">
<div class="paragraph">
<p>Returns the total length of all line segments in the polygon.</p>
</div>
</div>
</div>
<div id="m-geometry.polygon.setPointAt" class="openblock item method">
<div class="title">playdate.geometry.polygon:setPointAt(n, x, y)</div>
<div class="content">
<div class="paragraph">
<p>Sets the polygon’s <em>n</em>-th point to (<em>x</em>, <em>y</em>).</p>
</div>
</div>
</div>
<div id="m-geometry.polygon.getPointAt" class="openblock item method">
<div class="title">playdate.geometry.polygon:getPointAt(n)</div>
<div class="content">
<div class="paragraph">
<p>Returns the polygon’s <em>n</em>-th point.</p>
</div>
</div>
</div>
<div id="m-geometry.polygon.intersects" class="openblock item method">
<div class="title">playdate.geometry.polygon:intersects(p)</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the given polygon intersects the polygon <em>p</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.polygon.pointOnPolygon" class="openblock item method">
<div class="title">playdate.geometry.polygon:pointOnPolygon(distance, [extend])</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-geometry.point">playdate.geometry.point</a> on one of the polygon&#8217;s line segments, <code>distance</code> pixels from the start of the polygon. If <code>extend</code> is true, the  point is allowed to project past the polygon&#8217;s ends; otherwise, it is constrained to the polygon&#8217;s initial point if <code>distance</code> is negative, or the last point if <code>distance</code> is greater than the polygon&#8217;s length.</p>
</div>
</div>
</div>
<div id="m-geometry.polygon.translate" class="openblock item method">
<div class="title">playdate.geometry.polygon:translate(dx, dy)</div>
<div class="content">
<div class="paragraph">
<p>Translates each point on the polygon by <em>dx</em>, <em>dy</em> pixels.</p>
</div>
</div>
</div>
<div id="m-geometry.polygon.mul" class="openblock item method">
<div class="title">p * t</div>
<div class="content">
<div class="paragraph">
<p>Returns a new polygon formed by applying the <a href="#C-geometry.affineTransform">transform</a> <em>t</em> to polygon <em>p</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-geometry.rect">Rect</h4>
<div class="paragraph">
<p>playdate.geometry.rect implements a rectangle.</p>
</div>
<div class="paragraph">
<p>You can directly read or write <em>x</em>, <em>y</em>, <em>width</em>, or <em>height</em> values to a rect.</p>
</div>
<div class="paragraph">
<p>The values of <em>top</em>, <em>bottom</em>, <em>right</em>, <em>left</em>, <em>origin</em>, and <em>size</em> are read-only.</p>
</div>
<div id="f-geometry.rect.new" class="openblock item function">
<div class="title">playdate.geometry.rect.new(x, y, width, height)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.geometry.rect.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.copy" class="openblock item method">
<div class="title">playdate.geometry.rect:copy()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new copy of the rect.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.toPolygon" class="openblock item method">
<div class="title">playdate.geometry.rect:toPolygon()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.geometry.polygon version of the rect.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.unpack" class="openblock item method">
<div class="title">playdate.geometry.rect:unpack()</div>
<div class="content">
<div class="paragraph">
<p>Returns <em>x</em>, <em>y</em>, <em>width</em> and <em>height</em> as individual values.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.isEmpty" class="openblock item method">
<div class="title">playdate.geometry.rect:isEmpty()</div>
<div class="content">
<div class="paragraph">
<p>Returns true if a rectangle has zero width or height.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.isEqual" class="openblock item method">
<div class="title">playdate.geometry.rect:isEqual(r2)</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the <em>x</em>, <em>y</em>, <em>width</em>, and <em>height</em> values of the caller and <em>r2</em> are all equal.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.intersects" class="openblock item method">
<div class="title">playdate.geometry.rect:intersects(r2)</div>
<div class="content">
<div class="paragraph">
<p>Returns true if <em>r2</em> intersects the caller.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.intersection" class="openblock item method">
<div class="title">playdate.geometry.rect:intersection(r2)</div>
<div class="content">
<div class="paragraph">
<p>Returns a rect representing the overlapping portion of the caller and <em>r2</em>.</p>
</div>
</div>
</div>
<div id="f-geometry.rect.fast_intersection" class="openblock item function">
<div class="title">playdate.geometry.rect.fast_intersection(x1, y1, w1, h1, x2, y2, w2, h2)</div>
<div class="content">
<div class="paragraph">
<p>For use in inner loops where speed is the priority. About 3x faster than <a href="#m-geometry.rect.intersection">intersection</a>.</p>
</div>
<div class="paragraph">
<p>Returns multiple values (<em>x, y, width, height</em>) representing the overlapping portion of the two rects defined by <em>x1, y1, w1, h1</em> and <em>x2, y2, w2, h2</em>. If there is no intersection, (0, 0, 0, 0) is returned.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.union" class="openblock item method">
<div class="title">playdate.geometry.rect:union(r2)</div>
<div class="content">
<div class="paragraph">
<p>Returns the smallest possible rect that contains both the source rect and <em>r2</em>.</p>
</div>
</div>
</div>
<div id="f-geometry.rect.fast_union" class="openblock item function">
<div class="title">playdate.geometry.rect.fast_union(x1, y1, w1, h1, x2, y2, w2, h2)</div>
<div class="content">
<div class="paragraph">
<p>For use in inner loops where speed is the priority. About 3x faster than <a href="#m-geometry.rect.union">union</a>.</p>
</div>
<div class="paragraph">
<p>Returns multiple values (<em>x, y, width, height</em>) representing the smallest possible rect that contains the two rects defined by <em>x1, y1, w1, h1</em> and <em>x2, y2, w2, h2</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.inset" class="openblock item method">
<div class="title">playdate.geometry.rect:inset(dx, dy)</div>
<div class="content">
<div class="paragraph">
<p>Insets the rect by the given <em>dx</em> and <em>dy</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.insetBy" class="openblock item method">
<div class="title">playdate.geometry.rect:insetBy(dx, dy)</div>
<div class="content">
<div class="paragraph">
<p>Returns a rect that is inset by the given <em>dx</em> and <em>dy</em>, with the same center point.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.offset" class="openblock item method">
<div class="title">playdate.geometry.rect:offset(dx, dy)</div>
<div class="content">
<div class="paragraph">
<p>Offsets the rect by the given <em>dx</em> and <em>dy</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.offsetBy" class="openblock item method">
<div class="title">playdate.geometry.rect:offsetBy(dx, dy)</div>
<div class="content">
<div class="paragraph">
<p>Returns a rect with its origin point offset by <em>dx</em>, <em>dy</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.containsRect-r2" class="openblock item method">
<div class="title">playdate.geometry.rect:containsRect(r2)</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the <a href="#C-geometry.rect">rect</a> <em>r2</em> is contained within the caller <a href="#C-geometry.rect">rect</a>.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.containsRect" class="openblock item method">
<div class="title">playdate.geometry.rect:containsRect(x, y, width, height)</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the rect defined by <em>(x, y, width, height)</em> is contained within the caller <a href="#C-geometry.rect">rect</a>.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.containsPoint" class="openblock item method">
<div class="title">playdate.geometry.rect:containsPoint(p)</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the <a href="#C-geometry.point">point</a> <em>p</em> is contained within the caller <a href="#C-geometry.rect">rect</a>.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.containsPoint-xy" class="openblock item method">
<div class="title">playdate.geometry.rect:containsPoint(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the point at <em>(x, y)</em> is contained within the caller <a href="#C-geometry.rect">rect</a>.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.centerPoint" class="openblock item method">
<div class="title">playdate.geometry.rect:centerPoint()</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-geometry.point">point</a> at the center of the caller.</p>
</div>
</div>
</div>
<div id="m-geometry.rect.flipRelativeToRect" class="openblock item method">
<div class="title">playdate.geometry.rect:flipRelativeToRect(r2, flip)</div>
<div class="content">
<div class="paragraph">
<p>Flips the caller about the center of rect <em>r2</em>.</p>
</div>
<div class="paragraph">
<p><em>flip</em> should be one of the following constants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.geometry.kUnflipped</em></p>
</li>
<li>
<p><em>playdate.geometry.kFlippedX</em></p>
</li>
<li>
<p><em>playdate.geometry.kFlippedY</em></p>
</li>
<li>
<p><em>playdate.geometry.kFlippedXY</em></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-geometry.size">Size</h4>
<div class="paragraph">
<p>You can directly read or write the <em>width</em> and <em>height</em> values of a <code>size</code>.</p>
</div>
<div id="f-geometry.size.new" class="openblock item function">
<div class="title">playdate.geometry.size.new(width, height)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.geometry.size.</p>
</div>
</div>
</div>
<div id="m-geometry.size.copy" class="openblock item method">
<div class="title">playdate.geometry.size:copy()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new copy of the size.</p>
</div>
</div>
</div>
<div id="m-geometry.size.unpack" class="openblock item method">
<div class="title">playdate.geometry.size:unpack()</div>
<div class="content">
<div class="paragraph">
<p>Returns the values <em>width, height</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_utility_functions">Utility functions</h4>
<div id="f-geometry.squaredDistanceToPoint" class="openblock item function">
<div class="title">playdate.geometry.squaredDistanceToPoint(x1, y1, x2, y2)</div>
<div class="content">
<div class="paragraph">
<p>Returns the square of the distance from point <em>(x1, y1)</em> to point <em>(x2, y2)</em>.</p>
</div>
<div class="paragraph">
<p>Compared to <a href="#m-geometry.point.squaredDistanceToPoint">geometry.point:squaredDistanceToPoint()</a>, this version will be slightly faster.</p>
</div>
</div>
</div>
<div id="f-geometry.distanceToPoint" class="openblock item function">
<div class="title">playdate.geometry.distanceToPoint(x1, y1, x2, y2)</div>
<div class="content">
<div class="paragraph">
<p>Returns the the distance from point <em>(x1, y1)</em> to point <em>(x2, y2)</em>.</p>
</div>
<div class="paragraph">
<p>Compared to <a href="#m-geometry.point.distanceToPoint">geometry.point:distanceToPoint()</a>, this version will be slightly faster.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-geometry.vector2D">Vector</h4>
<div class="paragraph">
<p>playdate.geometry.vector2D implements a two-dimensional vector.</p>
</div>
<div class="paragraph">
<p>You can directly read or write <em>dx</em>, or <em>dy</em> values to a vector2D.</p>
</div>
<div id="f-geometry.vector2D.new" class="openblock item function">
<div class="title">playdate.geometry.vector2D.new(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.geometry.vector2D.</p>
</div>
</div>
</div>
<div id="f-geometry.vector2D.newPolar" class="openblock item function">
<div class="title">playdate.geometry.vector2D.newPolar(length, angle)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.geometry.vector2D. Angles should be specified in degrees. Zero degrees represents the top of the circle.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.copy" class="openblock item method">
<div class="title">playdate.geometry.vector2D:copy()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new copy of the vector2D.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.unpack" class="openblock item method">
<div class="title">playdate.geometry.vector2D:unpack()</div>
<div class="content">
<div class="paragraph">
<p>Returns the values <em>dx, dy</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.addVector" class="openblock item method">
<div class="title">playdate.geometry.vector2D:addVector(v)</div>
<div class="content">
<div class="paragraph">
<p>Modifies the caller by adding vector <em>v</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.scale" class="openblock item method">
<div class="title">playdate.geometry.vector2D:scale(s)</div>
<div class="content">
<div class="paragraph">
<p>Modifies the caller, scaling it by amount <em>s</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.scaledBy" class="openblock item method">
<div class="title">playdate.geometry.vector2D:scaledBy(s)</div>
<div class="content">
<div class="paragraph">
<p>Returns the given vector scaled by <em>s</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.normalize" class="openblock item method">
<div class="title">playdate.geometry.vector2D:normalize()</div>
<div class="content">
<div class="paragraph">
<p>Modifies the caller by normalizing it so that its length is 1. If the vector is (0,0), the vector is unchanged.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.normalized" class="openblock item method">
<div class="title">playdate.geometry.vector2D:normalized()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new vector by normalizing the given vector.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.dotProduct" class="openblock item method">
<div class="title">playdate.geometry.vector2D:dotProduct(v)</div>
<div class="content">
<div class="paragraph">
<p>Returns the dot product of the caller and the vector <em>v</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.magnitude" class="openblock item method">
<div class="title">playdate.geometry.vector2D:magnitude()</div>
<div class="content">
<div class="paragraph">
<p>Returns the magnitude of the caller.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.magnitudeSquared" class="openblock item method">
<div class="title">playdate.geometry.vector2D:magnitudeSquared()</div>
<div class="content">
<div class="paragraph">
<p>Returns the square of the magnitude of the caller.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.projectAlong" class="openblock item method">
<div class="title">playdate.geometry.vector2D:projectAlong(v)</div>
<div class="content">
<div class="paragraph">
<p>Modifies the caller by projecting it along the vector <em>v</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.projectedAlong" class="openblock item method">
<div class="title">playdate.geometry.vector2D:projectedAlong(v)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new vector created by projecting the given vector along the vector <em>v</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.angleBetween" class="openblock item method">
<div class="title">playdate.geometry.vector2D:angleBetween(v)</div>
<div class="content">
<div class="paragraph">
<p>Returns the angle between the caller and the vector <em>v</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.leftNormal" class="openblock item method">
<div class="title">playdate.geometry.vector2D:leftNormal()</div>
<div class="content">
<div class="paragraph">
<p>Returns a vector that is the left normal of the caller.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.rightNormal" class="openblock item method">
<div class="title">playdate.geometry.vector2D:rightNormal()</div>
<div class="content">
<div class="paragraph">
<p>Returns a vector that is the right normal of the caller.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.unm" class="openblock item method">
<div class="title">-v</div>
<div class="content">
<div class="paragraph">
<p>Returns the vector formed by negating the components of vector <em>v</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.add" class="openblock item method">
<div class="title">v1 + v2</div>
<div class="content">
<div class="paragraph">
<p>Returns the vector formed by adding vector <em>v2</em> to vector <em>v1</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.sub" class="openblock item method">
<div class="title">v1 - v2</div>
<div class="content">
<div class="paragraph">
<p>Returns the vector formed by subtracting vector <em>v2</em> from vector <em>v1</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.mul_s" class="openblock item method">
<div class="title">v1 * s</div>
<div class="content">
<div class="paragraph">
<p>Returns the vector <em>v1</em> scaled by <em>s</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.mul_v" class="openblock item method">
<div class="title">v1 * v2</div>
<div class="content">
<div class="paragraph">
<p>Returns the dot product of the two vectors.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.mul_t" class="openblock item method">
<div class="title">v1 * t</div>
<div class="content">
<div class="paragraph">
<p>Returns the vector transformed by transform <em>t</em>.</p>
</div>
</div>
</div>
<div id="m-geometry.vector2D.div" class="openblock item method">
<div class="title">v / s</div>
<div class="content">
<div class="paragraph">
<p>Returns the vector divided by scalar <em>s</em>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-graphics">7.20. Graphics</h3>
<div class="paragraph">
<p>The playdate.graphics module contains functions related to displaying information on the device screen.</p>
</div>
<div class="sect3">
<h4 id="_conventions">Conventions</h4>
<div class="ulist">
<ul>
<li>
<p>The Playdate coordinate system has its origin point (0, 0) at the upper left. The x-axis increases to the right, and the y-axis increases downward.</p>
</li>
<li>
<p>(0, 0) represents the upper-left corner of the first pixel onscreen. The center of that pixel is (0.5, 0.5).</p>
</li>
<li>
<p>In the Playdate SDK, angle values should always be provided in degrees, and angle values returned will be in degrees. Not radians. (This is in contrast to Lua&#8217;s built-in math libraries, which use radians.)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_contexts">Contexts</h4>
<div id="f-graphics.pushContext" class="openblock item function xref">
<div class="title">playdate.graphics.pushContext([image])</div>
<div class="content">
<div class="paragraph">
<p>Pushes the current graphics state to the context stack and creates a new context. If a <a href="#C-graphics.image">playdate.graphics.image</a> is given, drawing functions are applied to the image instead of the screen buffer.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
If you draw into an image context with color set to <em>playdate.graphics.kColorClear</em>, those drawn pixels will be set to transparent. When you later draw the image into the framebuffer, those pixels will not be rendered, i.e., will act as transparent pixels in the image.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<a href="#f-graphics.lockFocus">playdate.graphics.lockFocus(<em>image</em>)</a> will reroute drawing into an image, without saving the overall graphics context.
</td>
</tr>
</table>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.pushContext"><code>playdate-&gt;graphics-&gt;pushContext()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-graphics.popContext" class="openblock item function xref">
<div class="title">playdate.graphics.popContext()</div>
<div class="content">
<div class="paragraph">
<p>Pops a graphics context off the context stack and restores its state.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.popContext"><code>playdate-&gt;graphics-&gt;popContext()</code></a> in the C API.</p>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Using contexts to reset drawing modifiers</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">gfx</span> = playdate.graphics

gfx.setLineWidth(<span class="integer">1</span>) <span class="comment">-- Original line width</span>
gfx.setColor(gfx.kColorBlack) <span class="comment">-- Original color</span>

gfx.pushContext() <span class="comment">-- Creating a new graphics context</span>
gfx.setLineWidth(<span class="integer">5</span>) <span class="comment">-- Setting the line width to 5</span>
gfx.setColor(gfx.kColorWhite) <span class="comment">-- Setting the draw color to white</span>
gfx.drawCircleAtPoint(<span class="integer">200</span>, <span class="integer">120</span>, <span class="integer">10</span>) <span class="comment">-- Only thing you're trying to modify</span>
gfx.popContext() <span class="comment">-- All modifications done during the context get removed</span>

<span class="comment">-- Unaffected by modifiers and gets drawn with the original color/line width</span>
gfx.drawLine(<span class="integer">0</span>, <span class="integer">120</span>, <span class="integer">400</span>, <span class="integer">120</span>)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Using contexts to draw something to an image</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- You can copy and paste this example directly as your main.lua file to see it in action</span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/graphics</span><span class="delimiter">&quot;</span></span>

<span class="comment">-- In this example, we'll be drawing a smiley face to an image, which saves our</span>
<span class="comment">-- drawing, makes it easier to draw, and helps improve performance since we don't</span>
<span class="comment">-- have to redraw each element separately each time</span>
<span class="keyword">local</span> <span class="local-variable">gfx</span> = playdate.graphics

<span class="keyword">local</span> <span class="local-variable">smileWidth</span>, <span class="local-variable">smileHeight</span> = <span class="integer">36</span>, <span class="integer">36</span>
<span class="keyword">local</span> <span class="local-variable">smileImage</span> = gfx.image.new(smileWidth, smileHeight)
<span class="comment">-- Pushing our new image to the graphics context, so everything</span>
<span class="comment">-- drawn will be drawn directly to the image</span>
gfx.pushContext(smileImage)
    <span class="comment">-- =&gt; Indentation not required, but helps organize things!</span>
    gfx.setColor(gfx.kColorWhite)
    <span class="comment">-- Coordinates are based on the image being drawn into</span>
    <span class="comment">-- (e.g. (x=0, y=0) refers to the top left of the image)</span>
    gfx.fillCircleInRect(<span class="integer">0</span>, <span class="integer">0</span>, smileWidth, smileHeight)
    gfx.setColor(gfx.kColorBlack)
    <span class="comment">-- Drawing the eyes</span>
    gfx.fillCircleAtPoint(<span class="integer">11</span>, <span class="integer">13</span>, <span class="integer">3</span>)
    gfx.fillCircleAtPoint(<span class="integer">25</span>, <span class="integer">13</span>, <span class="integer">3</span>)
    <span class="comment">-- Drawing the mouth</span>
    gfx.setLineWidth(<span class="integer">3</span>)
    gfx.drawArc(smileWidth/<span class="integer">2</span>, smileHeight/<span class="integer">2</span>, <span class="integer">11</span>, <span class="integer">115</span>, <span class="integer">245</span>)
    <span class="comment">-- Drawing the outline</span>
    gfx.setLineWidth(<span class="integer">2</span>)
    gfx.setStrokeLocation(gfx.kStrokeInside)
    gfx.drawCircleInRect(<span class="integer">0</span>, <span class="integer">0</span>, smileWidth, smileHeight)
<span class="comment">-- Popping context to stop drawing to image</span>
gfx.popContext()

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    <span class="comment">-- Draw smile in the center of the screen</span>
    <span class="keyword">local</span> <span class="local-variable">screenWidth</span>, <span class="local-variable">screenHeight</span> = playdate.display.getSize()
    smileImage:drawAnchored(screenWidth/<span class="integer">2</span>, screenHeight/<span class="integer">2</span>, <span class="float">0.5</span>, <span class="float">0.5</span>)
<span class="keyword">end</span>

<span class="comment">-- Works really well with sprites! Just set the sprite image to your new image</span>
<span class="keyword">local</span> <span class="local-variable">smileSprite</span> = gfx.sprite.new(smileImage)
smileSprite:add()</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_clearing_the_screen">Clearing the Screen</h4>
<div id="f-graphics.clear" class="openblock item function xref">
<div class="title">playdate.graphics.clear([color])</div>
<div class="content">
<div class="paragraph">
<p>Clears the entire display, setting the color to either the given <em>color</em> argument, or the current background color set in <a href="#f-graphics.setBackgroundColor">setBackgroundColor(color)</a> if no argument is given.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.clear"><code>playdate-&gt;graphics-&gt;clear()</code></a> in the C API.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-graphics.image">Image</h4>
<div class="paragraph">
<p>PNG and GIF images in the source folder are compiled into a Playdate-specific format by <strong><code>pdc</code></strong>, and can be loaded into Lua with
<a href="#f-graphics.image.new-path">playdate.graphics.image.new(path)</a>. Playdate images are 1 bit per pixel, with an optional alpha channel.</p>
</div>
<div class="sect4">
<h5 id="_image_basics">Image basics</h5>
<div id="f-graphics.image.new" class="openblock item function">
<div class="title">playdate.graphics.image.new(width, height, [bgcolor])</div>
<div class="content">
<div class="paragraph">
<p>Creates a new blank image of the given width and height. The image can be drawn on using <a href="#f-graphics.pushContext">playdate.graphics.pushContext()</a> or <a href="#f-graphics.lockFocus">playdate.graphics.lockFocus()</a>. The optional <em>bgcolor</em> argument is one of the color constants as used in <a href="#f-graphics.setColor">playdate.graphics.setColor()</a>, defaulting to <em>kColorClear</em>.</p>
</div>
</div>
</div>
<div id="f-graphics.image.new-path" class="openblock item function">
<div class="title">playdate.graphics.image.new(path)</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-graphics.image">playdate.graphics.image</a> object from the data at <em>path</em>. If there is no file at <em>path</em>, the function returns nil and a second value describing the error.</p>
</div>
</div>
</div>
<div id="m-graphics.image.load" class="openblock item method">
<div class="title">playdate.graphics.image:load(path)</div>
<div class="content">
<div class="paragraph">
<p>Loads a new image from the data at <em>path</em> into an already-existing image, without allocating additional memory. The image at <em>path</em> must be of the same dimensions as the original.</p>
</div>
<div class="paragraph">
<p>Returns <em>(success, [error])</em>. If the boolean <em>success</em> is false, <em>error</em> is also returned.</p>
</div>
</div>
</div>
<div id="m-graphics.image.copy" class="openblock item method">
<div class="title">playdate.graphics.image:copy()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new <code>playdate.graphics.image</code> that is an exact copy of the original.</p>
</div>
</div>
</div>
<div id="m-graphics.image.getSize" class="openblock item method">
<div class="title">playdate.graphics.image:getSize()</div>
<div class="content">
<div class="paragraph">
<p>Returns the pair (<em>width</em>, <em>height</em>)</p>
</div>
</div>
</div>
<div id="f-graphics.image.imageSizeAtPath" class="openblock item function">
<div class="title">playdate.graphics.imageSizeAtPath(path)</div>
<div class="content">
<div class="paragraph">
<p>Returns the pair (<em>width</em>, <em>height</em>) for the image at <em>path</em> without actually loading the image.</p>
</div>
</div>
</div>
<div id="m-graphics.imgDraw" class="openblock item method">
<div class="title">playdate.graphics.image:draw(x, y, [flip, [sourceRect]]) <br> playdate.graphics.image:draw(p, [flip, [sourceRect]])</div>
<div class="content">
<div class="paragraph">
<p>Draws the image with its upper-left corner at location (<em>x</em>, <em>y</em>) or <a href="#C-geometry.point">playdate.geometry.point</a> <em>p</em>.</p>
</div>
<div class="paragraph">
<p>The optional <em>flip</em> argument can be one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="k-graphics.kImageUnflipped"></a> <em class="constant">playdate.graphics.kImageUnflipped</em>: the image is drawn normally</p>
</li>
<li>
<p><a id="k-graphics.kImageFlippedX"></a> <em class="constant">playdate.graphics.kImageFlippedX</em>: the image is flipped left to right</p>
</li>
<li>
<p><a id="k-graphics.kImageFlippedY"></a> <em class="constant">playdate.graphics.kImageFlippedY</em>: the image is flipped top to bottom</p>
</li>
<li>
<p><a id="k-graphics.kImageFlippedXY"></a> <em class="constant">playdate.graphics.kImageFlippedXY</em>: the image if flipped both ways; i.e., rotated 180 degrees</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternately, one of the strings "flipX", "flipY", or "flipXY" can be used for the <em>flip</em> argument.</p>
</div>
<div class="paragraph">
<p><em>sourceRect</em>, if specified, will cause only the part of the image within sourceRect to be drawn. <em>sourceRect</em> should be relative to the image&#8217;s bounds and can be a <a href="#C-geometry.rect">playdate.geometry.rect</a> or four integers, (<em>x</em>, <em>y</em>, <em>w</em>, <em>h</em>), representing the rect.</p>
</div>
</div>
</div>
<div id="m-graphics.image.drawAnchored" class="openblock item method">
<div class="title">playdate.graphics.image:drawAnchored(x, y, ax, ay, [flip])</div>
<div class="content">
<div class="paragraph">
<p>Draws the image at location <em>(x, y)</em> centered at the point within the image represented by <em>(ax, ay)</em> in unit coordinate space. For example, values of <em>ax = 0.0</em>, <em>ay = 0.0</em> represent the image&#8217;s top-left corner, <em>ax = 1.0</em>, <em>ay = 1.0</em> represent the bottom-right, and <em>ax = 0.5</em>, <em>ay = 0.5</em> represent the center of the image.</p>
</div>
<div class="paragraph">
<p>The <em>flip</em> argument is optional; see <a href="#m-graphics.imgDraw"><code>playdate.graphics.image:draw()</code></a> for valid values.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/graphics</em> to use this method.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.image.drawCentered" class="openblock item method">
<div class="title">playdate.graphics.image:drawCentered(x, y, [flip])</div>
<div class="content">
<div class="paragraph">
<p>Draws the image centered at location <em>(x, y)</em>.</p>
</div>
<div class="paragraph">
<p>The <em>flip</em> argument is optional; see <a href="#m-graphics.imgDraw"><code>playdate.graphics.image:draw()</code></a> for valid values.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/graphics</em> to use this method.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.image.drawIgnoringOffset" class="openblock item method">
<div class="title">playdate.graphics.image:drawIgnoringOffset(x, y, [flip]) <br> playdate.graphics.image:drawIgnoringOffset(p, [flip])</div>
<div class="content">
<div class="paragraph">
<p>Draws the image ignoring the currently-set <a href="#f-graphics.setDrawOffset"><code>drawOffset</code></a>.</p>
</div>
</div>
</div>
<div id="m-graphics.image.clear" class="openblock item method">
<div class="title">playdate.graphics.image&#58;clear(color)</div>
<div class="content">
<div class="paragraph">
<p>Erases the contents of the image, setting all pixels to white if <em>color</em> is <em>playdate.graphics.kColorWhite</em>, black if it&#8217;s <em>playdate.graphics.kColorBlack</em>, or clear if it&#8217;s <em>playdate.graphics.kColorClear</em>. If the image is cleared to black or white, the mask (if it exists) is set to fully opaque. If the image is cleared to kColorClear and the image doesn&#8217;t have a mask, a mask is added to it.</p>
</div>
</div>
</div>
<div id="m-graphics.image.sample" class="openblock item method">
<div class="title">playdate.graphics.image:sample(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Returns <em>playdate.graphics.kColorWhite</em> if the image is white at (<em>x</em>, <em>y</em>), <em>playdate.graphics.kColorBlack</em> if it&#8217;s black, or <em>playdate.graphics.kColorClear</em> if it&#8217;s transparent.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The upper-left pixel of the image is at coordinate <em>(0, 0)</em>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_image_transformations">Image transformations</h5>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
The following functions can be quite slow, especially when rotating images off-axis. Transforming a large image can take many milliseconds on the device. Be sure to test performance on the hardware when using these functions.
</td>
</tr>
</table>
</div>
<div id="m-graphics.image.drawRotated" class="openblock item method">
<div class="title">playdate.graphics.image:drawRotated(x, y, angle, [scale, [yscale]])</div>
<div class="content">
<div class="paragraph">
<p>Draws this image centered at point <em>(x,y)</em> at (clockwise) <em>angle</em> degrees, scaled by optional argument <em>scale</em>, with an optional separate scaling for the y axis.</p>
</div>
</div>
</div>
<div id="m-graphics.image.rotatedImage" class="openblock item method">
<div class="title">playdate.graphics.image:rotatedImage(angle, [scale, [yscale]])</div>
<div class="content">
<div class="paragraph">
<p>Returns a new image containing this image rotated by (clockwise) <em>angle</em> degrees, scaled by optional argument <em>scale</em>, with an optional separate scaling for the y axis.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Unless rotating by a multiple of 180 degrees, the new image will have different dimensions than the original.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.image.drawScaled" class="openblock item method">
<div class="title">playdate.graphics.image:drawScaled(x, y, scale, [yscale])</div>
<div class="content">
<div class="paragraph">
<p>Draws this image with its upper-left corner at  point <em>(x,y)</em>, scaled by amount <em>scale</em>, with an optional separate scaling for the y axis.</p>
</div>
</div>
</div>
<div id="m-graphics.image.scaledImage" class="openblock item method">
<div class="title">playdate.graphics.image:scaledImage(scale, [yscale])</div>
<div class="content">
<div class="paragraph">
<p>Returns a new image containing this image scaled by amount <em>scale</em>, with an optional separate scaling for the y axis.</p>
</div>
</div>
</div>
<div id="m-graphics.image.drawWithTransform" class="openblock item method">
<div class="title">playdate.graphics.image:drawWithTransform(xform, x, y)</div>
<div class="content">
<div class="paragraph">
<p>Draws this image centered at point <em>(x,y)</em> with the <a href="#C-geometry.affineTransform">transform</a> <em>xform</em> applied.</p>
</div>
</div>
</div>
<div id="m-graphics.image.transformedImage" class="openblock item method">
<div class="title">playdate.graphics.image:transformedImage(xform)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new image containing the image with the <a href="#C-geometry.affineTransform">transform</a> <em>xform</em> applied.</p>
</div>
</div>
</div>
<div id="m-graphics.image.drawSampled" class="openblock item method">
<div class="title">playdate.graphics.image:drawSampled(x, y, width, height, centerx, centery, dxx, dyx, dxy, dyy, dx, dy, z, tiltAngle, tile)</div>
<div class="content">
<div class="paragraph">
<p>Draws the image as if it&#8217;s mapped onto a tilted plane, transforming the target coordinates to image coordinates using an affine transform:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>x' = dxx * x + dyx * y + dx
y' = dxy * x + dyy * y + dy</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><em>x, y, width, height</em>: The rectangle to fill</p>
</li>
<li>
<p><em>centerx, centery</em>: The point in the above rectangle [in (0,1)x(0,1) coordinates] for the center of the transform</p>
</li>
<li>
<p><em>dxx, dyx, dxy, dyy, dx, dy</em>: Defines an affine transform from geometry coordinates to image coordinates</p>
</li>
<li>
<p><em>z</em>: The distance from the viewer to the target plane &mdash; lower z means more exaggerated perspective</p>
</li>
<li>
<p><em>tiltAngle</em>: The tilt of the target plane about the x axis, in degrees</p>
</li>
<li>
<p><em>tile</em>: A boolean, indicating whether the image is tiled on the target plane</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <em>Mode7Driver</em> demo in the <em>/Examples</em> folder of the SDK demonstrates the usage of this function.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_image_masks">Image masks</h5>
<div class="paragraph">
<p>Image masks are how transparency is handled by images on the Playdate. When an image is drawn, the image mask is checked to see what parts of the image should be transparent.</p>
</div>
<div class="paragraph">
<p>The image mask takes the form of another image that must be the same dimensions as the image that it is masking. Regions that should be transparent are filled in with black pixels and opaque regions are filled in with white pixels. Any transparent image that is created or loaded from a file will automatically have an image mask applied to it to handle the transparency. Fully opaque images will, by default, have no image mask. An image may only have at most one image mask.</p>
</div>
<div id="m-graphics.image.setMaskImage" class="openblock item method">
<div class="title">playdate.graphics.image:setMaskImage(maskImage)</div>
<div class="content">
<div class="paragraph">
<p>Sets the image&#8217;s mask to a copy of <em>maskImage</em>.</p>
</div>
</div>
</div>
<div id="m-graphics.image.getMaskImage" class="openblock item method">
<div class="title">playdate.graphics.image:getMaskImage()</div>
<div class="content">
<div class="paragraph">
<p>If the image has a mask, returns the mask as a separate image. Otherwise, returns <code>nil</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
The returned image references the original&#8217;s data, so drawing into this image alters the original image&#8217;s mask.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.image.addMask" class="openblock item method">
<div class="title">playdate.graphics.image&#58;addMask([opaque])</div>
<div class="content">
<div class="paragraph">
<p>Adds a mask to the image if it doesn&#8217;t already have one. If <em>opaque</em> is <code>true</code> or not specified, the image mask applied will be completely white, so the image will be entirely opaque. If <em>opaque</em> is <code>false</code>, the mask will be completely black, so the image will be entirely transparent.</p>
</div>
</div>
</div>
<div id="m-graphics.image.removeMask" class="openblock item method">
<div class="title">playdate.graphics.image:removeMask()</div>
<div class="content">
<div class="paragraph">
<p>Removes the mask from the image if it has one.</p>
</div>
</div>
</div>
<div id="m-graphics.image.hasMask" class="openblock item method">
<div class="title">playdate.graphics.image:hasMask()</div>
<div class="content">
<div class="paragraph">
<p>Returns <em>true</em> if the image has a mask.</p>
</div>
</div>
</div>
<div id="m-graphics.image.clearMask" class="openblock item method">
<div class="title">playdate.graphics.image&#58;clearMask([opaque])</div>
<div class="content">
<div class="paragraph">
<p>Erases the contents of the image&#8217;s mask, so that the image is entirely opaque if <em>opaque</em> is 1, transparent otherwise. This function has no effect if the image doesn&#8217;t have a mask.</p>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example: How transparency is handled by image masks</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- By default, new images are transparent, so an image mask is automatically applied to 'image'</span>
<span class="keyword">local</span> <span class="local-variable">image</span> = playdate.graphics.image.new(<span class="integer">20</span>, <span class="integer">20</span>)
<span class="comment">-- maskImage will be a 20x20 black image, to mark that the entire image should be transparent</span>
<span class="keyword">local</span> <span class="local-variable">maskImage</span> = image:getMaskImage()
maskImage:draw(<span class="integer">0</span>, <span class="integer">0</span>)

<span class="comment">-- When the image is drawn, there will be nothing drawn, because the image mask makes it all transparent</span>
image:draw(<span class="integer">0</span>, <span class="integer">0</span>)

<span class="comment">-- Removing the mask here will result in 'image' no longer having transparency</span>
image:removeMask()

<span class="comment">-- Drawing the image again will draw a black square, because without an image mask, there is no transparency</span>
image:draw(<span class="integer">0</span>, <span class="integer">0</span>)

<span class="comment">-- Hopefully this cements the concept that all transparency is handled by image masks</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Using image masks to apply a dither filter and a hole punch out effect</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- You can copy and paste this example directly as your main.lua file to see it in action</span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/graphics</span><span class="delimiter">&quot;</span></span>

<span class="keyword">local</span> <span class="local-variable">gfx</span> = playdate.graphics

<span class="comment">-- Creating an image with a black circle</span>
<span class="keyword">local</span> <span class="local-variable">circleDiameter</span> = <span class="integer">25</span>
<span class="keyword">local</span> <span class="local-variable">circleImage</span> = gfx.image.new(circleDiameter, circleDiameter)
gfx.pushContext(circleImage)
    gfx.fillCircleInRect(<span class="integer">0</span>, <span class="integer">0</span>, circleImage:getSize())
gfx.popContext()

<span class="comment">-- Saving the original mask (the transparency in the corners of the image not covered by the circle)</span>
<span class="keyword">local</span> <span class="local-variable">circleMask</span> = circleImage:getMaskImage():copy()

<span class="comment">-- Copying the original mask to preserve transparent regions around the circle</span>
<span class="keyword">local</span> <span class="local-variable">ditherMask</span> = circleMask:copy()
<span class="comment">-- Drawing into mask with a dither effect</span>
gfx.pushContext(ditherMask)
    gfx.setColor(gfx.kColorBlack)
    gfx.setDitherPattern(<span class="float">0.5</span>, gfx.image.kDitherTypeBayer8x8)
    gfx.fillRect(<span class="integer">0</span>, <span class="integer">0</span>, ditherMask:getSize())
gfx.popContext()

<span class="comment">-- Copying the original mask to preserve transparent regions around the circle</span>
<span class="keyword">local</span> <span class="local-variable">holeMask</span> = circleMask:copy()
<span class="comment">-- Drawing a hole into mask</span>
gfx.pushContext(holeMask)
    gfx.setColor(gfx.kColorBlack)
    <span class="keyword">local</span> <span class="local-variable">width</span>, <span class="local-variable">height</span> = holeMask:getSize()
    gfx.fillCircleAtPoint(width/<span class="integer">2</span>, height/<span class="integer">2</span>, width/<span class="integer">4</span>)
gfx.popContext()

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    <span class="comment">-- Circle is drawn with dithered regions transparent</span>
    circleImage:setMaskImage(ditherMask)
    circleImage:drawAnchored(<span class="integer">100</span>, <span class="integer">120</span>, <span class="float">0.5</span>, <span class="float">0.5</span>)

    <span class="comment">-- Circle is drawn with hole in center</span>
    circleImage:setMaskImage(holeMask)
    circleImage:drawAnchored(<span class="integer">200</span>, <span class="integer">120</span>, <span class="float">0.5</span>, <span class="float">0.5</span>)

    <span class="comment">-- Resetting the original mask returns the circle to normal</span>
    circleImage:setMaskImage(circleMask)
    circleImage:drawAnchored(<span class="integer">300</span>, <span class="integer">120</span>, <span class="float">0.5</span>, <span class="float">0.5</span>)
<span class="keyword">end</span>

<span class="comment">-- Technical details: Why copy the mask after getting it? :getMaskImage() returns a reference</span>
<span class="comment">-- to the mask image. Using :setMaskImage after will update that mask image to a new image, which</span>
<span class="comment">-- overwrites the referenced image and the original is lost. That's why we make a copy. Of course,</span>
<span class="comment">-- no :copy() calls are necessary if you don't intend to save the original mask.</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_image_effects">Image effects</h5>
<div id="m-graphics.image.drawTiled" class="openblock item method">
<div class="title">playdate.graphics.image:drawTiled(x, y, width, height, [flip]) <br> playdate.graphics.image:drawTiled(rect, [flip])</div>
<div class="content">
<div class="paragraph">
<p>Tiles the image into the given rectangle, using either listed dimensions or a <a href="#C-geometry.rect"><code>playdate.geometry.rect</code></a> object, and the optional flip style.</p>
</div>
</div>
</div>
<div id="m-graphics.image.drawBlurred" class="openblock item method">
<div class="title">playdate.graphics.image:drawBlurred(x, y, radius, numPasses, ditherType, [flip], [xPhase, yPhase])</div>
<div class="content">
<div class="paragraph">
<p>Draws a blurred version of the image at (<em>x</em>, <em>y</em>).</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>radius</em>: A bigger radius means a more blurred result. Processing time is independent of the radius.</p>
</li>
<li>
<p><em>numPasses</em>: A box blur is used to blur the image. The more passes, the more closely the blur approximates a gaussian blur. However, higher values will take more time to process.</p>
</li>
<li>
<p><em>ditherType</em>: The algorithm to use when blurring the image, must be one of the values listed in <a href="#m-graphics.image.blurredImage"><code>playdate.graphics.image:blurredImage()</code></a></p>
</li>
<li>
<p><em>flip</em>: optional; see <a href="#m-graphics.imgDraw"><code>playdate.graphics.image:draw()</code></a> for valid values.</p>
</li>
<li>
<p><em>xPhase</em>, <em>yPhase</em>: optional; integer values that affect the appearance of <em>playdate.graphics.image.kDitherTypeDiagonalLine</em>,  <em>playdate.graphics.image.kDitherTypeVerticalLine</em>, <em>playdate.graphics.image.kDitherTypeHorizontalLine</em>,  <em>playdate.graphics.image.kDitherTypeScreen</em>, <em>playdate.graphics.image.kDitherTypeBayer2x2</em>, <em>playdate.graphics.image.kDitherTypeBayer4x4</em>, and <em>playdate.graphics.image.kDitherTypeBayer8x8</em>.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-graphics.image.blurredImage" class="openblock item method">
<div class="title">playdate.graphics.image:blurredImage(radius, numPasses, ditherType, [padEdges, [xPhase, yPhase]])</div>
<div class="content">
<div class="paragraph">
<p>Returns a blurred copy of the caller.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>radius</em>: A bigger radius means a more blurred result. Processing time is independent of the radius.</p>
</li>
<li>
<p><em>numPasses</em>: A box blur is used to blur the image. The more passes, the more closely the blur approximates a gaussian blur. However, higher values will take more time to process.</p>
</li>
<li>
<p><em>ditherType</em>: The original image is blurred into a greyscale image then dithered back to 1-bit using one of the following dithering algorithms:</p>
<div class="ulist">
<ul>
<li>
<p><a id="k-graphics.image.kDitherTypeNone"></a> <em class="constant">playdate.graphics.image.kDitherTypeNone</em></p>
</li>
<li>
<p><a id="k-graphics.image.kDitherTypeDiagonalLine"></a> <em class="constant">playdate.graphics.image.kDitherTypeDiagonalLine</em></p>
</li>
<li>
<p><a id="k-graphics.image.kDitherTypeVerticalLine"></a> <em class="constant">playdate.graphics.image.kDitherTypeVerticalLine</em></p>
</li>
<li>
<p><a id="k-graphics.image.kDitherTypeHorizontalLine"></a> <em class="constant">playdate.graphics.image.kDitherTypeHorizontalLine</em></p>
</li>
<li>
<p><a id="k-graphics.image.kDitherTypeScreen"></a> <em class="constant">playdate.graphics.image.kDitherTypeScreen</em></p>
</li>
<li>
<p><a id="k-graphics.image.kDitherTypeBayer2x2"></a> <em class="constant">playdate.graphics.image.kDitherTypeBayer2x2</em></p>
</li>
<li>
<p><a id="k-graphics.image.kDitherTypeBayer4x4"></a> <em class="constant">playdate.graphics.image.kDitherTypeBayer4x4</em></p>
</li>
<li>
<p><a id="k-graphics.image.kDitherTypeBayer8x8"></a> <em class="constant">playdate.graphics.image.kDitherTypeBayer8x8</em></p>
</li>
<li>
<p><a id="k-graphics.image.kDitherTypeFloydSteinberg"></a> <em class="constant">playdate.graphics.image.kDitherTypeFloydSteinberg</em></p>
</li>
<li>
<p><a id="k-graphics.image.kDitherTypeBurkes"></a> <em class="constant">playdate.graphics.image.kDitherTypeBurkes</em></p>
</li>
<li>
<p><a id="k-graphics.image.kDitherTypeAtkinson"></a> <em class="constant">playdate.graphics.image.kDitherTypeAtkinson</em></p>
</li>
</ul>
</div>
</li>
<li>
<p><em>padEdges</em>: Boolean indicating whether the edges of the images should be padded to accommodate the blur radius. Defaults to false.</p>
</li>
<li>
<p><em>xPhase</em>, <em>yPhase</em>: optional; integer values that affect the appearance of <em>playdate.graphics.image.kDitherTypeDiagonalLine</em>,  <em>playdate.graphics.image.kDitherTypeVerticalLine</em>, <em>playdate.graphics.image.kDitherTypeHorizontalLine</em>,  <em>playdate.graphics.image.kDitherTypeScreen</em>, <em>playdate.graphics.image.kDitherTypeBayer2x2</em>, <em>playdate.graphics.image.kDitherTypeBayer4x4</em>, and <em>playdate.graphics.image.kDitherTypeBayer8x8</em>.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-graphics.image.drawFaded" class="openblock item method">
<div class="title">playdate.graphics.image:drawFaded(x, y, alpha, ditherType)</div>
<div class="content">
<div class="paragraph">
<p>Draws a partially transparent image with its upper-left corner at location (<em>x</em>, <em>y</em>)</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>alpha</em>: The alpha value used to draw the image, with 1 being fully opaque, and 0 being completely transparent.</p>
</li>
<li>
<p><em>ditherType</em>: The caller is faded using one of the dithering algorithms listed in <a href="#m-graphics.image.blurredImage"><code>playdate.graphics.image:blurredImage()</code></a></p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-graphics.image.fadedImage" class="openblock item method">
<div class="title">playdate.graphics.image:fadedImage(alpha, ditherType)</div>
<div class="content">
<div class="paragraph">
<p>Returns a faded version of the caller.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>alpha</em>: The alpha value assigned to the caller, in the range 0.0 - 1.0. If an image mask already exists it is multiplied by <em>alpha</em>.</p>
</li>
<li>
<p><em>ditherType</em>: The caller is faded into a greyscale image and dithered with one of the dithering algorithms listed in <a href="#m-graphics.image.blurredImage">playdate.graphics.image:blurredImage()</a></p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-graphics.image.setInverted" class="openblock item method">
<div class="title">playdate.graphics.image:setInverted(flag)</div>
<div class="content">
<div class="paragraph">
<p>If <em>flag</em> is true, the image will be drawn with its colors inverted. If the image is being used as a stencil, its behavior is reversed: pixels are drawn where the stencil is black, nothing is drawn where the stencil is white.</p>
</div>
</div>
</div>
<div id="m-graphics.image.invertedImage" class="openblock item method">
<div class="title">playdate.graphics.image:invertedImage()</div>
<div class="content">
<div class="paragraph">
<p>Returns a color-inverted copy of the caller.</p>
</div>
</div>
</div>
<div id="m-graphics.image.blendWithImage" class="openblock item method">
<div class="title">playdate.graphics.image:blendWithImage(image, alpha, ditherType)</div>
<div class="content">
<div class="paragraph">
<p>Returns an image that is a blend between the caller and <em>image</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>image</em>: the playdate.graphics.image to be blended with the caller.</p>
</li>
<li>
<p><em>alpha</em>: The alpha value assigned to the caller. <em>image</em> will have an alpha of (1 - <em>alpha</em>).</p>
</li>
<li>
<p><em>ditherType</em>: The caller and <em>image</em> are blended into a greyscale image and dithered with one of the dithering algorithms listed in <a href="#m-graphics.image.blurredImage"><code>playdate.graphics.image:blurredImage()</code></a></p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-graphics.image.vcrPauseFilterImage" class="openblock item method">
<div class="title">playdate.graphics.image:vcrPauseFilterImage()</div>
<div class="content">
<div class="paragraph">
<p>Returns an image created by applying a VCR pause effect to the calling image.</p>
</div>
<div class="paragraph">
<p>To add a VCR effect to a single image, call this function once on the source image; the function will return a distorted version of the source image. To add a VCR effect to a series of frames / video, call this function on every frame and display each returned image. (This function uses an internal random number to determine the appearance of the effect on each frame, so the effect will vary from frame to frame in a way that makes it appear like "live" paused video.)</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_other_image_stuff">Other image stuff</h5>
<div id="f-graphics.checkAlphaCollision" class="openblock item function">
<div class="title">playdate.graphics.checkAlphaCollision(image1, x1, y1, flip1, image2, x2, y2, flip2)</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the non-alpha-masked portions of <em>image1</em> and <em>image2</em> overlap if they were drawn at positions (<em>x1</em>, <em>y1</em>) and (<em>x2</em>, <em>y2</em>) and flipped according to <em>flip1</em> and <em>flip2</em>, which should each be one of the values listed in <a href="#m-graphics.imgDraw"><code>playdate.graphics.image:draw()</code></a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_color_pattern">Color &amp; Pattern</h4>
<div id="f-graphics.setColor" class="openblock item function">
<div class="title">playdate.graphics.setColor(color)</div>
<div class="content">
<div class="paragraph">
<p>Sets and gets the current drawing color for primitives.</p>
</div>
<div class="paragraph">
<p><em>color</em> should be one of the constants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kColorBlack</em></p>
</li>
<li>
<p><em>playdate.graphics.kColorWhite</em></p>
</li>
<li>
<p><em>playdate.graphics.kColorClear</em></p>
</li>
<li>
<p><em>playdate.graphics.kColorXOR</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This color applies to drawing primitive shapes such as lines and rectangles, not bitmap images.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<a href="#f-graphics.setColor"><code>setColor()</code></a> and <a href="#f-graphics.setPattern"><code>setPattern()</code></a> / <a href="#f-graphics.setDitherPattern"><code>setDitherPattern()</code></a> are mutually exclusive. Setting a color will overwrite a pattern, and vice versa.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-graphics.getColor" class="openblock item function">
<div class="title">playdate.graphics.getColor()</div>
<div class="content">
<div class="paragraph">
<p>Gets the current drawing color for primitives.</p>
</div>
</div>
</div>
<div id="f-graphics.setBackgroundColor" class="openblock item function xref">
<div class="title">playdate.graphics.setBackgroundColor(color)</div>
<div class="content">
<div class="paragraph">
<p>Sets the color used for drawing the background, if necessary, before <a href="#C-graphics.sprite">playdate.graphics.sprite</a>s are drawn on top.</p>
</div>
<div class="paragraph">
<p><em>color</em> should be one of the constants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kColorBlack</em></p>
</li>
<li>
<p><em>playdate.graphics.kColorWhite</em></p>
</li>
<li>
<p><em>playdate.graphics.kColorClear</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use <em>kColorClear</em> if you intend to draw behind sprites.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.setBackgroundColor"><code>playdate-&gt;graphics-&gt;setBackgroundColor()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-graphics.getBackgroundColor" class="openblock item function">
<div class="title">playdate.graphics.getBackgroundColor()</div>
<div class="content">
<div class="paragraph">
<p>Gets the color used for drawing the background, if necessary, before <a href="#C-graphics.sprite">playdate.graphics.sprite</a>s are drawn on top.</p>
</div>
</div>
</div>
<div id="f-graphics.setPattern" class="openblock item function">
<div class="title">playdate.graphics.setPattern(pattern)</div>
<div class="content">
<div class="paragraph">
<p>Sets the 8x8 pattern used for drawing. The <em>pattern</em> argument is an array of 8 numbers describing the bitmap for each row; for example, <em>{ 0xaa, 0x55, 0xaa, 0x55, 0xaa, 0x55, 0xaa, 0x55 }</em> specifies a checkerboard pattern. An additional 8 numbers can be specified for an alpha mask bitmap.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
To "un-set" a pattern, call <a href="#f-graphics.setColor"><code>setColor()</code></a>. <a href="#f-graphics.setColor"><code>setColor()</code></a> and <a href="#f-graphics.setPattern"><code>setPattern()</code></a> / <a href="#f-graphics.setDitherPattern"><code>setDitherPattern()</code></a> are mutually exclusive. Setting a pattern will overwrite a color, and vice versa.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><strong>playdate.graphics.setPattern(image, [x, y])</strong></code></p>
</div>
<div class="paragraph">
<p>Uses the given <a href="#C-graphics.image">playdate.graphics.image</a> to set the 8 x 8 pattern used for drawing. The optional <em>x</em>, <em>y</em> offset (default 0, 0) indicates the top left corner of the 8 x 8 pattern.</p>
</div>
</div>
</div>
<div id="f-graphics.setDitherPattern" class="openblock item function">
<div class="title">playdate.graphics.setDitherPattern(alpha, [ditherType])</div>
<div class="content">
<div class="paragraph">
<p>Sets the pattern used for drawing to a dithered pattern. If the current drawing color is white, the pattern is white pixels on a transparent background and (due to a bug) the <em>alpha</em> value is inverted: 1.0 is transparent and 0 is opaque. Otherwise, the pattern is black pixels on a transparent background and <em>alpha</em> 0 is transparent while 1.0 is opaque.</p>
</div>
<div class="paragraph">
<p>The optional <em>ditherType</em> argument is a dither type as used in <a href="#m-graphics.image.blurredImage"><code>playdate.graphics.image:blurredImage()</code></a>, and should be an ordered dither type; i.e., line, screen, or Bayer.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
The error-diffusing dither types Floyd-Steinberg (<code>kDitherTypeFloydSteinberg</code>), Burkes (<code>kDitherTypeBurkes</code>), and Atkinson (<code>kDitherTypeAtkinson</code>) are allowed but produce very unpredictable results here.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_drawing">Drawing</h4>
<div class="sect4">
<h5 id="_line">Line</h5>
<div id="f-graphics.drawLine" class="openblock item function xref">
<div class="title">playdate.graphics.drawLine(x1, y1, x2, y2) <br> playdate.graphics.drawLine(ls)</div>
<div class="content">
<div class="paragraph">
<p>Draws a line from (<em>x1</em>, <em>y1</em>) to (<em>x2</em>, <em>y2</em>), or draws the <a href="#C-geometry.lineSegment">playdate.geometry.lineSegment</a> <em>ls</em>.</p>
</div>
<div class="paragraph">
<p>Line width is specified by <a href="#f-graphics.setLineWidth">setLineWidth()</a>. End cap style is specified by <a href="#f-graphics.setLineCapStyle">setLineCapStyle()</a>.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.drawLine"><code>playdate-&gt;graphics-&gt;drawLine()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-graphics.setLineCapStyle" class="openblock item function xref">
<div class="title">playdate.graphics.setLineCapStyle(style)</div>
<div class="content">
<div class="paragraph">
<p>Specifies the shape of the endpoints drawn by <a href="#f-graphics.drawLine">drawLine</a>.</p>
</div>
<div class="paragraph">
<p><em>style</em> should be one of these constants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kLineCapStyleButt</em></p>
</li>
<li>
<p><em>playdate.graphics.kLineCapStyleRound</em></p>
</li>
<li>
<p><em>playdate.graphics.kLineCapStyleSquare</em></p>
</li>
</ul>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.setLineCapStyle"><code>playdate-&gt;graphics-&gt;setLineCapStyle()</code></a> in the C API.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_pixel">Pixel</h5>
<div id="f-graphics.drawPixel" class="openblock item function">
<div class="title">playdate.graphics.drawPixel(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Draw a single pixel in the current color at (<em>x</em>, <em>y</em>).</p>
</div>
<div class="paragraph">
<p><code><strong>playdate.graphics.drawPixel(p)</strong></code></p>
</div>
<div class="paragraph">
<p>Draw a single pixel in the current color at <a href="#C-geometry.point">playdate.geometry.point</a> <em>p</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_rect">Rect</h5>
<div id="f-graphics.drawRect" class="openblock item function xref">
<div class="title">playdate.graphics.drawRect(x, y, w, h) <br> playdate.graphics.drawRect(r)</div>
<div class="content">
<div class="paragraph">
<p>Draws the rect <em>r</em> or the rect with origin (<em>x</em>, <em>y</em>) with a size of (<em>w</em>, <em>h</em>).</p>
</div>
<div class="paragraph">
<p>Line width is specified by <a href="#f-graphics.setLineWidth">setLineWidth()</a>. Stroke location is specified by <a href="#f-graphics.setStrokeLocation">setStrokeLocation()</a>.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.drawRect"><code>playdate-&gt;graphics-&gt;drawRect()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-graphics.fillRect" class="openblock item function xref">
<div class="title">playdate.graphics.fillRect(x, y, width, height) <br> playdate.graphics.fillRect(r)</div>
<div class="content">
<div class="paragraph">
<p>Draws the filled rectangle <em>r</em> or the rect at (<em>x</em>, <em>y</em>) of the given width and height.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.fillRect"><code>playdate-&gt;graphics-&gt;fillRect()</code></a> in the C API.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_round_rect">Round rect</h5>
<div id="f-graphics.drawRoundRect" class="openblock item function">
<div class="title">playdate.graphics.drawRoundRect(x, y, w, h, radius) <br> playdate.graphics.drawRoundRect(r, radius)</div>
<div class="content">
<div class="paragraph">
<p>Draws a rectangle with rounded corners in the rect <em>r</em> or the rect with origin (<em>x</em>, <em>y</em>) and size (<em>w</em>, <em>h</em>).</p>
</div>
<div class="paragraph">
<p><em>radius</em> defines the radius of the corners.</p>
</div>
</div>
</div>
<div id="f-graphics.fillRoundRect" class="openblock item function">
<div class="title">playdate.graphics.fillRoundRect(x, y, w, h, radius) <br> playdate.graphics.fillRoundRect(r, radius)</div>
<div class="content">
<div class="paragraph">
<p>Draws a filled rectangle with rounded corners in the rect <em>r</em> or the rect with origin (<em>x</em>, <em>y</em>) and size (<em>w</em>, <em>h</em>).</p>
</div>
<div class="paragraph">
<p><em>radius</em> defines the radius of the corners.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_arc">Arc</h5>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/graphics</em> to use the arc drawing functions.
</td>
</tr>
</table>
</div>
<div id="f-graphics.drawArc" class="openblock item function">
<div class="title">playdate.graphics.drawArc(arc) <br> playdate.graphics.drawArc(x, y, radius, startAngle, endAngle)</div>
<div class="content">
<div class="paragraph">
<p>Draws an arc using the current color.</p>
</div>
<div class="paragraph">
<p>Angles are specified in degrees, not radians.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_circle">Circle</h5>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/graphics</em> to use the circle drawing functions.
</td>
</tr>
</table>
</div>
<div id="f-graphics.drawCircleAtPoint" class="openblock item function">
<div class="title">playdate.graphics.drawCircleAtPoint(x, y, radius) <br> playdate.graphics.drawCircleAtPoint(p, radius)</div>
<div class="content">
<div class="paragraph">
<p>Draws a circle at the point <em>(x, y)</em> (or <em>p</em>) with radius <em>radius</em>.</p>
</div>
</div>
</div>
<div id="f-graphics.drawCircleInRect" class="openblock item function">
<div class="title">playdate.graphics.drawCircleInRect(x, y, width, height) <br> playdate.graphics.drawCircleInRect(r)</div>
<div class="content">
<div class="paragraph">
<p>Draws a circle in the rect <em>r</em> or the rect with origin <em>(x, y)</em> and size <em>(width, height)</em>.</p>
</div>
<div class="paragraph">
<p>If the rect is not a square, the circle will be drawn centered in the rect.</p>
</div>
</div>
</div>
<div id="f-graphics.fillCircleAtPoint" class="openblock item function">
<div class="title">playdate.graphics.fillCircleAtPoint(x, y, radius) <br> playdate.graphics.fillCircleAtPoint(p, radius)</div>
<div class="content">
<div class="paragraph">
<p>Draws a filled circle at the point <em>(x, y)</em> (or <em>p</em>) with radius <em>radius</em>.</p>
</div>
</div>
</div>
<div id="f-graphics.fillCircleInRect" class="openblock item function">
<div class="title">playdate.graphics.fillCircleInRect(x, y, width, height) <br> playdate.graphics.fillCircleInRect(r)</div>
<div class="content">
<div class="paragraph">
<p>Draws a filled circle in the rect <em>r</em> or the rect with origin <em>(x, y)</em> and size <em>(width, height)</em>.</p>
</div>
<div class="paragraph">
<p>If the rect is not a square, the circle will be drawn centered in the rect.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ellipse">Ellipse</h5>
<div id="f-graphics.drawEllipseInRect" class="openblock item function">
<div class="title">playdate.graphics.drawEllipseInRect(x, y, width, height, [startAngle, endAngle]) <br> playdate.graphics.drawEllipseInRect(rect, [startAngle, endAngle])</div>
<div class="content">
<div class="paragraph">
<p>Draws an ellipse in the rect <em>r</em> or the rect with origin <em>(x, y)</em> and size <em>(width, height)</em>.</p>
</div>
<div class="paragraph">
<p><em>startAngle</em> and <em>endAngle</em>, if provided, should be in degrees (not radians), and will cause only the segment of the ellipse between <em>startAngle</em> and <em>endAngle</em> to be drawn.</p>
</div>
</div>
</div>
<div id="f-graphics.fillEllipseInRect" class="openblock item function">
<div class="title">playdate.graphics.fillEllipseInRect(x, y, width, height, [startAngle, endAngle]) <br> playdate.graphics.fillEllipseInRect(rect, [startAngle, endAngle])</div>
<div class="content">
<div class="paragraph">
<p>Draws a filled ellipse in the rect <em>r</em> or the rect with origin <em>(x, y)</em> and size <em>(width, height)</em>.</p>
</div>
<div class="paragraph">
<p><em>startAngle</em> and <em>endAngle</em>, if provided, should be in degrees (not radians), and will cause only the segment of the ellipse between <em>startAngle</em> and <em>endAngle</em> to be drawn.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_polygon">Polygon</h5>
<div id="f-graphics.drawPolygon" class="openblock item function">
<div class="title">playdate.graphics.drawPolygon(p)</div>
<div class="content">
<div class="paragraph">
<p>Draw the <a href="#C-geometry.polygon">playdate.geometry.polygon</a> <em>p</em>. Only draws a line between the first and last vertex if the polygon is <a href="#m-geometry.polygon.close">closed</a>.</p>
</div>
<div class="paragraph">
<p>Line width is specified by <a href="#f-graphics.setLineWidth">setLineWidth()</a>.</p>
</div>
</div>
</div>
<div id="f-graphics.drawPolygon-list" class="openblock item function">
<div class="title">playdate.graphics.drawPolygon(x1, y1, x2, y2, [...])</div>
<div class="content">
<div class="paragraph">
<p>Draw the polygon specified by the given sequence of x,y coordinates, including an edge between the last vertex and the first. The Lua function <code>table.unpack()</code> can be used to turn an array into function arguments.</p>
</div>
<div class="paragraph">
<p>Line width is specified by <a href="#f-graphics.setLineWidth">setLineWidth()</a>.</p>
</div>
</div>
</div>
<div id="f-graphics.fillPolygon" class="openblock item function xref">
<div class="title">playdate.graphics.fillPolygon(x1, y1, x2, y2, [...])</div>
<div class="content">
<div class="paragraph">
<p>Fills the polygon specified by a list of x,y coordinates. An edge between the last vertex and the first is assumed.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.fillPolygon"><code>playdate-&gt;graphics-&gt;fillPolygon()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-graphics.fillPolygon-p" class="openblock item function">
<div class="title">playdate.graphics.fillPolygon(p)</div>
<div class="content">
<div class="paragraph">
<p>Fills the polygon specified by the <a href="#C-geometry.polygon">playdate.geometry.polygon</a> <em>p</em> with the currently selected color or pattern. The function throws an error if the polygon is not <a href="#m-geometry.polygon.isClosed">closed</a>.</p>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
The Lua function <code>table.unpack()</code> can be used to turn an array into function arguments.
</td>
</tr>
</table>
</div>
<div id="f-graphics.setPolygonFillRule" class="openblock item function">
<div class="title">playdate.graphics.setPolygonFillRule(rule)</div>
<div class="content">
<div class="paragraph">
<p>Sets the winding rule for filling polygons, one of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kPolygonFillNonZero</em></p>
</li>
<li>
<p><em>playdate.graphics.kPolygonFillEvenOdd</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="https://en.wikipedia.org/wiki/Nonzero-rule" class="bare">https://en.wikipedia.org/wiki/Nonzero-rule</a> for an explanation of the winding rule.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_triangle">Triangle</h5>
<div id="f-graphics.drawTriangle" class="openblock item function">
<div class="title">playdate.graphics.drawTriangle(x1, y1, x2, y2, x3, y3)</div>
<div class="content">
<div class="paragraph">
<p>Draws a triangle with vertices (<em>x1</em>, <em>y1</em>), (<em>x2</em>, <em>y2</em>), and (<em>x3</em>, <em>y3</em>).</p>
</div>
</div>
</div>
<div id="f-graphics.fillTriangle" class="openblock item function xref">
<div class="title">playdate.graphics.fillTriangle(x1, y1, x2, y2, x3, y3)</div>
<div class="content">
<div class="paragraph">
<p>Draws a filled triangle with vertices (<em>x1</em>, <em>y1</em>), (<em>x2</em>, <em>y2</em>), and (<em>x3</em>, <em>y3</em>).</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.fillTriangle"><code>playdate-&gt;graphics-&gt;fillTriangle()</code></a> in the C API.</p>
</div>
</div>
</div>
</div>
<div class="sect4 class">
<h5 id="C-graphics.nineSlice">Nine slice</h5>
<div class="paragraph">
<p>A "9 slice" is a rectangular image that is made "stretchable" by being sliced into nine pieces&#8201;&#8212;&#8201;the four corners, the four edges, and the center.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/nineslice</em> to use these functions.
</td>
</tr>
</table>
</div>
<div id="f-graphics.nineSlice.new" class="openblock item function">
<div class="title">playdate.graphics.nineSlice.new(imagePath, innerX, innerY, innerWidth, innerHeight)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new 9 slice image from the image at imagePath with the stretchable region defined by other parameters. The arguments represent the origin and dimensions of the innermost ("center") slice.</p>
</div>
</div>
</div>
<div id="m-graphics.nineSlice.getSize" class="openblock item method">
<div class="title">playdate.graphics.nineSlice:getSize()</div>
<div class="content">
<div class="paragraph">
<p>Returns the size of the 9 slice image as a pair <em>(width, height)</em>.</p>
</div>
</div>
</div>
<div id="m-graphics.nineSlice.getMinSize" class="openblock item method">
<div class="title">playdate.graphics.nineSlice:getMinSize()</div>
<div class="content">
<div class="paragraph">
<p>Returns the minimum size of the 9 slice image as a pair <em>(width, height)</em>.</p>
</div>
</div>
</div>
<div id="m-graphics.nineSlice.drawInRect" class="openblock item method">
<div class="title">playdate.graphics.nineSlice:drawInRect(x, y, width, height) <br> playdate.graphics.nineSlice:drawInRect(rect)</div>
<div class="content">
<div class="paragraph">
<p>Draws the 9 slice image at the desired coordinates by stretching the defined region to achieve the width and height inputs.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_perlin_noise">Perlin noise</h5>
<div class="paragraph">
<p>Perlin noise is an algorithm useful for generating "organic" looking things procedurally, such as terrain, visual effects, and more.  For a good introduction to Perlin noise, see: <a href="http://flafla2.github.io/2014/08/09/perlinnoise.html" class="bare">http://flafla2.github.io/2014/08/09/perlinnoise.html</a></p>
</div>
<div id="f-graphics.perlin" class="openblock item function">
<div class="title">playdate.graphics.perlin(x, y, z, repeat, [octaves, persistence])</div>
<div class="content">
<div class="paragraph">
<p>Returns the Perlin value (from 0.0 to 1.0) at position <em>(x, y, z)</em>.</p>
</div>
<div class="paragraph">
<p>If <em>repeat</em> is greater than 0, the pattern of noise will repeat at that point on all 3 axes.</p>
</div>
<div class="paragraph">
<p><em>octaves</em> is the number of octaves of noise to apply.  Compute time increases linearly with each additional octave, but the results are a bit more organic, consisting of a combination of larger and smaller variations.</p>
</div>
<div class="paragraph">
<p>When using more than one octave, <em>persistence</em> is a value from 0.0 - 1.0 describing the amount the amplitude is scaled each octave.  The lower the value of <em>persistence</em>, the less influence each successive octave has on the final value.</p>
</div>
</div>
</div>
<div id="f-graphics.perlinArray" class="openblock item function">
<div class="title">playdate.graphics.perlinArray(count, x, dx, [y, dy, z, dz, repeat, octaves, persistence])</div>
<div class="content">
<div class="paragraph">
<p>Returns an array of Perlin values at once, avoiding the performance penalty of calling <em>perlin()</em> multiple times in a loop.</p>
</div>
<div class="paragraph">
<p>The parameters are the same as <em>perlin()</em> except:</p>
</div>
<div class="paragraph">
<p><em>count</em> is the number of values to be returned.</p>
</div>
<div class="paragraph">
<p><em>dx</em>, <em>dy</em>, and <em>dz</em> are how far to step along the x, y, and z axes in each iteration.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_qrcode">QRCode</h5>
<div id="f-graphics.generateQRCode" class="openblock item function">
<div class="title">playdate.graphics.generateQRCode(stringToEncode, desiredEdgeDimension, callback)</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/qrcode</em> to use this function.
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
This function uses <a href="#C-timer"><code>playdate.timer</code></a> internally, so be sure to call <a href="#f-timer.updateTimers"><code>playdate.timer.updateTimers()</code></a> in your main <a href="#c-update"><code>playdate.update()</code></a> function, otherwise the callback will never be invoked.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Asynchronously returns an image representing a QR code for the passed-in string to the function <code>callback</code>. The arguments passed to the callback are <a href="#C-graphics.image"><em>image</em></a>, <em>errorMessage</em>. (If an <em>errorMessage</em> string is returned, <em>image</em> will be nil.)</p>
</div>
<div class="paragraph">
<p><code>desiredEdgeDimension</code> lets you specify an approximate edge dimension in pixels for the desired QR code, though the function has limited flexibility in sizing QR codes, based on the amount of information to be encoded, and the restrictions of a 1-bit screen. The function will attempt to generate a QR code <em>smaller</em> than <code>desiredEdgeDimension</code> if possible. (Note that QR codes always have the same width and height.)</p>
</div>
<div class="paragraph">
<p>If you specify nil for <code>desiredEdgeDimension</code>, the returned image will balance small size with easy readability. If you specify 0, the returned image will be the smallest possible QR code for the specified string.</p>
</div>
<div class="paragraph">
<p><code>generateQRCode()</code> will return a reference to the <a href="#C-timer">timer</a> it uses to run asynchronously. If you wish to stop execution of the background process generating the QR code, call <a href="#m-timer.remove"><code>:remove()</code></a> on that returned timer.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If you know ahead of time what data you plan to encode, it is much faster to pre-generate the QR code, store it as a .png file in your game, and draw the .png at runtime. You can use <a href="#f-simulator.writeToFile"><code>playdate.simulator.writeToFile()</code></a> to create this .png file.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_sine_wave">Sine wave</h5>
<div id="f-graphics.drawSineWave" class="openblock item function">
<div class="title">playdate.graphics.drawSineWave(startX, startY, endX, endY, startAmplitude, endAmplitude, period, [phaseShift])</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/graphics</em> to use this function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Draws an approximation of a sine wave between the points <em>startX, startY</em> and <em>endX, endY</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>startAmplitude</em>: The number of pixels above and below the line from <em>startX, startY</em> and <em>endX, endY</em> the peaks and valleys of the wave will be drawn at the start of the wave.</p>
</li>
<li>
<p><em>endAmplitude</em>: The number of pixels above and below the line from <em>startX, startY</em> and <em>endX, endY</em> the peaks and valleys of the wave will be drawn at the end of the wave.</p>
</li>
<li>
<p><em>period</em>: The distance between peaks, in pixels.</p>
</li>
<li>
<p><em>phaseShift</em>: If provided, specifies the wave&#8217;s offset, in pixels.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_drawing_modifiers">Drawing Modifiers</h4>
<div class="sect4">
<h5 id="_clipping">Clipping</h5>
<div id="f-graphics.setClipRect" class="openblock item function xref">
<div class="title">playdate.graphics.setClipRect(x, y, width, height) <br> playdate.graphics.setClipRect(rect)</div>
<div class="content">
<div class="paragraph">
<p><code>setClipRect()</code> sets the clipping rectangle for all subsequent graphics drawing, including bitmaps. The argument can either be separate dimensions or a <a href="#C-geometry.rect">playdate.geometry.rect</a> object. The clip rect is automatically cleared at the beginning of the <a href="#c-update"><code>playdate.update()</code></a> callback. The function uses world coordinates; that is, the given rectangle will be translated by the current drawing offset. To use screen coordinates instead, use <a href="#f-graphics.setScreenClipRect"><code>setScreenClipRect()</code></a></p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.setClipRect"><code>playdate-&gt;graphics-&gt;setClipRect()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-graphics.setClipRect-rect" class="openblock item function">
<div class="title">playdate.graphics.setClipRect(rect)</div>
<div class="content">
<div class="paragraph">
<p><code>setClipRect()</code> sets the clipping rectangle for all subsequent graphics drawing, including bitmaps. The argument can either be separate dimensions or a <a href="#C-geometry.rect">playdate.geometry.rect</a> object. The clip rect is automatically cleared at the beginning of the <a href="#c-update"><code>playdate.update()</code></a> callback. The function uses world coordinates; that is, the given rectangle will be translated by the current drawing offset. To use screen coordinates instead, use <a href="#f-graphics.setScreenClipRect"><code>setScreenClipRect()</code></a></p>
</div>
</div>
</div>
<div id="f-graphics.getClipRect" class="openblock item function">
<div class="title">playdate.graphics.getClipRect()</div>
<div class="content">
<div class="paragraph">
<p><code>getClipRect()</code> returns multiple values (<em>x</em>, <em>y</em>, <em>width</em>, <em>height</em>) giving the current clipping rectangle.</p>
</div>
</div>
</div>
<div id="f-graphics.setScreenClipRect" class="openblock item function xref">
<div class="title">playdate.graphics.setScreenClipRect(x, y, width, height) <br> playdate.graphics.setScreenClipRect(rect)</div>
<div class="content">
<div class="paragraph">
<p>Sets the clip rectangle as above, but uses screen coordinates instead of world coordinates&#8212;&#8203;that is, it ignores the current drawing offset.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.setScreenClipRect"><code>playdate-&gt;graphics-&gt;setScreenClipRect()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-graphics.getScreenClipRect" class="openblock item function">
<div class="title">playdate.graphics.getScreenClipRect()</div>
<div class="content">
<div class="paragraph">
<p>Returns the clip rect as in <code>getClipRect()</code>, but using screen coordinates instead of world coordinates.</p>
</div>
</div>
</div>
<div id="f-graphics.clearClipRect" class="openblock item function xref">
<div class="title">playdate.graphics.clearClipRect()</div>
<div class="content">
<div class="paragraph">
<p>Clears the current clipping rectangle, set with <a href="#f-graphics.setClipRect"><code>setClipRect()</code></a>.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.clearClipRect"><code>playdate-&gt;graphics-&gt;clearClipRect()</code></a> in the C API.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_stencil">Stencil</h5>
<div id="f-graphics.setStencilImage" class="openblock item function xref">
<div class="title">playdate.graphics.setStencilImage(image, [tile])</div>
<div class="content">
<div class="paragraph">
<p>Sets the current <a href="https://en.wikipedia.org/wiki/Stencil_buffer">stencil</a> to the given image. While the stencil is active, drawing functions will only draw pixels where the stencil is white and nothing is drawn where the stencil is black. If <em>tile</em> is set, the the stencil will be tiled; in this case, the image width must be a multiple of 32 pixels.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.setStencilImage"><code>playdate-&gt;graphics-&gt;setStencilImage()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-graphics.setStencilPattern" class="openblock item function">
<div class="title">playdate.graphics.setStencilPattern(pattern)</div>
<div class="content">
<div class="paragraph">
<p>Sets a pattern to use for stenciled drawing, as an alternative to creating an image, drawing a pattern into the image, then using that in <code>setStencilImage()</code>. <code>pattern</code> should be a table of the form <code>{ row1, row2, row3, row4, row5, row6, row7, row8 }</code>.</p>
</div>
</div>
</div>
<div id="f-graphics.setStencilPattern-rows" class="openblock item function">
<div class="title">playdate.graphics.setStencilPattern(row1, row2, row3, row4, row5, row6, row7, row8)</div>
<div class="content">
<div class="paragraph">
<p>Sets a pattern to use for stenciled drawing, as an alternative to creating an image, drawing a pattern into the image, then using that in <code>setStencilImage()</code>.</p>
</div>
</div>
</div>
<div id="f-graphics.setStencilPattern-dither" class="openblock item function">
<div class="title">playdate.graphics.setStencilPattern(level, [ditherType])</div>
<div class="content">
<div class="paragraph">
<p>Sets the stencil to a dither pattern specified by <em>level</em> and optional <em>ditherType</em> (defaults to <code>playdate.graphics.image.kDitherTypeBayer8x8</code>).</p>
</div>
</div>
</div>
<div id="f-graphics.clearStencil" class="openblock item function">
<div class="title">playdate.graphics.clearStencil()</div>
<div class="content">
<div class="paragraph">
<p>Clears the <a href="https://en.wikipedia.org/wiki/Stencil_buffer">stencil buffer</a>.</p>
</div>
</div>
</div>
<div id="f-graphics.clearStencilImage" class="openblock item function">
<div class="title">playdate.graphics.clearStencilImage()</div>
<div class="content">
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
<em>Deprecated.</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Clears the <a href="https://en.wikipedia.org/wiki/Stencil_buffer">stencil buffer</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_drawing_mode">Drawing mode</h5>
<div id="f-graphics.setImageDrawMode" class="openblock item function">
<div class="title">playdate.graphics.setImageDrawMode(mode)</div>
<div class="content">
<div class="paragraph">
<p>Sets the current drawing mode for images.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
The draw mode applies to images and fonts (which are technically images). The draw mode does not apply to primitive shapes such as lines or rectangles.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The available options for <em>mode</em> (demonstrated by drawing a two-color background image first, setting the specified draw mode, then drawing the Crankin' character on top) are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kDrawModeCopy</em>: Images are drawn exactly as they are (black pixels are drawn black and white pixels are drawn white)</p>
</li>
</ul>
</div>
<div class="imageblock pixelart">
<div class="content">
<img src="Inside%20Playdate/drawmode-copy.png" alt="drawmode copy">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kDrawModeWhiteTransparent</em>: Any white portions of an image are drawn transparent (black pixels are drawn black and white pixels are drawn transparent)</p>
</li>
</ul>
</div>
<div class="imageblock pixelart">
<div class="content">
<img src="Inside%20Playdate/drawmode-whitetransparent.png" alt="drawmode whitetransparent">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kDrawModeBlackTransparent</em>: Any black portions of an image are drawn transparent (black pixels are drawn transparent and white pixels are drawn white)</p>
</li>
</ul>
</div>
<div class="imageblock pixelart">
<div class="content">
<img src="Inside%20Playdate/drawmode-blacktransparent.png" alt="drawmode blacktransparent">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kDrawModeFillWhite</em>: All non-transparent pixels are drawn white (black pixels are drawn white and white pixels are drawn white)</p>
</li>
</ul>
</div>
<div class="imageblock pixelart">
<div class="content">
<img src="Inside%20Playdate/drawmode-fillwhite.png" alt="drawmode fillwhite">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kDrawModeFillBlack</em>: All non-transparent pixels are drawn black (black pixels are drawn black and white pixels are drawn black)</p>
</li>
</ul>
</div>
<div class="imageblock pixelart">
<div class="content">
<img src="Inside%20Playdate/drawmode-fillblack.png" alt="drawmode fillblack">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kDrawModeXOR</em>: Pixels are drawn inverted on white backgrounds, creating an effect where any white pixels in the original image will always be visible, regardless of the background color, and any black pixels will appear transparent (on a white background, black pixels are drawn white and white pixels are drawn black)</p>
</li>
</ul>
</div>
<div class="imageblock pixelart">
<div class="content">
<img src="Inside%20Playdate/drawmode-xor.png" alt="drawmode xor">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kDrawModeNXOR</em>: Pixels are drawn inverted on black backgrounds, creating an effect where any black pixels in the original image will always be visible, regardless of the background color, and any white pixels will appear transparent (on a black background, black pixels are drawn white and white pixels are drawn black)</p>
</li>
</ul>
</div>
<div class="imageblock pixelart">
<div class="content">
<img src="Inside%20Playdate/drawmode-nxor.png" alt="drawmode nxor">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kDrawModeInverted</em>: Pixels are drawn inverted (black pixels are drawn white and white pixels are drawn black)</p>
</li>
</ul>
</div>
<div class="imageblock pixelart">
<div class="content">
<img src="Inside%20Playdate/drawmode-inverted.png" alt="drawmode inverted">
</div>
</div>
<div class="paragraph">
<p>Instead of the above-specified constants, you can also use one of the following strings: "copy", "inverted", "XOR", "NXOR", "whiteTransparent", "blackTransparent", "fillWhite", or "fillBlack".</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.setDrawMode"><code>playdate-&gt;graphics-&gt;setDrawMode()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-graphics.getImageDrawMode" class="openblock item function">
<div class="title">playdate.graphics.getImageDrawMode()</div>
<div class="content">
<div class="paragraph">
<p>Gets the current drawing mode for images.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_lines_strokes">Lines &amp; Strokes</h5>
<div id="f-graphics.setLineWidth" class="openblock item function">
<div class="title">playdate.graphics.setLineWidth(width)</div>
<div class="content">
<div class="paragraph">
<p>Sets the width of the line for <a href="#f-graphics.drawLine">drawLine</a>, <a href="#f-graphics.drawRect">drawRect</a>, <a href="#f-graphics.drawPolygon">drawPolygon</a>, and <a href="#f-graphics.drawArc">drawArc</a> when a <a href="#C-geometry.arc">playdate.geometry.arc</a> is passed as the argument. This value is saved and restored when pushing and popping the <a href="#f-graphics.pushContext">graphics context</a>.</p>
</div>
</div>
</div>
<div id="f-graphics.getLineWidth" class="openblock item function">
<div class="title">playdate.graphics.getLineWidth()</div>
<div class="content">
<div class="paragraph">
<p>Gets the current line width.</p>
</div>
</div>
</div>
<div id="f-graphics.setStrokeLocation" class="openblock item function">
<div class="title">playdate.graphics.setStrokeLocation(location)</div>
<div class="content">
<div class="paragraph">
<p>Specifies where the stroke is placed relative to the rectangle passed into <a href="#f-graphics.drawRect">drawRect</a>.</p>
</div>
<div class="paragraph">
<p><em>location</em> is one of these constants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kStrokeCentered</em></p>
</li>
<li>
<p><em>playdate.graphics.kStrokeOutside</em></p>
</li>
<li>
<p><em>playdate.graphics.kStrokeInside</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This value is saved and restored when pushing and popping the <a href="#f-graphics.pushContext">graphics context</a>.</p>
</div>
</div>
</div>
<div id="f-graphics.getStrokeLocation" class="openblock item function">
<div class="title">playdate.graphics.getStrokeLocation()</div>
<div class="content">
<div class="paragraph">
<p>Gets the current stroke position.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_offscreen_drawing">Offscreen Drawing</h4>
<div id="f-graphics.lockFocus" class="openblock item function">
<div class="title">playdate.graphics.lockFocus(image)</div>
<div class="content">
<div class="paragraph">
<p><code>lockFocus()</code> routes all drawing to the given <a href="#C-graphics.image">playdate.graphics.image</a>. <a href="#f-graphics.unlockFocus">playdate.graphics.unlockFocus()</a> returns drawing to the frame buffer.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
If you draw into an image with color set to <em>playdate.graphics.kColorClear</em>, those drawn pixels will be set to transparent. When you later draw the image into the framebuffer, those pixels will not be rendered, i.e., will act as transparent pixels in the image.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<a href="#f-graphics.pushContext">playdate.graphics.pushContext(<em>image</em>)</a> will also allow offscreen drawing into an image, with the additional benefit of being able to save and restore the graphics state.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-graphics.unlockFocus" class="openblock item function">
<div class="title">playdate.graphics.unlockFocus()</div>
<div class="content">
<div class="paragraph">
<p>After calling <code>unlockFocus()</code>, drawing is routed to the frame buffer.</p>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Drawing into multiple images with lockFocus</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- If you're drawing into multiple different images, using lockFocus might be easier (and</span>
<span class="comment">-- slightly faster performance-wise) than having to repeatedly call pushContext/popContext</span>

<span class="keyword">local</span> <span class="local-variable">tinyCircle</span> = gfx.image.new(<span class="integer">10</span>, <span class="integer">10</span>)
<span class="keyword">local</span> <span class="local-variable">smallCircle</span> = gfx.image.new(<span class="integer">20</span>, <span class="integer">20</span>)
<span class="keyword">local</span> <span class="local-variable">mediumCircle</span> = gfx.image.new(<span class="integer">30</span>, <span class="integer">30</span>)
<span class="keyword">local</span> <span class="local-variable">largeCircle</span> = gfx.image.new(<span class="integer">40</span>, <span class="integer">40</span>)

gfx.lockFocus(tinyCircle) <span class="comment">-- draw into tinyCircle image</span>
<span class="comment">-- Drawing coordinates are relative to the image, so (0, 0) is the top left of the image</span>
gfx.fillCircleInRect(<span class="integer">0</span>, <span class="integer">0</span>, tinyCircle:getSize())
gfx.lockFocus(smallCircle) <span class="comment">-- draw into smallCircle image</span>
gfx.fillCircleInRect(<span class="integer">0</span>, <span class="integer">0</span>, smallCircle:getSize())
gfx.lockFocus(mediumCircle) <span class="comment">-- draw into mediumCircle image</span>
gfx.fillCircleInRect(<span class="integer">0</span>, <span class="integer">0</span>, mediumCircle:getSize())
gfx.lockFocus(largeCircle) <span class="comment">-- draw into largeCircle image</span>
gfx.fillCircleInRect(<span class="integer">0</span>, <span class="integer">0</span>, largeCircle:getSize())
gfx.unlockFocus() <span class="comment">-- unlock focus to bring drawing back to frame buffer</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_animation">Animation</h4>
<div class="sect4 class">
<h5 id="C-graphics.animation.loop">Animation loop</h5>
<div class="paragraph">
<p>playdate.graphics.animation.loop helps keep track of animation frames, especially for frames in an <a href="#C-graphics.imagetable"><code>playdate.graphics.imagetable</code></a>. For a more general timer see <a href="#C-timer">playdate.timer</a> or <a href="#C-frameTimer">playdate.frameTimer</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/animation</em> to use these functions.
</td>
</tr>
</table>
</div>
<div id="f-graphics.animation.loop.new" class="openblock item function">
<div class="title">playdate.graphics.animation.loop.new([interval], imageTable, [shouldLoop])</div>
<div class="content">
<div class="paragraph">
<p>Creates a new animation object.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><em>imageTable</em></strong> must be a <a href="#C-graphics.imagetable"><code>playdate.graphics.imagetable</code></a> or an array-style table of <a href="#C-graphics.image"><code>playdate.graphics.images</code></a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following properties can be read or set directly, and have these defaults:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><em>interval</em></strong> : the value of <em>interval</em>, if passed, or 100ms (the elapsed time before advancing to the next imageTable frame)</p>
</li>
<li>
<p><strong><em>startFrame</em></strong> : 1 (the value the object resets to when the loop completes)</p>
</li>
<li>
<p><strong><em>endFrame</em></strong> : the number of images in <em>imageTable</em> if passed, or 1 (the last frame value in the loop)</p>
</li>
<li>
<p><strong><em>frame</em></strong> : 1 (the current frame counter)</p>
</li>
<li>
<p><strong><em>step</em></strong> : 1 (the value by which frame increments)</p>
</li>
<li>
<p><strong><em>shouldLoop</em></strong> : the value of <em>shouldLoop</em>, if passed, or true. (whether the object loops when it completes)</p>
</li>
<li>
<p><strong><em>paused</em></strong> : false (paused loops don&#8217;t change their frame value)</p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-graphics.animation.loop.draw" class="openblock item method">
<div class="title">playdate.graphics.animation.loop:draw(x, y, [flip])</div>
<div class="content">
<div class="paragraph">
<p>Draw&#8217;s the loop&#8217;s current image at <em>x</em>, <em>y</em>.</p>
</div>
<div class="paragraph">
<p>The <em>flip</em> argument is optional; see <a href="#m-graphics.imgDraw"><code>playdate.graphics.image:draw()</code></a> for valid values.</p>
</div>
</div>
</div>
<div id="m-graphics.animation.loop.image" class="openblock item method">
<div class="title">playdate.graphics.animation.loop:image()</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-graphics.image"><code>playdate.graphics.image</code></a> from the caller&#8217;s <em>imageTable</em> if it exists. The image returned will be at the imageTable&#8217;s index that matches the caller&#8217;s <em>frame</em>.</p>
</div>
</div>
</div>
<div id="m-graphics.animation.loop.isValid" class="openblock item method">
<div class="title">playdate.graphics.animation.loop:isValid()</div>
<div class="content">
<div class="paragraph">
<p>Returns false if the loop has passed its last frame and does not loop.</p>
</div>
</div>
</div>
<div id="m-graphics.animation.loop.setImageTable" class="openblock item method">
<div class="title">playdate.graphics.animation.loop:setImageTable(imageTable)</div>
<div class="content">
<div class="paragraph">
<p>Sets the <a href="#C-graphics.imagetable"><code>playdate.graphics.imagetable</code></a> to be used for this animation loop, and sets the loop&#8217;s endFrame property to #imageTable.</p>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Using an animation loop to draw an animated image</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">gfx</span> = playdate.graphics

<span class="comment">-- Each frame of the animation will last 200ms</span>
<span class="keyword">local</span> <span class="local-variable">frameTime</span> = <span class="integer">200</span>
<span class="keyword">local</span> <span class="local-variable">animationImagetable</span> = gfx.imagetable.new(<span class="string"><span class="delimiter">&quot;</span><span class="content">path/to/imagetable</span><span class="delimiter">&quot;</span></span>)
<span class="comment">-- Setting the last argument to true makes it so the animation will loop</span>
<span class="keyword">local</span> <span class="local-variable">animationLoop</span> = gfx.animation.loop.new(frameTime, animationImagetable, <span class="predefined-constant">true</span>)

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    <span class="comment">-- Draws the animation in a loop</span>
    animationLoop:draw(<span class="integer">0</span>, <span class="integer">0</span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Creating multiple animation states from one sprite sheet</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">gfx</span> = playdate.graphics

<span class="comment">-- In this example, the imagetable is one sprite sheet, made up of multiple animations</span>
<span class="keyword">local</span> <span class="local-variable">animationImagetable</span> = gfx.imagetable.new(<span class="string"><span class="delimiter">&quot;</span><span class="content">path/to/imagetable</span><span class="delimiter">&quot;</span></span>)

<span class="comment">-- Creating the idle animation loop (400ms per frame)</span>
<span class="keyword">local</span> <span class="local-variable">idleAnimation</span> = gfx.animation.loop.new(<span class="integer">400</span>, animationImagetable, <span class="predefined-constant">true</span>)
<span class="comment">-- In this example, the idle animation is made of up frames 1 through 3 of the</span>
<span class="comment">-- imagetable, so the startFrame and endFrame properties are set accordingly</span>
idleAnimation.startFrame = <span class="integer">1</span>
idleAnimation.endFrame = <span class="integer">3</span>

<span class="comment">-- Creating the run animation loop (200ms per frame)</span>
<span class="keyword">local</span> <span class="local-variable">runAnimation</span> = gfx.animation.loop.new(<span class="integer">200</span>, animationImagetable, <span class="predefined-constant">true</span>)
<span class="comment">-- In this example, the run animation is made of up frames 4 through 8 of the</span>
<span class="comment">-- imagetable, so the startFrame and endFrame properties are set accordingly</span>
runAnimation.startFrame = <span class="integer">4</span>
runAnimation.endFrame = <span class="integer">8</span>

<span class="comment">-- Creating a simple state tracker</span>
<span class="keyword">local</span> <span class="local-variable">states</span> = <span class="map"><span class="delimiter">{</span><span class="key">idle</span> = <span class="integer">1</span>, <span class="key">run</span> = <span class="integer">2</span><span class="delimiter">}</span></span>
<span class="keyword">local</span> <span class="local-variable">state</span> = states.idle

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    <span class="comment">-- Draw different animations based on the state</span>
    <span class="keyword">if</span> state == states.idle <span class="keyword">then</span>
        idleAnimation:draw(<span class="integer">0</span>, <span class="integer">0</span>)
    <span class="keyword">elseif</span> state == states.run <span class="keyword">then</span>
        runAnimation:draw(<span class="integer">0</span>, <span class="integer">0</span>)
    <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Using an animation loop in a sprite</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">gfx</span> = playdate.graphics

<span class="comment">-- Each frame of the animation will last 200ms</span>
<span class="keyword">local</span> <span class="local-variable">frameTime</span> = <span class="integer">200</span>
<span class="keyword">local</span> <span class="local-variable">animationImagetable</span> = gfx.imagetable.new(<span class="string"><span class="delimiter">&quot;</span><span class="content">path/to/imagetable</span><span class="delimiter">&quot;</span></span>)
<span class="comment">-- Setting the last argument to false makes the animation stop on the last frame</span>
<span class="keyword">local</span> <span class="local-variable">animationLoop</span> = gfx.animation.loop.new(frameTime, animationImagetable, <span class="predefined-constant">false</span>)
<span class="comment">-- Set sprite image to first frame of the animation</span>
<span class="keyword">local</span> <span class="local-variable">animatedSprite</span> = gfx.sprite.new(animationLoop:image())
<span class="comment">-- Add sprite to display list</span>
animatedSprite:add()
<span class="comment">-- One easy way to update the sprite image to match the animation</span>
<span class="comment">-- is to simply override the sprite update method and do it there</span>
animatedSprite.update = <span class="keyword">function</span>()
    animatedSprite:setImage(animationLoop:image())
    <span class="comment">-- Optionally, removing the sprite when the animation finished</span>
    <span class="keyword">if</span> <span class="keyword">not</span> animationLoop:isValid() <span class="keyword">then</span>
        animatedSprite:remove()
    <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect4 class">
<h5 id="C-graphics.animator">Animator</h5>
<div class="paragraph">
<p>Animators are lightweight objects that keep track of animation progress. They can animate between two numbers, two points, along a line segment, arc, or polygon, or along a compound path made up of all three.</p>
</div>
<div class="paragraph">
<p>Usage is simple: create a new Animator, query for its current value when you need to update your animation, and optionally call <a href="#m-graphics.animator.ended"><code>animator:ended()</code></a> to see if the animation is complete.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Example code: <code>&lt;Playdate SDK&gt;/Examples/Single File Examples/animator.lua</code>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/animator</em> to use these functions.
</td>
</tr>
</table>
</div>
<div id="f-graphics.animator.new1" class="openblock item function">
<div class="title">playdate.graphics.animator.new(duration, startValue, endValue, [easingFunction, [startTimeOffset]])</div>
<div class="content">
<div class="paragraph">
<p>Animates between two number or <a href="#C-geometry.point">playdate.geometry.point</a> values.</p>
</div>
<div class="paragraph">
<p><em>duration</em> is the total time of the animation in milliseconds.</p>
</div>
<div class="paragraph">
<p><em>startValue</em> and <em>endValue</em> should be either numbers or <a href="#C-geometry.point">playdate.geometry.point</a></p>
</div>
<div class="paragraph">
<p><em>easingFunction</em>, if supplied, should be a value from <a href="#M-easingFunctions">playdate.easingFunctions</a>. If your easing function requires additional variables <em>s</em>, <em>a</em>, or <em>p</em>, set them on the animator directly after creation.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">a</span> = playdate.graphics.animator.new(<span class="integer">1000</span>, <span class="integer">0</span>, <span class="integer">100</span>, playdate.easingFunctions.inBack)
a.s = <span class="float">1.9</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>startTimeOffset</em>, if supplied, will shift the start time of the animation by the specified number of milliseconds. (If positive, the animation will be delayed. If negative, the animation will effectively have started before the moment the animator is instantiated.)</p>
</div>
<div class="listingblock">
<div class="title">Example: Using an animator to animate movement</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- You can copy and paste this example directly as your main.lua file to see it in action</span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/graphics</span><span class="delimiter">&quot;</span></span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/animator</span><span class="delimiter">&quot;</span></span>

<span class="comment">-- We'll be demonstrating how to use an animator to animate a square moving across the screen</span>
<span class="keyword">local</span> <span class="local-variable">square</span> = playdate.graphics.image.new(<span class="integer">20</span>, <span class="integer">20</span>, playdate.graphics.kColorBlack)

<span class="comment">-- 1000ms, or 1 second</span>
<span class="keyword">local</span> <span class="local-variable">animationDuration</span> = <span class="integer">1000</span>
<span class="comment">-- We're animating from the left to the right of the screen</span>
<span class="keyword">local</span> <span class="local-variable">startX</span>, <span class="local-variable">endX</span> = <span class="integer">-20</span>, <span class="integer">400</span>
<span class="comment">-- Setting an easing function to get a nice, smooth movement</span>
<span class="keyword">local</span> <span class="local-variable">easingFunction</span> = playdate.easingFunctions.inOutCubic
<span class="keyword">local</span> <span class="local-variable">animator</span> = playdate.graphics.animator.new(animationDuration, startX, endX, easingFunction)
animator.repeatCount = <span class="integer">-1</span> <span class="comment">-- Make animator repeat forever</span>

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    <span class="comment">-- Clear the screen</span>
    playdate.graphics.clear()

    <span class="comment">-- By using :currentValue() as the x value, the square follows along with the animation</span>
    square:draw(animator:currentValue(), <span class="integer">120</span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div id="f-graphics.animator.new2" class="openblock item function">
<div class="title">playdate.graphics.animator.new(duration, lineSegment, [easingFunction, [startTimeOffset]])</div>
<div class="content">
<div class="paragraph">
<p>Creates a new Animator that will animate along the provided <a href="#C-geometry.lineSegment">playdate.geometry.lineSegment</a></p>
</div>
<div class="listingblock">
<div class="title">Example: Using an animator to animate along a line</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- You can copy and paste this example directly as your main.lua file to see it in action</span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/graphics</span><span class="delimiter">&quot;</span></span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/animator</span><span class="delimiter">&quot;</span></span>

<span class="comment">-- We'll be demonstrating how to use an animator to animate a square moving across the screen</span>
<span class="keyword">local</span> <span class="local-variable">square</span> = playdate.graphics.image.new(<span class="integer">20</span>, <span class="integer">20</span>, playdate.graphics.kColorBlack)

<span class="comment">-- 1000ms, or 1 second</span>
<span class="keyword">local</span> <span class="local-variable">animationDuration</span> = <span class="integer">1000</span>
<span class="comment">-- We're animating from the top left to the bottom right of the screen</span>
<span class="keyword">local</span> <span class="local-variable">line</span> = playdate.geometry.lineSegment.new(<span class="integer">0</span>, <span class="integer">0</span>, <span class="integer">400</span>, <span class="integer">240</span>)
<span class="keyword">local</span> <span class="local-variable">animator</span> = playdate.graphics.animator.new(animationDuration, line)

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    <span class="comment">-- Clear the screen</span>
    playdate.graphics.clear()

    <span class="comment">-- We can use :currentValue() directly, as it returns a point</span>
    square:draw(animator:currentValue())
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div id="f-graphics.animator.new3" class="openblock item function">
<div class="title">playdate.graphics.animator.new(duration, arc, [easingFunction, [startTimeOffset]])</div>
<div class="content">
<div class="paragraph">
<p>Creates a new Animator that will animate along the provided <a href="#C-geometry.arc">playdate.geometry.arc</a></p>
</div>
</div>
</div>
<div id="f-graphics.animator.new4" class="openblock item function">
<div class="title">playdate.graphics.animator.new(duration, polygon, [easingFunction, [startTimeOffset]])</div>
<div class="content">
<div class="paragraph">
<p>Creates a new Animator that will animate along the provided <a href="#C-geometry.polygon">playdate.geometry.polygon</a></p>
</div>
</div>
</div>
<div id="f-graphics.animator.new5" class="openblock item function">
<div class="title">playdate.graphics.animator.new(durations, parts, easingFunctions, [startTimeOffset])</div>
<div class="content">
<div class="paragraph">
<p>Creates a new Animator that will animate along each of the items in the <em>parts</em> array in order, which should be comprised of <a href="#C-geometry.lineSegment">playdate.geometry.lineSegment</a>, <a href="#C-geometry.arc">playdate.geometry.arc</a>, or <a href="#C-geometry.polygon">playdate.geometry.polygon</a> objects.</p>
</div>
<div class="paragraph">
<p><em>durations</em> should be an array of durations, one for each item in <em>parts</em>.</p>
</div>
<div class="paragraph">
<p><em>easingFunctions</em> should be an array of <a href="#M-easingFunctions">playdate.easingFunctions</a>, one for each item in <em>parts</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
By default, animators do not repeat. If you would like them to, set the animator&#8217;s <em>repeatCount</em> property to the number of times the animation should repeat. It can be set to any positive number or -1 to indicate the animation should repeat forever. Note that a repeat count of 1 means the animation will play twice - once for the initial animation plus one repeat.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example: Using an animator with parts</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- You can copy and paste this example directly as your main.lua file to see it in action</span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/graphics</span><span class="delimiter">&quot;</span></span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/animator</span><span class="delimiter">&quot;</span></span>

<span class="comment">-- We'll be demonstrating how to animate something with parts</span>
<span class="keyword">local</span> <span class="local-variable">square</span> = playdate.graphics.image.new(<span class="integer">20</span>, <span class="integer">20</span>, playdate.graphics.kColorBlack)

<span class="comment">-- First part will take 3 seconds, second part will take 1, and third part will take 2</span>
<span class="keyword">local</span> <span class="local-variable">animationDurations</span> = <span class="map"><span class="delimiter">{</span><span class="integer">3000</span>, <span class="integer">1000</span>, <span class="integer">2000</span><span class="delimiter">}</span></span>
<span class="comment">-- We'll first animate along a line, then an arc, and then a polygon</span>
<span class="keyword">local</span> <span class="local-variable">animationParts</span> = <span class="map"><span class="delimiter">{</span>
    playdate.geometry.lineSegment.new(<span class="integer">0</span>, <span class="integer">0</span>, <span class="integer">200</span>, <span class="integer">80</span>),
    playdate.geometry.arc.new(<span class="integer">200</span>, <span class="integer">120</span>, <span class="integer">40</span>, <span class="integer">0</span>, <span class="integer">180</span>),
    playdate.geometry.polygon.new(<span class="integer">200</span>, <span class="integer">160</span>, <span class="integer">300</span>, <span class="integer">90</span>, <span class="integer">390</span>, <span class="integer">230</span>)
<span class="delimiter">}</span></span>
<span class="comment">-- We must set the easing functions for each part, and they can all be different</span>
<span class="keyword">local</span> <span class="local-variable">animationEasingFunctions</span> = <span class="map"><span class="delimiter">{</span>
    playdate.easingFunctions.outQuart,
    playdate.easingFunctions.inOutCubic,
    playdate.easingFunctions.outBounce
<span class="delimiter">}</span></span>

<span class="comment">-- To animate by parts, each argument must be arrays of equal length</span>
<span class="keyword">local</span> <span class="local-variable">animator</span> = playdate.graphics.animator.new(animationDurations, animationParts, animationEasingFunctions)

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    <span class="comment">-- Clear the screen</span>
    playdate.graphics.clear()

    <span class="comment">-- We can use :currentValue() directly, as it returns a point</span>
    square:draw(animator:currentValue())
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div id="m-graphics.animator.currentValue" class="openblock item method">
<div class="title">playdate.graphics.animator:currentValue()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current value of the animation, which will be either a number or a <a href="#C-geometry.point">playdate.geometry.point</a>, depending on the type of animator.</p>
</div>
</div>
</div>
<div id="m-graphics.animator.valueAtTime" class="openblock item method">
<div class="title">playdate.graphics.animator:valueAtTime(time)</div>
<div class="content">
<div class="paragraph">
<p>Returns the value of the animation at the given number of milliseconds after the start time. The value will be either a number or a <a href="#C-geometry.point">playdate.geometry.point</a>, depending on the type of animator.</p>
</div>
</div>
</div>
<div id="m-graphics.animator.progress" class="openblock item method">
<div class="title">playdate.graphics.animator:progress()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current progress of the animation as a value from 0 to 1.</p>
</div>
</div>
</div>
<div id="m-graphics.animator.reset" class="openblock item method">
<div class="title">playdate.graphics.animator:reset([duration])</div>
<div class="content">
<div class="paragraph">
<p>Resets the animation, setting its start time to the current time, and changes the animation&#8217;s duration if a new duration is given.</p>
</div>
</div>
</div>
<div id="m-graphics.animator.ended" class="openblock item method">
<div class="title">playdate.graphics.animator:ended()</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the animation is completed. Only returns true if this function or <a href="#m-graphics.animator.currentValue"><code>currentValue()</code></a> has been called since the animation ended in order to allow animations to fully finish before true is returned.</p>
</div>
</div>
</div>
<div id="v-graphics.animator.easingAmplitude" class="openblock item variable">
<div class="title">playdate.graphics.animator.easingAmplitude</div>
<div class="content">
<div class="paragraph">
<p>For <a href="#M-easingFunctions">easing functions</a> that take additional amplitude (such as <em>inOutElastic</em>), set these values on animator instances to the desired values.</p>
</div>
</div>
</div>
<div id="v-graphics.animator.easingPeriod" class="openblock item variable">
<div class="title">playdate.graphics.animator.easingPeriod</div>
<div class="content">
<div class="paragraph">
<p>For <a href="#M-easingFunctions">easing functions</a> that take additional period arguments (such as <em>inOutElastic</em>), set these values on animator instances to the desired values.</p>
</div>
</div>
</div>
<div id="v-graphics.animator.repeatCount" class="openblock item variable">
<div class="title">playdate.graphics.animator.repeatCount</div>
<div class="content">
<div class="paragraph">
<p>Indicates the number of times after the initial animation the animator should repeat; i.e., if repeatCount is set to 2, the animation will play through 3 times.</p>
</div>
</div>
</div>
<div id="v-graphics.animator.reverses" class="openblock item variable">
<div class="title">playdate.graphics.animator.reverses</div>
<div class="content">
<div class="paragraph">
<p>If set to true, after the animation reaches the end, it runs in reverse from the end to the start. The time to complete both the forward and reverse will be <em>duration</em> x 2. Defaults to false.</p>
</div>
</div>
</div>
</div>
<div class="sect4 class">
<h5 id="C-graphics.animation.blinker">Blinker</h5>
<div class="paragraph">
<p>playdate.graphics.animation.blinker keeps track of a boolean that changes on a timer.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/animation</em> to use <code>blinker</code>.
</td>
</tr>
</table>
</div>
<div id="f-graphics.animation.blinker.new" class="openblock item function">
<div class="title">playdate.graphics.animation.blinker.new([onDuration, [offDuration, [loop, [cycles, [default]]]]])</div>
<div class="content">
<div class="paragraph">
<p>Creates a new blinker object. Check the object&#8217;s <code>on</code> property to determine whether the blinker is on (<code>true</code>) or off (<code>false</code>). The default properties are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>onDuration</em>: 200 (the number of milliseconds the blinker is "on")</p>
</li>
<li>
<p><em>offDuration</em>: 200 (the number of milliseconds the blinker is "off")</p>
</li>
<li>
<p><em>loop</em>: false (should the blinker restart after completing)</p>
</li>
<li>
<p><em>cycles</em>: 6 (the number of changes the blinker goes through before it&#8217;s complete)</p>
</li>
<li>
<p><em>default</em>: true (the state the blinker will start in. <strong>Note:</strong> if default is <code>true</code>, <code>blinker.on</code> will return <code>true</code> when the blinker is in its <em>onDuration</em> phase. If default is <code>false</code>, <code>blinker.on</code> will return <code>false</code> when the blinker is in its <em>onDuration</em> phase.)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Other informative properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>counter</em>: Read this property to see which cycle the blinker is on (counts from <em>n</em> down to zero)</p>
</li>
<li>
<p><em>on</em>: Read this property to determine the current state of the blinker. The blinker always starts in the state specified by the <code>default</code> property.</p>
</li>
<li>
<p><em>running</em>: Read this property to see if the blinker is actively running</p>
</li>
</ul>
</div>
</div>
</div>
<div id="f-graphics.animation.blinker.updateAll" class="openblock item function">
<div class="title">playdate.graphics.animation.blinker.updateAll()</div>
<div class="content">
<div class="paragraph">
<p>Updates the state of all valid blinkers by calling <a href="#m-graphics.animation.blinker.update">:update()</a> on each.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
If you intend to use blinkers, be sure to call <code>:updateAll()</code> once a cycle, ideally in your game&#8217;s <a href="#c-update"><code>playdate.update()</code></a> function.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.animation.blinker.update" class="openblock item method">
<div class="title">playdate.graphics.animation.blinker:update()</div>
<div class="content">
<div class="paragraph">
<p>Updates the caller&#8217;s state.</p>
</div>
</div>
</div>
<div id="m-graphics.animation.blinker.start" class="openblock item method">
<div class="title">playdate.graphics.animation.blinker:start([onDuration, [offDuration, [loop, [cycles, [default]]]]])</div>
<div class="content">
<div class="paragraph">
<p>Starts a blinker if it&#8217;s not running. Pass values for any property values you wish to modify.</p>
</div>
</div>
</div>
<div id="m-graphics.animation.blinker.startLoop" class="openblock item method">
<div class="title">playdate.graphics.animation.blinker:startLoop()</div>
<div class="content">
<div class="paragraph">
<p>Starts a blinker if it&#8217;s not running and sets its <code>loop</code> property to true. Equivalent to calling <code>playdate.graphics.animation.blinker:start(nil, nil, true)</code></p>
</div>
</div>
</div>
<div id="m-graphics.animation.blinker.stop" class="openblock item method">
<div class="title">playdate.graphics.animation.blinker:stop()</div>
<div class="content">
<div class="paragraph">
<p>Stops a blinker if it&#8217;s running, returning the blinker&#8217;s <code>on</code> properly to the default value.</p>
</div>
</div>
</div>
<div id="f-graphics.animation.blinker.stopAll" class="openblock item function">
<div class="title">playdate.graphics.animation.blinker.stopAll()</div>
<div class="content">
<div class="paragraph">
<p>Stops all blinkers.</p>
</div>
</div>
</div>
<div id="m-graphics.animation.blinker.remove" class="openblock item method">
<div class="title">playdate.graphics.animation.blinker:remove()</div>
<div class="content">
<div class="paragraph">
<p>Flags the caller for removal from the global list of blinkers</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_scrolling">Scrolling</h4>
<div id="f-graphics.setDrawOffset" class="openblock item function xref">
<div class="title">playdate.graphics.setDrawOffset(x, y)</div>
<div class="content">
<div class="paragraph">
<p><code>setDrawOffset(x, y)</code> offsets the origin point for all drawing calls to <em>x</em>, <em>y</em> (can be negative). So, for example, if the offset is set to -20, -20, an image drawn at 20, 20 will appear at the origin (in the upper left corner.)</p>
</div>
<div class="paragraph">
<p>This is useful, for example, for centering a "camera" on a sprite that is moving around a world larger than the screen.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <em>x</em> and <em>y</em> arguments to <code>.setDrawOffset()</code> are always specified in the original, unaltered coordinate system. So, for instance, repeated calls to <code>playdate.graphics.setDrawOffset(-10, -10)</code> will leave the draw offset unchanged. Likewise, <code>.setDrawOffset(0, 0)</code> will always "disable" the offset.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
It can be useful to have operations sometimes ignore the draw offsets. For example, you may want to have the score or some other heads-up display appear onscreen apart from scrolling content. A sprite can be set to ignore offsets by calling <a href="#m-graphics.sprite.setIgnoresDrawOffset">playdate.graphics.sprite:setIgnoresDrawOffset(true)</a>. <a href="#m-graphics.image.drawIgnoringOffset">playdate.graphics.image:drawIgnoringOffsets()</a> lets you render an image using screen coordinates.
</td>
</tr>
</table>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.setDrawOffset"><code>playdate-&gt;graphics-&gt;setDrawOffset()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-graphics.getDrawOffset" class="openblock item function">
<div class="title">playdate.graphics.getDrawOffset()</div>
<div class="content">
<div class="paragraph">
<p><code>getDrawOffset()</code> returns multiple values (<em>x</em>, <em>y</em>) giving the current draw offset.</p>
</div>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
These functions are different from <a href="#f-display.setOffset">playdate.display.setOffset()</a> and <a href="#f-display.getOffset">playdate.display.getOffset()</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_frame_buffer">Frame buffer</h4>
<div id="f-graphics.getDisplayImage" class="openblock item function">
<div class="title">playdate.graphics.getDisplayImage()</div>
<div class="content">
<div class="paragraph">
<p>Returns a copy the contents of the <em>last completed frame</em>, i.e., a "screenshot", as a <a href="#C-graphics.image">playdate.graphics.image</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Display functions like <a href="#f-display.setMosaic">setMosaic()</a>, <a href="#f-display.setInverted">setInverted()</a>, <a href="#f-display.setScale">setScale()</a>, and <a href="#f-display.setOffset">setOffset()</a> do not affect the returned image.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-graphics.getWorkingImage" class="openblock item function">
<div class="title">playdate.graphics.getWorkingImage()</div>
<div class="content">
<div class="paragraph">
<p>Returns a copy the contents of the working frame buffer — <em>the current frame, in-progress</em> — as a <a href="#C-graphics.image">playdate.graphics.image</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Display functions like <a href="#f-display.setMosaic">setMosaic()</a>, <a href="#f-display.setInverted">setInverted()</a>, <a href="#f-display.setScale">setScale()</a>, and <a href="#f-display.setOffset">setOffset()</a> do not affect the returned image.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-graphics.imagetable">Image table</h4>
<div class="paragraph">
<p>There are two kinds of image tables: <strong>matrix</strong> and <strong>sequential</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Matrix image tables</strong> are great as sources of imagery for <a href="#C-graphics.tilemap">tilemap</a>. They are loaded from a single file in your game&#8217;s source folder with the suffix <code>-table-&lt;w&gt;-&lt;h&gt;</code> before the file extension. The compiler splits the image into separate bitmaps of dimension <em>w</em> by <em>h</em> pixels that are accessible via <a href="#m-graphics.imagetable.getImage-xy">imagetable:getImage(x,y)</a>.</p>
</div>
<div class="paragraph">
<p><strong>Sequential image tables</strong> are useful as a way to load up sequential frames of animation. They are loaded from a sequence of files in your game&#8217;s source folder <em>at compile time</em> from filenames with the suffix <code>-table-&lt;sequenceNumber&gt;</code> before the file extension. Individual images in the sequence are accessible via <a href="#m-graphics.imagetable.getImage-n">imagetable:getImage(n)</a>. The images employed by a sequential image table are not required to be the same size, unlike the images used in a matrix image table.</p>
</div>
<div id="f-graphics.imagetable.new" class="openblock item function">
<div class="title">playdate.graphics.imagetable.new(path)</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-graphics.imagetable">playdate.graphics.imagetable</a> object from the data at <em>path</em>. If there is no file at <em>path</em>, the function returns nil and a second value describing the error. If the file at <em>path</em> is an animated GIF, successive frames of the GIF will be loaded as consecutive bitmaps in the imagetable. Any timing data in the animated GIF will be ignored.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
To load a <strong>matrix</strong> image table defined in <code>frames-table-16-16.png</code>, you call <code>playdate.graphics.imagetable.new("frames")</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
To load a <strong>sequential</strong> image table defined with the files <code>frames-table-1.png</code>, <code>frames-table-2.png</code>, etc., you call <code>playdate.graphics.imagetable.new("frames")</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-graphics.imagetable.new-alloc" class="openblock item function">
<div class="title">playdate.graphics.imagetable.new(count, [cellsWide], [cellSize])</div>
<div class="content">
<div class="paragraph">
<p>Returns an empty image table for loading images into via <a href="#m-graphics.imagetable.load">imagetable:load()</a> or setting already-loaded images into with <a href="#m-graphics.imagetable.setImage">imagetable:setImage()</a>. If set, <em>cellsWide</em> is used to locate images by x,y position. The optional <em>cellSize</em> argument gives the allocation size for the images, if <a href="#m-graphics.imagetable.load">load()</a> will be used. (This is a weird technical detail, so ask us if you need guidance here.)</p>
</div>
</div>
</div>
<div id="m-graphics.imagetable.getImage-n" class="openblock item method">
<div class="title">playdate.graphics.imagetable:getImage(n)</div>
<div class="content">
<div class="paragraph">
<p>Returns the <em>n</em>-th <a href="#C-graphics.image">playdate.graphics.image</a> in the table (ordering left-to-right, top-to-bottom). The first image is at index 1. If .n_ or (<em>x</em>,<em>y</em>) is out of bounds, the function returns nil. See also <a href="#m-graphics.imagetable.__len">imagetable[n]</a>.</p>
</div>
</div>
</div>
<div id="m-graphics.imagetable.getImage-xy" class="openblock item method">
<div class="title">playdate.graphics.imagetable:getImage(x,y)</div>
<div class="content">
<div class="paragraph">
<p>Returns the image in cell (<em>x</em>,<em>y</em>) in the original bitmap. The first image is at index 1. If <em>n</em> or (<em>x</em>,<em>y</em>) is out of bounds, the function returns nil. See also <a href="#m-graphics.imagetable.__len">imagetable[n]</a>.</p>
</div>
</div>
</div>
<div id="m-graphics.imagetable.setImage" class="openblock item method">
<div class="title">playdate.graphics.imagetable:setImage(n, image)</div>
<div class="content">
<div class="paragraph">
<p>Sets the image at slot <em>n</em> in the image table by creating a reference to the data in <em>image</em>.</p>
</div>
</div>
</div>
<div id="m-graphics.imagetable.load" class="openblock item method">
<div class="title">playdate.graphics.imagetable:load(path)</div>
<div class="content">
<div class="paragraph">
<p>Loads a new image table from the data at <em>path</em> into an already-existing image table, without allocating additional memory. The image table at <em>path</em> must contain images of the same dimensions as the previous.</p>
</div>
<div class="paragraph">
<p>Returns <code>(success, [error])</code>. If the boolean <code>success</code> is false, <code>error</code> is also returned.</p>
</div>
</div>
</div>
<div id="m-graphics.imagetable.getLength" class="openblock item method">
<div class="title">playdate.graphics.imagetable:getLength()</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of images in the table. See also <a href="#m-graphics.imagetable.__len">#imagetable</a>.</p>
</div>
</div>
</div>
<div id="m-graphics.imagetable.getSize" class="openblock item method">
<div class="title">playdate.graphics.imagetable:getSize()</div>
<div class="content">
<div class="paragraph">
<p>Returns the pair (<em>cellsWide</em>, <em>cellsHigh</em>).</p>
</div>
</div>
</div>
<div id="m-graphics.imagetable.drawImage" class="openblock item method">
<div class="title">playdate.graphics.imagetable:drawImage(n,x,y,[flip])</div>
<div class="content">
<div class="paragraph">
<p>Equivalent to <code>graphics.imagetable:getImage(n):draw(x,y,[flip])</code>.</p>
</div>
</div>
</div>
<div id="m-graphics.imagetable.__index" class="openblock item method">
<div class="title">playdate.graphics.imagetable[n]</div>
<div class="content">
<div class="paragraph">
<p>Equivalent to <a href="#m-graphics.imagetable.getImage-n">imagetable:getImage(n)</a>.</p>
</div>
</div>
</div>
<div id="m-graphics.imagetable.__len" class="openblock item method">
<div class="title">#playdate.graphics.imagetable</div>
<div class="content">
<div class="paragraph">
<p>Equivalent to <a href="#m-graphics.imagetable.getLength">imagetable:getLength()</a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
In Lua, you can get the length of a string or table using the <a href="http://www.lua.org/manual/5.1/manual.html#2.5.5">length operator</a>. For a <code>playdate.graphics.imagetable</code> called <code>myImageTable</code>, both <code>#myImageTable</code> and <code>myImageTable:getLength()</code> would return the same result.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-graphics.tilemap">Tilemap</h4>
<div class="paragraph">
<p>Tilemaps are often used to represent the game environment. Tiles are a very efficient way to create levels and scenery. (Alternatively, <a href="#C-graphics.sprite">sprites</a> are the best way to create objects that move about your playfield, like the character that represents the player, enemies, etc.)</p>
</div>
<div class="paragraph">
<p>At its most fundamental, a tilemap is a table of indexes into an <a href="#C-graphics.imagetable">playdate.graphics.imagetable</a>. The images in the imagetable represent small chunks of your scenery; the tilemap is what organizes them into a specific arrangement.</p>
</div>
<div class="sect4">
<h5 id="_how_to">How-To</h5>
<div class="paragraph">
<p>A typical usage of tilemaps might be to assist in drawing a game level:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Instantiate a blank <a href="#f-graphics.tilemap.new">tilemap</a>.</p>
</li>
<li>
<p>Attach an <a href="#m-graphics.tilemap.setImageTable">imagetable</a> — a matrix of tile images that your game level will utilize.</p>
</li>
<li>
<p>Set your tilemap&#8217;s matrix of indices — these represent your game level — into the imagetable using <a href="#m-graphics.tilemap.setTiles">:setTiles()</a>. (A tilemap editor such as <a href="https://www.mapeditor.org">Tiled</a> can be very useful for this.) This is also where you specify your tilemap&#8217;s width.</p>
</li>
<li>
<p>Draw your tilemap using <a href="#m-graphics.tilemap.draw">:draw()</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_configuring">Configuring</h5>
<div id="f-graphics.tilemap.new" class="openblock item function">
<div class="title">playdate.graphics.tilemap.new()</div>
<div class="content">
<div class="paragraph">
<p>Creates a new tilemap object.</p>
</div>
</div>
</div>
<div id="m-graphics.tilemap.setImageTable" class="openblock item method">
<div class="title">playdate.graphics.tilemap:setImageTable(table)</div>
<div class="content">
<div class="paragraph">
<p>Sets the tilemap&#8217;s <a href="#C-graphics.imagetable">playdate.graphics.imagetable</a> to <em>table</em>, a <a href="#C-graphics.imagetable">playdate.graphics.imagetable</a>.</p>
</div>
</div>
</div>
<div id="m-graphics.tilemap.setSize" class="openblock item method">
<div class="title">playdate.graphics.tilemap:setSize(width, height)</div>
<div class="content">
<div class="paragraph">
<p>Sets the tilemap&#8217;s width and height, in number of tiles.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The tilemap&#8217;s width can also be configured in a call to <a href="#m-graphics.tilemap.setTiles">:setTiles()</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.tilemap.getSize" class="openblock item method">
<div class="title">playdate.graphics.tilemap:getSize()</div>
<div class="content">
<div class="paragraph">
<p>Returns the size of the tilemap, in tiles, as a pair, (<em>width</em>, <em>height</em>).</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_setting_tile_values">Setting tile values</h5>
<div id="m-graphics.tilemap.setTiles" class="openblock item method">
<div class="title">playdate.graphics.tilemap:setTiles(data, width)</div>
<div class="content">
<div class="paragraph">
<p>Sets the tilemap&#8217;s width to <em>width</em>, then populates the tilemap with <em>data</em>, which should be a flat, one-dimensional array-like table containing index values to the <a href="#m-graphics.tilemap.setImageTable">tilemap&#8217;s imagetable</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
This function is especially useful for configuring a large number of tiles at once — say when first loading a game level.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.tilemap.getTiles" class="openblock item method">
<div class="title">playdate.graphics.tilemap:getTiles()</div>
<div class="content">
<div class="paragraph">
<p>Returns <em>data</em>, <em>width</em><br>
<em>data</em> is a flat, one-dimensional array-like table containing index values to the <a href="#m-graphics.tilemap.setImageTable">tilemap&#8217;s imagetable</a>.<br>
 <em>width</em> is the width of the tilemap, in number of tiles.</p>
</div>
</div>
</div>
<div id="m-graphics.tilemap.setTileAtPosition" class="openblock item method">
<div class="title">playdate.graphics.tilemap:setTileAtPosition(x, y, index)</div>
<div class="content">
<div class="paragraph">
<p>Sets the index of the tile at tilemap position (<em>x</em>, <em>y</em>). <em>index</em> is the (1-based) index of the image in the tilemap&#8217;s <a href="#C-graphics.imagetable">playdate.graphics.imagetable</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
This function is especially useful for making small adjustments to existing tilemaps — say, if the state of a tile changes during gameplay.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Tilemaps and imagetables, like Lua arrays, are 1-based, not 0-based. <code>tilemap:setTileAtPosition(1, 1, 2)</code> will set the index of the tile in the top-leftmost position to 2.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.tilemap.getTileAtPosition" class="openblock item method">
<div class="title">playdate.graphics.tilemap:getTileAtPosition(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Returns the image index of the tile at the given <em>x</em> and <em>y</em> coordinate. If <em>x</em> or <em>y</em> is out of bounds, returns nil.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Tilemaps and imagetables, like Lua arrays, are 1-based, not 0-based. <code>tilemap:getTileAtPosition(1, 1)</code> will return the index of the top-leftmost tile.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_drawing_2">Drawing</h5>
<div id="m-graphics.tilemap.draw" class="openblock item method">
<div class="title">playdate.graphics.tilemap:draw(x, y, [sourceRect])</div>
<div class="content">
<div class="paragraph">
<p>Draws the tilemap at screen coordinate (<em>x</em>, <em>y</em>).</p>
</div>
<div class="paragraph">
<p><em>sourceRect</em>, if specified, will cause only the part of the tilemap within sourceRect to be drawn. <em>sourceRect</em> should be relative to the tilemap&#8217;s bounds and can be a <a href="#C-geometry.rect">playdate.geometry.rect</a> or four integers, (<em>x</em>, <em>y</em>, <em>w</em>, <em>h</em>), representing the rect.</p>
</div>
</div>
</div>
<div id="m-graphics.tilemap.drawIgnoringOffset" class="openblock item method">
<div class="title">playdate.graphics.tilemap:drawIgnoringOffset(x, y, [sourceRect])</div>
<div class="content">
<div class="paragraph">
<p>Draws the tilemap ignoring the currently set <a href="#f-graphics.setDrawOffset"><code>drawOffset</code></a>.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_collisions">Collisions</h5>
<div id="m-graphics.tilemap.getCollisionRects" class="openblock item method">
<div class="title">playdate.graphics.tilemap:getCollisionRects(emptyIDs)</div>
<div class="content">
<div class="paragraph">
<p>This function returns an array of <a href="#C-geometry.rect">playdate.geometry.rect</a> objects that describe the areas of the tilemap that should trigger collisions.  You can also think of them as the "impassable" rects of your tilemap.  These rects will be in tilemap coordinates, not pixel coordinates.</p>
</div>
<div class="paragraph">
<p><em>emptyIDs</em> is an array that contains the tile IDs of "empty" (or "passable") tiles in the tilemap&#8201;&#8212;&#8201;in other words, tile IDs that should not trigger a collision. Tiles with default IDs of 0 are treated as empty by default, so you do not need to include 0 in the array.</p>
</div>
<div class="paragraph">
<p>For example, if you have a tilemap describing terrain, where tile ID 1 represents grass the player can walk over, and tile ID 2 represents mountains that the player can&#8217;t cross, you&#8217;d pass an array containing just the value 1.  You&#8217;ll get a back an array of a minimal number of rects describing the areas where there are mountain tiles.</p>
</div>
<div class="paragraph">
<p>You can then pass each of those rects into <a href="#f-graphics.sprite.addEmptyCollisionSprite">playdate.graphics.sprite.addEmptyCollisionSprite()</a> to add an empty (invisible) sprite into the scene for the built-in collision detection methods.  In this example, collide rects would be added around mountain tiles but not grass tiles.</p>
</div>
<div class="paragraph">
<p>Alternatively, instead of calling getCollisionRects() at all, you can use the convenience function <a href="#f-graphics.sprite.addWallSprites">playdate.graphics.sprite.addWallSprites()</a>, which is effectively a shortcut for calling getCollisionRects() and passing all the resulting rects to <a href="#f-graphics.sprite.addEmptyCollisionSprite">addEmptyCollisionSprite()</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_other_tilemap_functions">Other tilemap functions</h5>
<div id="m-graphics.tilemap.getPixelSize" class="openblock item method">
<div class="title">playdate.graphics.tilemap:getPixelSize()</div>
<div class="content">
<div class="paragraph">
<p>Returns the size of the tilemap in pixels; that is, the size of the image multiplied by the number of rows and columns in the map. Returns multiple values (<em>width</em>, <em>height</em>).</p>
</div>
<div class="paragraph">
<p>The tilemap size in pixels is determined by the tile size of the <a href="#m-graphics.tilemap.setImageTable">imagetable</a> it is referencing, and the width of the tilemap set via <a href="#m-graphics.tilemap.setTiles">:setTiles()</a> or <a href="#m-graphics.tilemap.setSize">:setSize()</a>. It is not otherwise configurable.</p>
</div>
</div>
</div>
<div id="m-graphics.tilemap.getTileSize" class="openblock item method">
<div class="title">playdate.graphics.tilemap:getTileSize()</div>
<div class="content">
<div class="paragraph">
<p>Returns two values (<em>width</em>, <em>height</em>), the pixel width and height of an individual tile.</p>
</div>
<div class="paragraph">
<p>These values are determined by the tile size of the associated <a href="#m-graphics.tilemap.setImageTable">imagetable</a> and are not otherwise configurable.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-graphics.sprite">Sprite</h4>
<div class="paragraph">
<p>Sprites are graphic objects that can be used to represent moving entities in your games, like the player, or the enemies that chase after your player. Sprites animate efficiently, and offer collision detection and a host of other built-in functionality. (If you want to create an environment for your sprites to move around in, consider using <a href="#C-graphics.tilemap">tilemaps</a> or <a href="#f-graphics.sprite.setBackgroundDrawingCallback">drawing a background image</a>.)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
To have access to all the sprite functionality described below, be sure to <code>import "CoreLibs/sprites"</code> at the top of your source file.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The simplest way to create a sprite is using <code>sprite.new(<em>image</em>)</code>:</p>
</div>
<div class="listingblock">
<div class="title">Creating a standalone sprite</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/sprites</span><span class="delimiter">&quot;</span></span>

<span class="keyword">local</span> <span class="local-variable">image</span> = playdate.graphics.image.new(<span class="string"><span class="delimiter">&quot;</span><span class="content">coin</span><span class="delimiter">&quot;</span></span>)
<span class="keyword">local</span> <span class="local-variable">sprite</span> = playdate.graphics.sprite.new(image)
sprite:moveTo(<span class="integer">100</span>, <span class="integer">100</span>)
sprite:add()</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to use an object-oriented approach, you can also subclass sprites and create instance of those subclasses.</p>
</div>
<div class="listingblock">
<div class="title">Creating a sprite subclass</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/sprites</span><span class="delimiter">&quot;</span></span>

class(<span class="string"><span class="delimiter">'</span><span class="content">MySprite</span><span class="delimiter">'</span></span>).extends(playdate.graphics.sprite)

<span class="keyword">local</span> <span class="local-variable">sprite</span> = MySprite()
<span class="keyword">local</span> <span class="local-variable">image</span> = playdate.graphics.image.new(<span class="string"><span class="delimiter">&quot;</span><span class="content">coin</span><span class="delimiter">&quot;</span></span>)
sprite:setImage(image)
sprite:moveTo(<span class="integer">100</span>, <span class="integer">100</span>)
sprite:add()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or with a custom initializer:</p>
</div>
<div class="listingblock">
<div class="title">Creating a sprite subclass with a custom initializer</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/sprites</span><span class="delimiter">&quot;</span></span>

class(<span class="string"><span class="delimiter">'</span><span class="content">MySprite</span><span class="delimiter">'</span></span>).extends(playdate.graphics.sprite)

<span class="keyword">local</span> <span class="local-variable">image</span> = playdate.graphics.image.new(<span class="string"><span class="delimiter">&quot;</span><span class="content">coin</span><span class="delimiter">&quot;</span></span>)

<span class="keyword">function</span> MySprite:<span class="function">init</span>(x, y)
    MySprite.super.init(self) <span class="comment">-- this is critical</span>
    self:setImage(image)
    self:moveTo(x, y)
<span class="keyword">end</span>

<span class="keyword">local</span> <span class="local-variable">sprite</span> = MySprite(<span class="integer">100</span>, <span class="integer">100</span>)
sprite:add()</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_sprite_basics">Sprite Basics</h5>
<div id="f-graphics.sprite.new" class="openblock item function">
<div class="title">playdate.graphics.sprite.new([image_or_tilemap])</div>
<div class="content">
<div class="paragraph">
<p>This class method (note the "." syntax rather than ":") returns a new sprite object. A previously-loaded <a href="#C-graphics.image">image</a> or <a href="#C-graphics.tilemap">tilemap</a> object can be optionally passed-in.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
To see your sprite onscreen, you will need to call <a href="#m-graphics.sprite.add"><code>:add()</code></a> on your sprite to add it to the display list.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-graphics.sprite.spriteWithText" class="openblock item function">
<div class="title">playdate.graphics.sprite.spriteWithText(text, maxWidth, maxHeight, [backgroundColor, [leadingAdjustment, [truncationString, [alignment, [font]]]]])</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/sprites</em> to use this function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A conveneince function that creates a sprite with an image of <code><em>text</em></code>, as generated by <a href="#f-graphics.imageWithText">imageWithText()</a>.</p>
</div>
<div class="paragraph">
<p>The arguments are the same as those in <a href="#f-graphics.imageWithText">imageWithText()</a>.</p>
</div>
<div class="paragraph">
<p>Returns <code><em>sprite</em></code>, <code><em>textWasTruncated</em></code></p>
</div>
<div class="paragraph">
<p><code><em>sprite</em></code> is a newly-created <a href="#C-graphics.sprite">sprite</a> with its image set to an image of the text specified. The sprite&#8217;s dimensions may be smaller than <code><em>maxWidth</em></code>, <code><em>maxHeight</em></code>.</p>
</div>
<div class="paragraph">
<p><code><em>textWasTruncated</em></code> indicates if the text was truncated to fit within the specified width and height.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.update" class="openblock item function">
<div class="title">playdate.graphics.sprite.update()</div>
<div class="content">
<div class="paragraph">
<p>This class method (note the "." syntax rather than ":") calls the <a href="#c-graphics.sprite.update">update()</a> function on every sprite in the global sprite list and redraws all of the dirty rects.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You will generally want to call <code>playdate.graphics.sprite.update()</code> once in your <a href="#c-update"><code>playdate.update()</code></a> method, to ensure that your sprites are updated and drawn during every frame. Failure to do so may mean your sprites will not appear onscreen.
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Be careful not confuse <code>sprite.update()</code> with <a href="#c-graphics.sprite.update"><code>sprite:update()</code></a>: the former updates all sprites; the latter updates just the sprite being invoked.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.sprite.setImage" class="openblock item method">
<div class="title">playdate.graphics.sprite:setImage(image, [flip, [scale, [yscale]]])</div>
<div class="content">
<div class="paragraph">
<p>Sets the sprite&#8217;s image to <code>image</code>, which should be an instance of <a href="#C-graphics.image">playdate.graphics.image</a>. The .flip_ argument is optional; see <a href="#m-graphics.imgDraw">playdate.graphics.image:draw()</a> for valid values. Optional scale arguments are also accepted. Unless disabled with <a href="#m-graphics.sprite.setRedrawsOnImageChange">playdate.graphics.sprite:setRedrawOnImageChange()</a>, the sprite is automatically marked for redraw if the image isn&#8217;t the previous image.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getImage" class="openblock item method">
<div class="title">playdate.graphics.sprite:getImage()</div>
<div class="content">
<div class="paragraph">
<p>Returns the playdate.graphics.image object that was set with setImage().</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.add" class="openblock item method">
<div class="title">playdate.graphics.sprite:add()</div>
<div class="content">
<div class="paragraph">
<p>Adds the given sprite to the display list, so that it is drawn in the current scene.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.addSprite" class="openblock item function">
<div class="title">playdate.graphics.sprite.addSprite(sprite)</div>
<div class="content">
<div class="paragraph">
<p>Adds the given sprite to the display list, so that it is drawn in the current scene. Note that this is called with a period <code>.</code> instead of a colon <code>:</code>.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.remove" class="openblock item method">
<div class="title">playdate.graphics.sprite:remove()</div>
<div class="content">
<div class="paragraph">
<p>Removes the given sprite from the display list.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.removeSprite" class="openblock item function">
<div class="title">playdate.graphics.sprite.removeSprite(sprite)</div>
<div class="content">
<div class="paragraph">
<p>Removes the given sprite from the display list. As with <code>add()</code>/<code>addSprite()</code>, note that this is called with a period <code>.</code> instead of a colon <code>:</code>.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.moveTo" class="openblock item method">
<div class="title">playdate.graphics.sprite:moveTo(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Moves the sprite and resets the bounds based on the image dimensions and center.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getPosition" class="openblock item method">
<div class="title">playdate.graphics.sprite:getPosition()</div>
<div class="content">
<div class="paragraph">
<p>Returns the sprite&#8217;s current x, y position as multiple values (<em>x</em>, <em>y</em>).</p>
</div>
</div>
</div>
<div id="a-graphics.sprite.x" class="openblock item property">
<div class="title">playdate.graphics.sprite.x</div>
<div class="content">
<div class="paragraph">
<p>Can be used to directly read your sprite&#8217;s x position.</p>
</div>
</div>
</div>
<div id="a-graphics.sprite.y" class="openblock item property">
<div class="title">playdate.graphics.sprite.y</div>
<div class="content">
<div class="paragraph">
<p>Can be used to directly read your sprite&#8217;s y position.</p>
</div>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Do not set these properties directly. Use <a href="#m-graphics.sprite.moveTo"><code>:moveTo()</code></a> instead.
</td>
</tr>
</table>
</div>
<div id="m-graphics.sprite.moveBy" class="openblock item method">
<div class="title">playdate.graphics.sprite:moveBy(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Moves the sprite by <em>x</em>, <em>y</em> pixels relative to its current position.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setZIndex" class="openblock item method">
<div class="title">playdate.graphics.sprite:setZIndex(z)</div>
<div class="content">
<div class="paragraph">
<p>Sets the Z-index of the given sprite. Sprites with higher Z-indexes are drawn on top of those with lower Z-indexes. Valid values for <em>z</em> are in the range (-32768, 32767).</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getZIndex" class="openblock item method">
<div class="title">playdate.graphics.sprite:getZIndex()</div>
<div class="content">
<div class="paragraph">
<p>Returns the Z-index of the given sprite.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setVisible" class="openblock item method">
<div class="title">playdate.graphics.sprite:setVisible(flag)</div>
<div class="content">
<div class="paragraph">
<p>Sprites that aren&#8217;t visible don&#8217;t get their <a href="#c-graphics.sprite.draw">draw()</a> method called.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.isVisible" class="openblock item method">
<div class="title">playdate.graphics.sprite:isVisible()</div>
<div class="content">
<div class="paragraph">
<p>Returns a boolean value, true if the sprite is visible.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setCenter" class="openblock item method">
<div class="title">playdate.graphics.sprite:setCenter(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Sets the sprite&#8217;s drawing center as a fraction (ranging from 0.0 to 1.0) of the height and width. Default is 0.5, 0.5 (the center of the sprite). This means that when you call <a href="#m-graphics.sprite.moveTo">:moveTo(x, y)</a>, the center of your sprite will be positioned at <em>x</em>, <em>y</em>. If you want x and y to represent the upper left corner of your sprite, specify the center as 0, 0.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getCenter" class="openblock item method">
<div class="title">playdate.graphics.sprite:getCenter()</div>
<div class="content">
<div class="paragraph">
<p>Returns multiple values (<code>x, y</code>) representing the sprite&#8217;s drawing center as a fraction (ranging from 0.0 to 1.0) of the height and width.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getCenterPoint" class="openblock item method">
<div class="title">playdate.graphics.sprite:getCenterPoint()</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-geometry.point">playdate.geometry.point</a> representing the sprite&#8217;s drawing center as a fraction (ranging from 0.0 to 1.0) of the height and width.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setSize" class="openblock item method">
<div class="title">playdate.graphics.sprite:setSize(width, height)</div>
<div class="content">
<div class="paragraph">
<p>Sets the sprite&#8217;s size. The method has no effect if the sprite has an image set.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getSize" class="openblock item method">
<div class="title">playdate.graphics.sprite:getSize()</div>
<div class="content">
<div class="paragraph">
<p>Returns multiple values <em>(width, height)</em>, the current size of the sprite.</p>
</div>
</div>
</div>
<div id="a-graphics.sprite.width" class="openblock item property">
<div class="title">playdate.graphics.sprite.width</div>
<div class="content">
<div class="paragraph">
<p>Can be used to directly read your sprite&#8217;s width.</p>
</div>
</div>
</div>
<div id="a-graphics.sprite.height" class="openblock item property">
<div class="title">playdate.graphics.sprite.height</div>
<div class="content">
<div class="paragraph">
<p>Can be used to directly read your sprite&#8217;s height.</p>
</div>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Do not set these properties directly. Use <a href="#m-graphics.sprite.setSize"><code>:setSize()</code></a> instead.
</td>
</tr>
</table>
</div>
<div id="m-graphics.sprite.setScale" class="openblock item method">
<div class="title">playdate.graphics.sprite:setScale(scale, [yScale])</div>
<div class="content">
<div class="paragraph">
<p>Sets the scaling factor for the sprite, with an optional separate scaling for the y axis. If setImage() is called after this, the scale factor is applied to the new image. Only affects sprites that have an image set.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getScale" class="openblock item method">
<div class="title">playdate.graphics.sprite:getScale()</div>
<div class="content">
<div class="paragraph">
<p>Returns multiple values <em>(xScale, yScale)</em>, the current scaling of the sprite.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setRotation" class="openblock item method">
<div class="title">playdate.graphics.sprite:setRotation(angle, [scale, [yScale]])</div>
<div class="content">
<div class="paragraph">
<p>Sets the rotation for the sprite, in degrees clockwise, with an optional scaling factor. If setImage() is called after this, the rotation and scale is applied to the new image. Only affects sprites that have an image set. This function should be used with discretion, as it&#8217;s likely to be slow on the hardware. Consider pre-rendering rotated images for your sprites instead.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getRotation" class="openblock item method">
<div class="title">playdate.graphics.sprite:getRotation()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current rotation of the sprite.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.copy" class="openblock item method">
<div class="title">playdate.graphics.sprite:copy()</div>
<div class="content">
<div class="paragraph">
<p>Returns a copy of the caller.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setUpdatesEnabled" class="openblock item method">
<div class="title">playdate.graphics.sprite:setUpdatesEnabled(flag)</div>
<div class="content">
<div class="paragraph">
<p>The sprite&#8217;s <em>updatesEnabled</em> flag (defaults to true) determines whether a sprite&#8217;s <a href="#c-graphics.sprite.update">update()</a> method will be called. By default, a sprite&#8217;s <code>update</code> method does nothing; however, you may choose to have your sprite do something on every frame by implementing an update method on your sprite instance, or implementing it in your sprite subclass.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.updatesEnabled" class="openblock item method">
<div class="title">playdate.graphics.sprite:updatesEnabled()</div>
<div class="content">
<div class="paragraph">
<p>Returns a boolean value, true if updates are enabled on the sprite.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setTag" class="openblock item method">
<div class="title">playdate.graphics.sprite:setTag(tag)</div>
<div class="content">
<div class="paragraph">
<p>Sets the sprite&#8217;s tag, an integer value in the range of 0 to 255, useful for identifying sprites later, particularly when working with collisions.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getTag" class="openblock item method">
<div class="title">playdate.graphics.sprite:getTag()</div>
<div class="content">
<div class="paragraph">
<p>Returns the sprite&#8217;s tag, an integer value.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setImageDrawMode" class="openblock item method">
<div class="title">playdate.graphics.sprite:setImageDrawMode(mode)</div>
<div class="content">
<div class="paragraph">
<p>Sets the mode for drawing the bitmap. See <a href="#f-graphics.setImageDrawMode">playdate.graphics.setImageDrawMode(mode)</a> for valid modes.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setImageFlip" class="openblock item method">
<div class="title">playdate.graphics.sprite:setImageFlip(flip, [flipCollideRect])</div>
<div class="content">
<div class="paragraph">
<p>Flips the bitmap. See <a href="#m-graphics.imgDraw">playdate.graphics.image:draw()</a> for valid <code>flip</code> values.</p>
</div>
<div class="paragraph">
<p>If <code>true</code> is passed for the optional <em>flipCollideRect</em> argument, the sprite&#8217;s collideRect will be flipped as well.</p>
</div>
<div class="paragraph">
<p>Calling setImage() will reset the sprite to its default, non-flipped orientation.  So, if you call both setImage() and setImageFlip(), call setImage() first.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getImageFlip" class="openblock item method">
<div class="title">playdate.graphics.sprite:getImageFlip()</div>
<div class="content">
<div class="paragraph">
<p>Returns one of the values listed at <a href="#m-graphics.imgDraw">playdate.graphics.image:draw()</a>.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setIgnoresDrawOffset" class="openblock item method">
<div class="title">playdate.graphics.sprite:setIgnoresDrawOffset(flag)</div>
<div class="content">
<div class="paragraph">
<p>When set to <em>true</em>, the sprite will draw in screen coordinates, ignoring the currently-set <a href="#f-graphics.setDrawOffset"><em>drawOffset</em></a>.</p>
</div>
<div class="paragraph">
<p>This only affects drawing, and should not be used on sprites being used for collisions, which will still happen in world-space.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setBounds" class="openblock item method">
<div class="title">playdate.graphics.sprite:setBounds(upper-left-x, upper-left-y, width, height)</div>
<div class="content">
<div class="paragraph">
<p><code>setBounds()</code> positions and sizes the sprite, used for drawing and for calculating dirty rects. <em>upper-left-x</em> and <em>upper-left-y</em> are relative to the overall display coordinate system. (If an image is attached to the sprite, the size will be defined by that image, and not by the <em>width</em> and <em>height</em> parameters passed in to <code>setBounds()</code>.)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In <code>setBounds()</code>, <em>x</em> and <em>y</em> always correspond to the upper left corner of the sprite, regardless of how a <a href="#m-graphics.sprite.setCenter">sprite&#8217;s center</a> is defined. This makes it different from <a href="#m-graphics.sprite.moveTo">sprite:moveTo()</a>, where <em>x</em> and <em>y</em> honor the sprite&#8217;s defined center (by default, at a point 50% along the sprite&#8217;s width and height.)
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.sprite.setBounds-rect" class="openblock item method">
<div class="title">playdate.graphics.sprite:setBounds(rect)</div>
<div class="content">
<div class="paragraph">
<p><code>setBounds(rect)</code> sets the bounds of the sprite with a <a href="#C-geometry.rect"><code>playdate.geometry.rect</code></a> object.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getBounds" class="openblock item method">
<div class="title">playdate.graphics.sprite:getBounds()</div>
<div class="content">
<div class="paragraph">
<p><code>getBounds()</code> returns multiple values (<em>x</em>, <em>y</em>, <em>width</em>, <em>height</em>).</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getBoundsRect" class="openblock item method">
<div class="title">playdate.graphics.sprite:getBoundsRect()</div>
<div class="content">
<div class="paragraph">
<p><code>getBoundsRect()</code> returns the sprite bounds as a <a href="#C-geometry.rect"><code>playdate.geometry.rect</code></a> object.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setOpaque" class="openblock item method">
<div class="title">playdate.graphics.sprite:setOpaque(flag)</div>
<div class="content">
<div class="paragraph">
<p>Marking a sprite opaque tells the sprite system that it doesn&#8217;t need to draw anything underneath the sprite, since it will be overdrawn anyway. If you set an image without a mask/alpha channel on the sprite, it automatically sets the opaque flag.</p>
</div>
<div class="paragraph">
<p>Setting a sprite to opaque can have performance benefits.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.isOpaque" class="openblock item method">
<div class="title">playdate.graphics.sprite:isOpaque()</div>
<div class="content">
<div class="paragraph">
<p>Returns the sprite&#8217;s current opaque flag.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_drawing_images_alongside_sprites">Drawing images alongside sprites</h5>
<div id="f-graphics.sprite.setBackgroundDrawingCallback" class="openblock item function">
<div class="title">playdate.graphics.sprite.setBackgroundDrawingCallback(drawCallback)</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/sprites</em> to use this function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A convenience function for drawing a background image behind your sprites.</p>
</div>
<div class="paragraph">
<p><em>drawCallback</em> is a routine you specify that implements your background drawing. The callback should be a function taking the arguments <code>x, y, width, height</code>, where <em>x, y, width, height</em> specify the region (in screen coordinates, not world coordinates) of the background region that needs to be updated.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Some implementation details: <code>setBackgroundDrawingCallback()</code> creates a screen-sized sprite with a z-index set to the lowest possible value so it will draw behind other sprites, and adds the sprite to the display list so that it is drawn in the current scene. The background sprite ignores the <a href="#f-graphics.setDrawOffset">drawOffset</a>, and will not be automatically redrawn when the draw offset changes; use <a href="#f-graphics.sprite.redrawBackground">playdate.graphics.sprite.redrawBackground()</a> if necessary in this case. <em>drawCallback</em> will be called from the newly-created background sprite’s <a href="#c-graphics.sprite.draw">playdate.graphics.sprite:draw()</a> callback function and is where you should do your background drawing. This function returns the newly created <a href="#C-graphics.sprite">playdate.graphics.sprite</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">For additional background, here is the implementation of <code>setBackgroundDrawingCallback()</code> in the Playdate SDK. (This does <em>not</em> reflect how you should use <code>setBackgroundDrawingCallback()</code> in your game. For an example of game usage, see <a href="#basic-playdate-game">A Basic Playdate Game in Lua</a>.)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">function</span> playdate.graphics.sprite.<span class="function">setBackgroundDrawingCallback</span>(drawCallback)
        <span class="keyword">local</span> <span class="local-variable">bgsprite</span> = gfx.sprite.new()
        bgsprite:setSize(playdate.display.getSize())
        bgsprite:setCenter(<span class="integer">0</span>, <span class="integer">0</span>)
        bgsprite:moveTo(<span class="integer">0</span>, <span class="integer">0</span>)
        bgsprite:setZIndex(<span class="integer">-32768</span>)
        bgsprite:setIgnoresDrawOffset(<span class="predefined-constant">true</span>)
        bgsprite:setUpdatesEnabled(<span class="predefined-constant">false</span>)
        bgsprite.draw = <span class="keyword">function</span>(s, x, y, w, h)
                drawCallback(x, y, w, h)
        <span class="keyword">end</span>
        bgsprite:add()
        <span class="keyword">return</span> bgsprite
<span class="keyword">end</span></code></pre>
</div>
</div>
<div id="f-graphics.sprite.redrawBackground" class="openblock item function">
<div class="title">playdate.graphics.sprite.redrawBackground()</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/sprites</em> to use this function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Marks the background sprite dirty, forcing the drawing callback to be run when <a href="#f-graphics.sprite.update">playdate.graphics.sprite.update()</a> is called.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setTilemap" class="openblock item method">
<div class="title">playdate.graphics.sprite:setTilemap(tilemap)</div>
<div class="content">
<div class="paragraph">
<p>Sets the sprite&#8217;s contents to the given <a href="#C-graphics.tilemap">tilemap</a>. Useful if you want to automate drawing of your tilemap, especially if interleaved by depth with other sprites being drawn.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_automatically_animating_sprites">Automatically animating sprites</h5>
<div class="paragraph">
<p>While it is customary to move sprites around onscreen by calling <code>sprite:moveTo(x, y)</code> on successive <code>playdate.update()</code> calls, it is possible to automate animation behavior with the use of <a href="#C-graphics.animator">animators</a>.</p>
</div>
<div id="m-graphics.sprite.setAnimator" class="openblock item method">
<div class="title">playdate.graphics.sprite:setAnimator(animator, [moveWithCollisions, [removeOnCollision]])</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/sprites</em> to use the <code>setAnimator</code> method.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>setAnimator</code> assigns an <a href="#C-graphics.animator">playdate.graphics.animator</a> to the sprite, which will cause the sprite to automatically update its position each frame while the animator is active.</p>
</div>
<div class="paragraph">
<p><em>animator</em> should be a <a href="#C-graphics.animator">playdate.graphics.animator</a> created using <a href="#C-geometry.point">playdate.geometry.point</a>s for its start and end values.</p>
</div>
<div class="paragraph">
<p><em>movesWithCollisions</em>, if provided and true will cause the sprite to move with collisions. A collision rect must be set on the sprite prior to passing true for this argument.</p>
</div>
<div class="paragraph">
<p><em>removeOnCollision</em>, if provided and true will cause the animator to be removed from the sprite when a collision occurs.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>setAnimator</code> should be called only after any custom update method has been set on the sprite.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.sprite.removeAnimator" class="openblock item method">
<div class="title">playdate.graphics.sprite:removeAnimator()</div>
<div class="content">
<div class="paragraph">
<p>Removes a <a href="#C-graphics.animator">playdate.graphics.animator</a> assigned to the sprite</p>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Setting an animator on a sprite</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- You can copy and paste this example directly as your main.lua file to see it in action</span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/animator</span><span class="delimiter">&quot;</span></span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/sprites</span><span class="delimiter">&quot;</span></span>

<span class="comment">-- We'll be demonstrating how to use an animator to animate a sprite</span>
<span class="keyword">local</span> <span class="local-variable">square</span> = playdate.graphics.image.new(<span class="integer">20</span>, <span class="integer">20</span>, playdate.graphics.kColorBlack)
<span class="keyword">local</span> <span class="local-variable">squareSprite</span> = playdate.graphics.sprite.new(square)
squareSprite:add()

<span class="comment">-- 4000ms, or 4 seconds</span>
<span class="keyword">local</span> <span class="local-variable">animationDuration</span> = <span class="integer">4000</span>
<span class="comment">-- We're animating in a rectangle, around the screen. The animator must be animating along some geometry</span>
<span class="comment">-- or between two points if used on a sprite - just animating between two values will result in an error</span>
<span class="keyword">local</span> <span class="local-variable">polygon</span> = playdate.geometry.polygon.new(<span class="integer">20</span>, <span class="integer">20</span>, <span class="integer">380</span>, <span class="integer">20</span>, <span class="integer">380</span>, <span class="integer">220</span>, <span class="integer">20</span>, <span class="integer">220</span>, <span class="integer">20</span>, <span class="integer">20</span>)
<span class="comment">-- Setting an easing function to get a nice, smooth movement</span>
<span class="keyword">local</span> <span class="local-variable">easingFunction</span> = playdate.easingFunctions.inOutCubic
<span class="keyword">local</span> <span class="local-variable">animator</span> = playdate.graphics.animator.new(animationDuration, polygon, easingFunction)

<span class="comment">-- Setting the animator on the sprite to move it</span>
squareSprite:setAnimator(animator)

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    <span class="comment">-- Everything is handled automatically, provided you call the sprite update function</span>
    playdate.graphics.sprite.update()

    <span class="comment">-- Set to and stays true on animation end - will print continuously when the animation finishes</span>
    <span class="keyword">if</span> animator:ended() <span class="keyword">then</span>
        <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Animation ended!</span><span class="delimiter">&quot;</span></span>)
    <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_clipping_2">Clipping</h5>
<div id="m-graphics.sprite.setClipRect" class="openblock item method">
<div class="title">playdate.graphics.sprite:setClipRect(x, y, width, height) <br> playdate.graphics.sprite:setClipRect(rect)</div>
<div class="content">
<div class="paragraph">
<p>Sets the clipping rectangle for the sprite, using separate parameters or a <a href="#C-geometry.rect"><code>playdate.geometry.rect</code></a> object. Only areas within the rect will be drawn.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.clearClipRect" class="openblock item method">
<div class="title">playdate.graphics.sprite:clearClipRect()</div>
<div class="content">
<div class="paragraph">
<p>Clears the sprite&#8217;s current clipping rectangle.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.setClipRectsInRange" class="openblock item function">
<div class="title">playdate.graphics.sprite.setClipRectsInRange(x, y, width, height, startz, endz) <br> playdate.graphics.sprite.setClipRectsInRange(rect, startz, endz)</div>
<div class="content">
<div class="paragraph">
<p>Sets the clip rect for sprites in the given z-index range.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.clearClipRectsInRange" class="openblock item function">
<div class="title">playdate.graphics.sprite.clearClipRectsInRange(startz, endz)</div>
<div class="content">
<div class="paragraph">
<p>Clears sprite clip rects in the given z-index range.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setStencilImage" class="openblock item method">
<div class="title">playdate.graphics.sprite:setStencilImage(stencil, [tile])</div>
<div class="content">
<div class="paragraph">
<p>Specifies a stencil image to be set before the sprite is drawn. As with <a href="#f-graphics.setStencilImage">playdate.graphics.setStencilImage()</a>, the sprite pixels will be drawn where the stencil is white and nothing drawn where the stencil is black. Note that the stencil is attached to the frame buffer (i.e., the screen), not the sprite&mdash;it does not move along with the sprite. If <em>tile</em> is set, the stencil will be tiled; in this case, the image width must be a multiple of 32 pixels.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setStencilPattern" class="openblock item method">
<div class="title">playdate.graphics.setStencilPattern({ row1, row2, row3, row4, row5, row6, row7, row8 })</div>
<div class="content">
<div class="paragraph">
<p>Sets the sprite&#8217;s stencil to the given pattern, tiled across the screen.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setStencilPattern_p" class="openblock item method">
<div class="title">playdate.graphics.setStencilPattern(pattern)</div>
<div class="content">
<div class="paragraph">
<p>Sets the sprite&#8217;s stencil to the given pattern, tiled across the screen. <code>pattern</code> should be a table of the form <code>{ row1, row2, row3, row4, row5, row6, row7, row8 }</code>.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setStencilPattern-dither" class="openblock item method">
<div class="title">playdate.graphics.sprite:setStencilPattern(level, [ditherType])</div>
<div class="content">
<div class="paragraph">
<p>Sets the sprite&#8217;s stencil to a dither pattern specified by <em>level</em> and optional <em>ditherType</em> (defaults to <code>playdate.graphics.image.kDitherTypeBayer8x8</code>).</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.clearStencil" class="openblock item method">
<div class="title">playdate.graphics.sprite:clearStencil()</div>
<div class="content">
<div class="paragraph">
<p>Clears the sprite&#8217;s stencil.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_drawing_3">Drawing</h5>
<div id="f-graphics.sprite.setAlwaysRedraw" class="openblock item function">
<div class="title">playdate.graphics.sprite.setAlwaysRedraw(flag)</div>
<div class="content">
<div class="paragraph">
<p>If set to true, causes all sprites to draw each frame, whether or not they have been marked dirty. This may speed up the performance of your game if the system&#8217;s dirty rect tracking is taking up too much time - for example if there are many sprites moving around on screen at once.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.getAlwaysRedraw" class="openblock item function">
<div class="title">playdate.graphics.sprite.getAlwaysRedraw()</div>
<div class="content">
<div class="paragraph">
<p>Return&#8217;s the sprites "always redraw" flag.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.markDirty" class="openblock item method">
<div class="title">playdate.graphics.sprite:markDirty()</div>
<div class="content">
<div class="paragraph">
<p>Marks the rect defined by the sprite&#8217;s current bounds as needing a redraw.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.addDirtyRect" class="openblock item method">
<div class="title">playdate.graphics.sprite.addDirtyRect(x, y, width, height)</div>
<div class="content">
<div class="paragraph">
<p>Marks the given rectangle (in screen coordinates) as needing a redraw. playdate.graphics drawing functions now call this automatically, adding their drawn areas to the sprite&#8217;s dirty list, so there&#8217;s likely no need to call this manually any more. This behavior may change in the future, though.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setRedrawsOnImageChange" class="openblock item">
<div class="title">playdate.graphics.sprite:setRedrawsOnImageChange(flag)</div>
<div class="content">
<div class="paragraph">
<p>By default, sprites are automatically marked for redraw when their image is changed via <a href="#m-graphics.sprite.setImage">playdate.graphics.sprite:setImage()</a>. If disabled by calling this function with a <em>false</em> argument, <a href="#m-graphics.sprite.addDirtyRect">playdate.graphics.sprite.addDirtyRect()</a> can be used to mark the (potentially smaller) area of the screen that needs to be redrawn.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_group_operations">Group operations</h5>
<div id="f-graphics.sprite.getAllSprites" class="openblock item function">
<div class="title">playdate.graphics.sprite.getAllSprites()</div>
<div class="content">
<div class="paragraph">
<p>Returns an array of all sprites in the display list.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.performOnAllSprites" class="openblock item function">
<div class="title">playdate.graphics.sprite.performOnAllSprites(f)</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/sprites</em> to use this function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Performs the function <em>f</em> on all sprites in the display list. <em>f</em> should take one argument, which will be a sprite.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.spriteCount" class="openblock item function">
<div class="title">playdate.graphics.sprite.spriteCount()</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of sprites in the display list.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.removeAll" class="openblock item function">
<div class="title">playdate.graphics.sprite.removeAll()</div>
<div class="content">
<div class="paragraph">
<p>Removes all sprites from the global sprite list.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.removeSprites" class="openblock item method">
<div class="title">playdate.graphics.sprite.removeSprites(spriteArray)</div>
<div class="content">
<div class="paragraph">
<p>Removes all sprites in <code>spriteArray</code> from the global sprite list.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_sprite_callbacks">Sprite callbacks</h5>
<div id="c-graphics.sprite.draw" class="openblock item callback">
<div class="title">playdate.graphics.sprite:draw(x, y, width, height)</div>
<div class="content">
<div class="paragraph">
<p>If the sprite doesn&#8217;t have an image, the sprite&#8217;s draw function is called as needed to update the display. The rect passed in is the current dirty rect being updated by the display list. The rect coordinates passed in are relative to the sprite itself (i.e. x = 0, y = 0 refers to the top left corner of the sprite). Note that the callback is only called when the sprite is on screen and has a size specified via <a href="#m-graphics.sprite.setSize">sprite:setSize()</a> or <a href="#m-graphics.sprite.setBounds">sprite:setBounds()</a>.</p>
</div>
<div class="listingblock">
<div class="title">Example: Overriding the sprite draw method</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- You can copy and paste this example directly as your main.lua file to see it in action</span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/graphics</span><span class="delimiter">&quot;</span></span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/sprites</span><span class="delimiter">&quot;</span></span>

<span class="keyword">local</span> <span class="local-variable">mySprite</span> = playdate.graphics.sprite.new()
mySprite:moveTo(<span class="integer">200</span>, <span class="integer">120</span>)
<span class="comment">-- You MUST set a size first for anything to show up (either directly or by setting an image)</span>
mySprite:setSize(<span class="integer">30</span>, <span class="integer">30</span>)
mySprite:add()

<span class="comment">-- The x, y, width, and height arguments refer to the dirty rect being updated, NOT the sprite dimensions</span>
<span class="keyword">function</span> mySprite:<span class="function">draw</span>(x, y, width, height)
    <span class="comment">-- Custom draw methods gives you more flexibility over what's drawn, but with the added benefits of sprites</span>

    <span class="comment">-- Here we're just modulating the circle radius over time</span>
    <span class="keyword">local</span> <span class="local-variable">spriteWidth</span>, <span class="local-variable">spriteHeight</span> = self:getSize()
    <span class="keyword">if</span> <span class="keyword">not</span> self.radius <span class="keyword">or</span> self.radius &gt; spriteWidth <span class="keyword">then</span>
        self.radius = <span class="integer">0</span>
    <span class="keyword">end</span>
    self.radius += <span class="integer">1</span>

    <span class="comment">-- Drawing coordinates are relative to the sprite (e.g. (0, 0) is the top left of the sprite)</span>
    playdate.graphics.fillCircleAtPoint(spriteWidth / <span class="integer">2</span>, spriteHeight / <span class="integer">2</span>, self.radius)
<span class="keyword">end</span>

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    <span class="comment">-- Your custom draw method gets called here, but only if the sprite is dirty</span>
    playdate.graphics.sprite.update()

    <span class="comment">-- You might need to manually mark it dirty</span>
    mySprite:markDirty()
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div id="c-graphics.sprite.update" class="openblock item callback">
<div class="title">playdate.graphics.sprite:update()</div>
<div class="content">
<div class="paragraph">
<p>Called by <a href="#f-graphics.sprite.update">playdate.graphics.sprite.update()</a> (note the syntactic difference between the period and the colon) before sprites are drawn. Implementing <code>:update()</code> gives you the opportunity to perform some code upon every frame.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The update method will only be called on sprites that have had <a href="#m-graphics.sprite.add">add()</a> called on them, and have their <a href="#m-graphics.sprite.updatesEnabled">updates enabled</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Be careful not confuse <code>sprite:update()</code> with <a href="#f-graphics.sprite.update"><code>sprite.update()</code></a>: the latter updates all sprites; the former updates just the sprite being invoked.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example: Overriding the sprite update method</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">mySprite</span> = playdate.graphics.sprite.new()
mySprite:moveTo(<span class="integer">200</span>, <span class="integer">120</span>)
mySprite:add() <span class="comment">-- Sprite needs to be added to get drawn and updated</span>
<span class="comment">-- mySprite:remove() will make it so the sprite stops getting drawn/updated</span>

<span class="comment">-- Option 1: override the update method using an anonymous function</span>
mySprite.update = <span class="keyword">function</span>(self)
    <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">This gets called every frame when I'm added to the display list</span><span class="delimiter">&quot;</span></span>)
    <span class="comment">-- Manipulate sprite using &quot;self&quot;</span>
    <span class="predefined">print</span>(self.x) <span class="comment">-- Prints 200.0</span>
    <span class="predefined">print</span>(self.y) <span class="comment">-- Prints 120.0</span>
<span class="keyword">end</span>

<span class="comment">-- Option 2: override the update method using a function stored in a variable</span>
<span class="keyword">local</span> <span class="keyword">function</span> <span class="function">mySpriteUpdate</span>(self)
    <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">This gets called every frame when I'm added to the display list</span><span class="delimiter">&quot;</span></span>)
    <span class="comment">-- Manipulate sprite using &quot;self&quot;</span>
    <span class="predefined">print</span>(self.x) <span class="comment">-- Prints 200.0</span>
    <span class="predefined">print</span>(self.y) <span class="comment">-- Prints 120.0</span>
<span class="keyword">end</span>
mySprite.update = mySpriteUpdate

<span class="comment">-- Option 3: override the update method by directly defining it</span>
<span class="keyword">function</span> mySprite:<span class="function">update</span>()
    <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">This gets called every frame when I'm added to the display list</span><span class="delimiter">&quot;</span></span>)
    <span class="comment">-- Manipulate sprite using &quot;self&quot;</span>
    <span class="predefined">print</span>(self.x) <span class="comment">-- Prints 200.0</span>
    <span class="predefined">print</span>(self.y) <span class="comment">-- Prints 120.0</span>
<span class="keyword">end</span>

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    <span class="comment">-- Your custom update method gets called here every frame if the sprite has been added</span>
    playdate.graphics.sprite.update()
<span class="keyword">end</span>

<span class="comment">-- VERY simplified psuedocode explanation of what's happening in sprite.update() (not real code)</span>
<span class="keyword">local</span> <span class="local-variable">displayList</span> = <span class="map"><span class="delimiter">{</span><span class="delimiter">}</span></span> <span class="comment">-- Added sprites are kept track of in a list</span>
<span class="keyword">function</span> playdate.graphics.sprite.<span class="function">update</span>()
    <span class="comment">-- The display list is iterated over</span>
    <span class="keyword">for</span> i=<span class="integer">1</span>, #displayList <span class="keyword">do</span>
        <span class="keyword">local</span> <span class="local-variable">sprite</span> = displayList[i]
        <span class="comment">-- Checks if updates on the sprites are enabled</span>
        <span class="keyword">if</span> sprite:updatesEnabled() <span class="keyword">then</span>
            <span class="comment">-- The sprite update method is called</span>
            sprite:update()
        <span class="keyword">end</span>
        ...
        <span class="comment">-- Redraw all of the dirty rects, handle collisions, etc.</span>
    <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4 module">
<h5 id="M-sprite-collisions">Sprite collision detection</h5>
<div class="paragraph">
<p>The following functions are based on the <a href="https://github.com/kikito/bump.lua">bump.lua collision detection library</a>. Some things to note:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To participate in collisions, a sprite must have its <a href="#m-graphics.sprite.setCollideRect"><em>collideRect</em></a> set.</p>
</li>
<li>
<p>Only handles axis-aligned bounding box (AABB) collisions.</p>
</li>
<li>
<p>Handles tunneling &mdash; all items are treated as "bullets". The fact that we only use AABBs makes this fast.</p>
</li>
<li>
<p>Centered on detection, but also offers some (minimal &amp; basic) collision response.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ideal for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tile-based games, and games where most entities can be represented as axis-aligned rectangles.</p>
</li>
<li>
<p>Games which require some physics but not a full realistic simulation, like a platformer.</p>
</li>
<li>
<p>Examples of appropriate genres: top-down games (Zelda), shoot 'em ups, fighting games (Street Fighter), platformers (Super Mario).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Not a good match for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Games that require polygons for collision detection.</p>
</li>
<li>
<p>Games that require highly realistic simulations of physics - things stacking up, rolling over slides, etc.</p>
</li>
<li>
<p>Games that require very fast objects colliding realistically against each other (sprites here are moved and collided one at a time).</p>
</li>
<li>
<p>Simulations where the order in which the collisions are resolved isn&#8217;t known.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_basic_collision_checking">Basic collision checking</h6>
<div id="m-graphics.sprite.setCollideRect" class="openblock item method">
<div class="title">playdate.graphics.sprite:setCollideRect(x, y, width, height) <br> playdate.graphics.sprite:setCollideRect(rect)</div>
<div class="content">
<div class="paragraph">
<p><code>setCollideRect()</code> marks the area of the sprite, relative to its own internal coordinate system, to be checked for collisions with other sprites' collide rects. Note that the coordinate space is relative to the top-left corner of the bounds, regardless of where the sprite&#8217;s <a href="#m-graphics.sprite.setCenter">center/anchor</a> is located.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If you want to set the sprite&#8217;s collide rect to be the same size as the sprite itself, you can write <code>sprite:setCollideRect( 0, 0, sprite:getSize() )</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<code>setCollideRect()</code> must be invoked on a sprite in order to get it to participate in collisions.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Very large sprites with very large collide rects should be avoided, as they will have a negative impact on performance and memory usage.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.sprite.getCollideRect" class="openblock item method">
<div class="title">playdate.graphics.sprite:getCollideRect()</div>
<div class="content">
<div class="paragraph">
<p>Returns the sprite&#8217;s collide rect set with <a href="#m-graphics.sprite.setCollideRect"><code>setCollideRect()</code></a>. Return value is a <a href="#C-geometry.rect"><code>playdate.geometry.rect</code></a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This function return coordinates relative to the sprite itself; the sprite&#8217;s position has no bearing on these values.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.sprite.getCollideBounds" class="openblock item method">
<div class="title">playdate.graphics.sprite:getCollideBounds()</div>
<div class="content">
<div class="paragraph">
<p>Returns the sprite&#8217;s collide rect as multiple values, (<em>x</em>, <em>y</em>, <em>width</em>, <em>height</em>).</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This function return coordinates relative to the sprite itself; the sprite&#8217;s position has no bearing on these values.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.sprite.clearCollideRect" class="openblock item method">
<div class="title">playdate.graphics.sprite:clearCollideRect()</div>
<div class="content">
<div class="paragraph">
<p>Clears the sprite&#8217;s collide rect set with <a href="#m-graphics.sprite.setCollideRect"><code>setCollideRect()</code></a>.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.overlappingSprites" class="openblock item method">
<div class="title">playdate.graphics.sprite:overlappingSprites()</div>
<div class="content">
<div class="paragraph">
<p>Returns an array of sprites that have collide rects that are currently overlapping the calling sprite&#8217;s collide rect, taking the sprites' groups and collides-with masks into consideration.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.allOverlappingSprites" class="openblock item function">
<div class="title">playdate.graphics.sprite.allOverlappingSprites()</div>
<div class="content">
<div class="paragraph">
<p>Returns an array of array-style tables, each containing two sprites that have overlapping collide rects. All sprite pairs that are have overlapping collide rects (taking the sprites' group and collides-with masks into consideration) are returned.</p>
</div>
<div class="listingblock">
<div class="title">An example of iterating over the collisions array:</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">collisions</span> = gfx.sprite.allOverlappingSprites()

<span class="keyword">for</span> i = <span class="integer">1</span>, #collisions <span class="keyword">do</span>
        <span class="keyword">local</span> <span class="local-variable">collisionPair</span> = collisions[i]
        <span class="keyword">local</span> <span class="local-variable">sprite1</span> = collisionPair[<span class="integer">1</span>]
        <span class="keyword">local</span> <span class="local-variable">sprite2</span> = collisionPair[<span class="integer">2</span>]
        <span class="comment">-- do something with the colliding sprites</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div id="m-graphics.sprite.alphaCollision" class="openblock item method">
<div class="title">playdate.graphics.sprite:alphaCollision(anotherSprite)</div>
<div class="content">
<div class="paragraph">
<p>Returns a boolean value set to true if a pixel-by-pixel comparison of the sprite images shows that non-transparent pixels are overlapping, based on the current bounds of the sprites.</p>
</div>
<div class="paragraph">
<p>This method may be used in conjunction with the standard collision architecture. Say, if <a href="#m-graphics.sprite.overlappingSprites"><code>overlappingSprites()</code></a> or <a href="#m-graphics.sprite.moveWithCollisions"><code>moveWithCollisions()</code></a> report a collision of two sprite&#8217;s bounding rects, alphaCollision() could then be used to discern if a pixel-level collision occurred.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setCollisionsEnabled" class="openblock item method">
<div class="title">playdate.graphics.sprite:setCollisionsEnabled(flag)</div>
<div class="content">
<div class="paragraph">
<p>The sprite&#8217;s <em>collisionsEnabled</em> flag (defaults to true) can be set to <code>false</code> in order to temporarily keep a sprite from colliding with any other sprite.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.collisionsEnabled" class="openblock item method">
<div class="title">playdate.graphics.sprite:collisionsEnabled()</div>
<div class="content">
<div class="paragraph">
<p>Returns the sprite&#8217;s <em>collisionsEnabled</em> flag.</p>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_restricting_collisions">Restricting collisions</h6>
<div class="paragraph">
<p>Collisions can be restricted using one of two methods: setting <strong>collision groups</strong>, or setting <strong>group masks</strong>. Groups are in fact just a simplified API for configuring group masks; they both operate on the same underlying architecture.</p>
</div>
</div>
<div class="sect5">
<h6 id="_collision_groups">Collision groups</h6>
<div id="m-graphics.sprite.setGroups" class="openblock item method">
<div class="title">playdate.graphics.sprite:setGroups(groups)</div>
<div class="content">
<div class="paragraph">
<p>Adds the sprite to one or more collision groups. A group is a collection of sprites that exhibit similar collision behavior. (An example: in Atari&#8217;s <em>Asteroids</em>, asteroid sprites would all be added to the same group, while the player&#8217;s spaceship might be in a different group.) Use <a href="#m-graphics.sprite.setCollidesWithGroups"><code>setCollidesWithGroups()</code></a> to define which groups a sprite should collide with.</p>
</div>
<div class="paragraph">
<p>There are 32 groups, each defined by the integer 1 through 32. To add a sprite to only groups 1 and 3, for example, call <code>mySprite:setGroups({1, 3})</code>.</p>
</div>
<div class="paragraph">
<p>Alternatively, use <a href="#m-graphics.sprite.setGroupMask"><code>setGroupMask()</code></a> to set group membership via a bitmask.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setCollidesWithGroups" class="openblock item method">
<div class="title">playdate.graphics.sprite:setCollidesWithGroups(groups)</div>
<div class="content">
<div class="paragraph">
<p>Pass in a group number or an array of group numbers to specify which groups this sprite can collide with. Groups are numbered 1 through 32. Use <a href="#m-graphics.sprite.setGroups"><code>setGroups()</code></a> to specify which groups a sprite belongs to.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can specify group collision behavior with a bitmask by using <a href="#m-graphics.sprite.setCollidesWithGroupsMask"><code>setCollidesWithGroupsMask()</code></a>.</p>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_group_masks">Group masks</h6>
<div class="paragraph">
<p>Sprites may be assigned to groups and define which groups they collide with as a method of filtering collisions. These groups are represented by two bitmasks on the sprites: a group bitmask, and a collides-with-groups bitmask. If sprite A&#8217;s collides-with-groups bitmask overlaps sprite B&#8217;s groups (a bitwise AND of the masks is not zero), or if no groups have been set (both masks are set to 0x00000000), a collision will happen when moving sprite A through sprite B. Convenience functions <a href="#m-graphics.sprite.setGroups"><code>setGroups()</code></a> and <a href="#m-graphics.sprite.setCollidesWithGroups"><code>setCollidesWithGroups()</code></a> exist to avoid the need to deal with bitmasks directly.</p>
</div>
<div id="m-graphics.sprite.setGroupMask" class="openblock item method">
<div class="title">playdate.graphics.sprite:setGroupMask(mask)</div>
<div class="content">
<div class="paragraph">
<p><code>setGroupMask()</code> sets the sprite&#8217;s group bitmask, which is 32 bits. In conjunction with the <a href="#m-graphics.sprite.setCollidesWithGroupsMask"><code>setCollidesWithGroupsMask()</code></a> method, this controls which sprites can collide with each other.</p>
</div>
<div class="paragraph">
<p>For large group mask numbers, pass the number as a hex value, eg. <code>0xFFFFFFFF</code> to work around limitations in Lua&#8217;s integer sizes.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getGroupMask" class="openblock item method">
<div class="title">playdate.graphics.sprite:getGroupMask()</div>
<div class="content">
<div class="paragraph">
<p><code>getGroupMask()</code> returns the integer value of the sprite&#8217;s group bitmask.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.setCollidesWithGroupsMask" class="openblock item method">
<div class="title">playdate.graphics.sprite:setCollidesWithGroupsMask(mask)</div>
<div class="content">
<div class="paragraph">
<p>Sets the sprite&#8217;s collides-with-groups bitmask, which is 32 bits. The mask specifies which other sprite groups this sprite can collide with. Sprites only collide if the moving sprite&#8217;s <em>collidesWithGroupsMask</em> matches at least one group of a potential collision sprite (i.e. a bitwise AND (&amp;) between the moving sprite&#8217;s <em>collidesWithGroupsMask</em> and a potential collision sprite&#8217;s <em>groupMask</em> != zero) or if the moving sprite&#8217;s <em>collidesWithGroupsMask</em> and the other sprite&#8217;s <em>groupMask</em> are both set to 0x00000000 (the default values).</p>
</div>
<div class="paragraph">
<p>For large mask numbers, pass the number as a hex value, eg. <code>0xFFFFFFFF</code> to work around limitations in Lua&#8217;s integer sizes.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.getCollidesWithGroupsMask" class="openblock item method">
<div class="title">playdate.graphics.sprite:getCollidesWithGroupsMask()</div>
<div class="content">
<div class="paragraph">
<p>Returns the integer value of the sprite&#8217;s collision bitmask.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.resetGroupMask" class="openblock item method">
<div class="title">playdate.graphics.sprite:resetGroupMask()</div>
<div class="content">
<div class="paragraph">
<p>Resets the sprite&#8217;s group mask to <code>0x00000000</code>.</p>
</div>
</div>
</div>
<div id="m-graphics.sprite.resetCollidesWithGroupsMask" class="openblock item method">
<div class="title">playdate.graphics.sprite:resetCollidesWithGroupsMask()</div>
<div class="content">
<div class="paragraph">
<p>Resets the sprite&#8217;s collides-with-groups mask to <code>0x00000000</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_advanced_collisions">Advanced Collisions</h6>
<div id="m-graphics.sprite.moveWithCollisions" class="openblock item method">
<div class="title">playdate.graphics.sprite:moveWithCollisions(goalX, goalY) <br> playdate.graphics.sprite:moveWithCollisions(goalPoint)</div>
<div class="content">
<div class="paragraph">
<p>Moves the sprite towards <em>goalX</em>, <em>goalY</em> or <em>goalPoint</em> taking collisions into account, which means the sprite&#8217;s final position may not be the same as <em>goalX</em>, <em>goalY</em> or <em>goalPoint</em>.</p>
</div>
<div class="paragraph">
<p>Returns <em>actualX</em>, <em>actualY</em>, <em>collisions</em>, <em>length</em>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>actualX</em>, <em>actualY</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the final position of the sprite. If no collisions occurred, this will be the same as <em>goalX</em>, <em>goalY</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>collisions</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">an array of userdata objects containing information about all collisions that occurred. Each item in the array contains values for the following indices:</p>
<p class="tableblock">- <em>sprite</em>: The sprite being moved.</p>
<p class="tableblock">- <em>other</em>: The sprite colliding with the sprite being moved.</p>
<p class="tableblock">- <em>type</em>: The result of <a href="#c-graphics.sprite.collisionResponse"><em>collisionResponse</em></a>.</p>
<p class="tableblock">- <em>overlaps</em>: Boolean. True if the sprite was overlapping <em>other</em> when the collision started. False if it didn&#8217;t overlap but tunneled through <em>other</em>.</p>
<p class="tableblock">- <em>ti</em>: A number between 0 and 1 indicating how far along the movement to the goal the collision occurred.</p>
<p class="tableblock">- <em>move</em>: <a href="#C-geometry.vector2D">playdate.geometry.vector2D</a>. The difference between the original coordinates and the actual ones when the collision happened.</p>
<p class="tableblock">- <em>normal</em>: <a href="#C-geometry.vector2D">playdate.geometry.vector2D</a>. The collision normal; usually -1, 0, or 1 in <em>x</em> and <em>y</em>. Use this value to determine things like if your character is touching the ground.</p>
<p class="tableblock">- <em>touch</em>: <a href="#C-geometry.point">playdate.geometry.point</a>. The coordinates where the sprite started touching <em>other</em>.</p>
<p class="tableblock">- <em>spriteRect</em>: <a href="#C-geometry.rect">playdate.geometry.rect</a>. The rectangle the sprite occupied when the touch happened.</p>
<p class="tableblock">- <em>otherRect</em>: <a href="#C-geometry.rect">playdate.geometry.rect</a>. The rectangle <code>other</code> occupied when the touch happened.</p>
<p class="tableblock">If the collision type was <em>playdate.graphics.sprite.kCollisionTypeBounce</em> the table also contains <em>bounce</em>, a <a href="#C-geometry.point">playdate.geometry.point</a> indicating the coordinates to which the sprite attempted to bounce (could be different than <em>actualX</em>, <em>actualY</em> if further collisions occurred).</p>
<p class="tableblock">If the collision type was <em>playdate.graphics.sprite.kCollisionTypeSlide</em> the table also contains <em>slide</em>, a <a href="#C-geometry.point">playdate.geometry.point</a> indicating the coordinates to which the sprite attempted to slide.</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>length</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the length of the collisions array, equal to <em>#collisions</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note that the collision info items are only valid until the next call of <em>moveWithCollisions</em> or <em>checkCollisions</em>. To save collision information for later, the data should be copied out of the collision info userdata object.</p>
</div>
<div class="paragraph">
<p>See also <a href="#m-graphics.sprite.checkCollisions"><code>checkCollisions()</code></a> to check for collisions without actually moving the sprite.</p>
</div>
<div class="listingblock">
<div class="title">Example: Using moveWithCollisions for a simple player collision example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="comment">-- You can copy and paste this example directly as your main.lua file to see it in action</span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/graphics</span><span class="delimiter">&quot;</span></span>
import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/sprites</span><span class="delimiter">&quot;</span></span>

<span class="comment">-- Creating a tags object, to keep track of tags more easily</span>
TAGS = <span class="map"><span class="delimiter">{</span>
    <span class="key">player</span> = <span class="integer">1</span>,
    <span class="key">obstacle</span> = <span class="integer">2</span>,
    <span class="key">coin</span> = <span class="integer">3</span>,
    <span class="key">powerUp</span> = <span class="integer">4</span>
<span class="delimiter">}</span></span>

<span class="comment">-- Creating a player sprite we can move around and collide things with</span>
<span class="keyword">local</span> <span class="local-variable">playerImage</span> = playdate.graphics.image.new(<span class="integer">20</span>, <span class="integer">20</span>)
playdate.graphics.pushContext(playerImage)
    playdate.graphics.fillCircleInRect(<span class="integer">0</span>, <span class="integer">0</span>, playerImage:getSize())
playdate.graphics.popContext()
<span class="keyword">local</span> <span class="local-variable">playerSprite</span> = playdate.graphics.sprite.new(playerImage)
<span class="comment">-- Setting a tag on the player, so we can check the tag to see if we're colliding against the player</span>
playerSprite:setTag(TAGS.player)
playerSprite:moveTo(<span class="integer">200</span>, <span class="integer">120</span>)
<span class="comment">-- Remember to set a collision rect, or this all doesn't work!</span>
playerSprite:setCollideRect(<span class="integer">0</span>, <span class="integer">0</span>, playerSprite:getSize())
playerSprite:add()

<span class="comment">-- Creating an obstacle sprite we can collide against</span>
<span class="keyword">local</span> <span class="local-variable">obstacleImage</span> = playdate.graphics.image.new(<span class="integer">20</span>, <span class="integer">20</span>, playdate.graphics.kColorBlack)
<span class="keyword">local</span> <span class="local-variable">obstacleSprite</span> = playdate.graphics.sprite.new(obstacleImage)
<span class="comment">-- Setting a tag for the obstacle as well</span>
obstacleSprite:setTag(TAGS.obstacle)
obstacleSprite:moveTo(<span class="integer">300</span>, <span class="integer">120</span>)
<span class="comment">-- Can't forget this!</span>
obstacleSprite:setCollideRect(<span class="integer">0</span>, <span class="integer">0</span>, obstacleSprite:getSize())
obstacleSprite:add()

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    playdate.graphics.sprite.update()

    <span class="comment">-- Some simple movement code for the sake of demonstration</span>
    <span class="keyword">local</span> <span class="local-variable">moveSpeed</span> = <span class="integer">3</span>
    <span class="keyword">local</span> <span class="local-variable">goalX</span>, <span class="local-variable">goalY</span> = playerSprite.x, playerSprite.y
    <span class="keyword">if</span> playdate.buttonIsPressed(playdate.kButtonUp) <span class="keyword">then</span>
        goalY -= moveSpeed
    <span class="keyword">elseif</span> playdate.buttonIsPressed(playdate.kButtonDown) <span class="keyword">then</span>
        goalY += moveSpeed
    <span class="keyword">elseif</span> playdate.buttonIsPressed(playdate.kButtonLeft) <span class="keyword">then</span>
        goalX -= moveSpeed
    <span class="keyword">elseif</span> playdate.buttonIsPressed(playdate.kButtonRight) <span class="keyword">then</span>
        goalX += moveSpeed
    <span class="keyword">end</span>

    <span class="comment">-- Remember to use :moveWithCollisions(), and not :moveTo() or :moveBy(), or collisions won't happen!</span>
    <span class="comment">-- To do a &quot;moveBy&quot; operation, sprite:moveBy(5, 5) == sprite:moveWithCollisions(sprite.x + 5, sprite.y + 5)</span>
    <span class="keyword">local</span> <span class="local-variable">actualX</span>, <span class="local-variable">actualY</span>, <span class="local-variable">collisions</span>, <span class="local-variable">numberOfCollisions</span> = playerSprite:moveWithCollisions(goalX, goalY)

    <span class="comment">-- If we get into this loop, there was a collision</span>
    <span class="keyword">for</span> i=<span class="integer">1</span>, numberOfCollisions <span class="keyword">do</span>
        <span class="comment">-- This is getting data about one of things we're currently colliding with. Since we could</span>
        <span class="comment">-- be colliding with multiple things at once, we have to handle each collision individually</span>
        <span class="keyword">local</span> <span class="local-variable">collision</span> = collisions[i]

        <span class="comment">-- Always prints 'true', as the sprite property is the sprite being moved (in this case, the player)</span>
        <span class="predefined">print</span>(collision.sprite == playerSprite)
        <span class="comment">-- Also prints 'true', as we set the tag on the player sprite to the player tag</span>
        <span class="predefined">print</span>(collision.sprite:getTag() == TAGS.player)

        <span class="comment">-- This gets the actual sprite object we're colliding with</span>
        <span class="keyword">local</span> <span class="local-variable">collidedSprite</span> = collision.other
        <span class="keyword">local</span> <span class="local-variable">collisionTag</span> = collidedSprite:getTag()
        <span class="comment">-- Since we set a tag on the obstacle, we can check if we're colliding with that</span>
        <span class="keyword">if</span> collisionTag == TAGS.obstacle <span class="keyword">then</span>
            <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Collided with an obstacle!</span><span class="delimiter">&quot;</span></span>)

            <span class="comment">-- We can use the collision normal to check which side we collided with</span>
            <span class="keyword">local</span> <span class="local-variable">collisionNormal</span> = collision.normal
            <span class="keyword">if</span> collisionNormal.x == <span class="integer">-1</span> <span class="keyword">then</span>
                <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Touched left side!</span><span class="delimiter">&quot;</span></span>)
            <span class="keyword">elseif</span> collisionNormal.x == <span class="integer">1</span> <span class="keyword">then</span>
                <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Touched right side!</span><span class="delimiter">&quot;</span></span>)
            <span class="keyword">end</span>

            <span class="keyword">if</span> collisionNormal.y == <span class="integer">-1</span> <span class="keyword">then</span>
                <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Touched top!</span><span class="delimiter">&quot;</span></span>)
            <span class="keyword">elseif</span> collisionNormal.y == <span class="integer">1</span> <span class="keyword">then</span>
                <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Touched bottom!</span><span class="delimiter">&quot;</span></span>)
            <span class="keyword">end</span>
        <span class="comment">-- Handle some other collisions, like collecting a coin or a power up</span>
        <span class="keyword">elseif</span> collisionTag == TAGS.coin <span class="keyword">then</span>
            <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Coin collected!</span><span class="delimiter">&quot;</span></span>)
        <span class="keyword">elseif</span> collisionTag == TAGS.powerUp <span class="keyword">then</span>
            <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Powered up!</span><span class="delimiter">&quot;</span></span>)
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div id="m-graphics.sprite.checkCollisions" class="openblock item method">
<div class="title">playdate.graphics.sprite:checkCollisions(x, y) <br> playdate.graphics.sprite:checkCollisions(point)</div>
<div class="content">
<div class="paragraph">
<p>Returns the same values as <a href="#m-graphics.sprite.moveWithCollisions"><code>moveWithCollisions()</code></a> but does not actually move the sprite.</p>
</div>
</div>
</div>
<div id="c-graphics.sprite.collisionResponse" class="openblock item callback">
<div class="title">playdate.graphics.sprite:collisionResponse(other)</div>
<div class="content">
<div class="paragraph">
<p>A callback that can be defined on a sprite to control the type of collision response that should happen when a collision with <em>other</em> occurs. This callback should return one of the following four values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.sprite.kCollisionTypeSlide</em>: Use for collisions that should slide over other objects, like Super Mario does over a platform or the ground.</p>
</li>
<li>
<p><em>playdate.graphics.sprite.kCollisionTypeFreeze</em>: Use for collisions where the sprite should stop moving as soon as it collides with <em>other</em>, such as an arrow hitting a wall.</p>
</li>
<li>
<p><em>playdate.graphics.sprite.kCollisionTypeOverlap</em>: Use for collisions in which you want to know about the collision but it should not impact the movement of the sprite, such as when collecting a coin.</p>
</li>
<li>
<p><em>playdate.graphics.sprite.kCollisionTypeBounce</em>: Use when the sprite should move away from <em>other</em>, like the ball in Pong or Arkanoid.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The strings "slide", "freeze", "overlap", and "bounce" can be used instead of the constants.</p>
</div>
<div class="paragraph">
<p>Feel free to return different values based on the value of <em>other</em>. For example, if <em>other</em> is a wall sprite, you may want to return "slide" or "bounce", but if it&#8217;s a coin you might return "overlap".</p>
</div>
<div class="paragraph">
<p>If the callback is not present, or returns nil, <em>kCollisionTypeFreeze</em> is used.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Instead of defining a callback, the collisionResponse property of a sprite can be set directly to one of the four collision response types. This will be faster, as the lua function will not need to be called, but does not allow for dynamic behavior.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This method should not attempt to modify the sprites in any way. While it might be tempting to deal with collisions here, doing so will have unexpected and undesirable results. Instead, this function should return one of the collision response values as quickly as possible. If sprites need to be modified as the result of a collision, do so elsewhere, such as by inspecting the list of collisions returned by <a href="#m-graphics.sprite.moveWithCollisions"><code>moveWithCollisions()</code></a>.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.querySpritesAtPoint" class="openblock item function">
<div class="title">playdate.graphics.sprite.querySpritesAtPoint(x, y) <br> playdate.graphics.sprite.querySpritesAtPoint(<a href="#C-geometry.point">p</a>)</div>
<div class="content">
<div class="paragraph">
<p>Returns all sprites with collision rects containing the point.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.querySpritesInRect" class="openblock item function">
<div class="title">playdate.graphics.sprite.querySpritesInRect(x, y, width, height) <br> playdate.graphics.sprite.querySpritesInRect(<a href="#C-geometry.rect">rect</a>)</div>
<div class="content">
<div class="paragraph">
<p>Returns all sprites with collision rects overlapping the rect.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.querySpritesAlongLine" class="openblock item function">
<div class="title">playdate.graphics.sprite.querySpritesAlongLine(x1, y1, x2, y2) <br> playdate.graphics.sprite.querySpritesAlongLine(<a href="#C-geometry.lineSegment">lineSegment</a>)</div>
<div class="content">
<div class="paragraph">
<p>Returns all sprites with collision rects intersecting the line segment.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.querySpriteInfoAlongLine" class="openblock item function">
<div class="title">playdate.graphics.sprite.querySpriteInfoAlongLine(x1, y1, x2, y2) <br> playdate.graphics.sprite.querySpriteInfoAlongLine(<a href="#C-geometry.lineSegment">lineSegment</a>)</div>
<div class="content">
<div class="paragraph">
<p>Similar to <em>querySpritesAlongLine()</em>, but instead of sprites returns an array of <em>collisionInfo</em> tables containing information about sprites intersecting the line segment, and <em>len</em>, which is the number of collisions found. If you don&#8217;t need this information, use <em>querySpritesAlongLine()</em> as it will be faster.</p>
</div>
<div class="paragraph">
<p>Each <em>collisionInfo</em> table contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>sprite</em>: the sprite being intersected by the segment.</p>
</li>
<li>
<p><em>entryPoint</em>: a <a href="#C-geometry.point"><code>point</code></a> representing the coordinates of the first intersection between <code>sprite</code> and the line segment.</p>
</li>
<li>
<p><em>exitPoint</em>: a <a href="#C-geometry.point"><code>point</code></a> representing  the coordinates of the second intersection between <code>sprite</code> and the line segment.</p>
</li>
<li>
<p><em>ti1</em> &amp; <em>ti2</em>: numbers between 0 and 1 which indicate how far from the starting point of the line segment the collision happened; t1 for the entry point, t2 for the exit point. This can be useful for things like having a laser cause more damage if the impact is close.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_sprites_in_tilemap_based_games">Sprites in tilemap-based games</h5>
<div class="paragraph">
<p>For tile-based games, the built-in tilemap library has a convenience function called <a href="#m-graphics.tilemap.getCollisionRects">getCollisionRects()</a>, which will generate from the tilemap an array of rectangles suitable for use with the collision system to define walls and other impassable regions.</p>
</div>
<div id="f-graphics.sprite.addEmptyCollisionSprite" class="openblock item function">
<div class="title">playdate.graphics.sprite.addEmptyCollisionSprite(r) <br> playdate.graphics.sprite.addEmptyCollisionSprite(x, y, w, h)</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/sprites</em> to use this function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This convenience function adds an invisible sprite defined by the rectangle <em>x</em>, <em>y</em>, <em>w</em>, <em>h</em> (or the <a href="#C-geometry.rect">playdate.geometry.rect</a> <em>r</em>) for the purpose of triggering collisions.  This is useful for making areas impassable, triggering an event when a sprite enters a certain area, and so on.</p>
</div>
</div>
</div>
<div id="f-graphics.sprite.addWallSprites" class="openblock item function">
<div class="title">playdate.graphics.sprite.addWallSprites(tilemap, emptyIDs, [xOffset, yOffset])</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/sprites</em> to use this function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This convenience function automatically adds empty collision sprites necessary to restrict movement within a tilemap.</p>
</div>
<div class="paragraph">
<p><em>tilemap</em> is a <a href="#C-graphics.tilemap">playdate.graphics.tilemap</a>.</p>
</div>
<div class="paragraph">
<p><em>emptyIDs</em> is an array of tile IDs that should be considered "passable"&#8201;&#8212;&#8201;in other words, not walls. Tiles with default IDs of 0 are treated as passable by default, so you do not need to include 0 in the array.</p>
</div>
<div class="paragraph">
<p><em>xOffset, yOffset</em> optionally indicate the distance the new sprites should be offset from (0,0).</p>
</div>
<div class="paragraph">
<p>Returns an array-style table of the newly created sprites.</p>
</div>
<div class="paragraph">
<p>Calling this function is effectively a shortcut for calling <a href="#m-graphics.tilemap.getCollisionRects">playdate.graphics.tilemap:getCollisionRects()</a> and passing the resulting rects to <a href="#f-graphics.sprite.addEmptyCollisionSprite">addEmptyCollisionSprite()</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_text">Text</h4>
<div class="sect4 class">
<h5 id="C-graphics.font">Fonts</h5>
<div class="paragraph">
<p>Playdate fonts are <a href="#C-graphics.font">playdate.graphics.font</a> objects, loaded into Lua with the <a href="#f-graphics.font.new">playdate.graphics.font.new(path)</a> function and drawn on screen using <a href="#f-graphics.drawText">playdate.graphics.drawText(text, x, y)</a>.</p>
</div>
<div class="paragraph">
<p>The compiler can create a font from a standalone .fnt file with embedded image data or by combining a dependent .fnt file with a related image table. For example, if a dependent .fnt file is named awesomefont.fnt then the related image table would be named awesomefont-table-9-12.png</p>
</div>
<div class="paragraph">
<p>Standalone .fnt files can be created with the <a href="https://play.date/caps/"><em>Playdate Caps</em></a> web app from scratch or from a dependent .fnt file and image table pair.</p>
</div>
<div class="paragraph">
<p>At its simplest, a dependent .fnt file contains one line per glyph. Each line contains the glyph (the space character is indicted with the text "space"), in the order the glyph appears in the image table, and the width of the glyph, separated by any amount of whitespace. Unicode <em>U+xxxx</em> format is supported for glyph names.</p>
</div>
<div class="literalblock">
<div class="title">Sample .fnt file excerpt</div>
<div class="content">
<pre>space	6
!		2
"		4
#		7</pre>
</div>
</div>
<div class="paragraph">
<p>Blank lines are ignored. Comments begin with two dashes.</p>
</div>
<div class="literalblock">
<div class="title">Sample .fnt file excerpt</div>
<div class="content">
<pre>$		6
%		8
-- this comment will be ignored, as will any blank lines
&amp;		7</pre>
</div>
</div>
<div class="paragraph">
<p>An optional, default tracking value can be specified on its own line like so:</p>
</div>
<div class="literalblock">
<div class="title">Sample .fnt file excerpt</div>
<div class="content">
<pre>tracking = 2</pre>
</div>
</div>
<div class="paragraph">
<p>The tracking value is the number of pixels of whitespace between each character drawn in a string.</p>
</div>
<div class="paragraph">
<p>Kerning pairs are supported, one line per pair. Each line contains the two character pair, and the offset, separated by any amount of whitespace.</p>
</div>
<div class="literalblock">
<div class="title">Sample .fnt file excerpt</div>
<div class="content">
<pre>To		-2
ll		3
bU+20	-1</pre>
</div>
</div>
<div class="paragraph">
<p>A standalone .fnt file must contain these additional properties to compile correctly. (While a standalone .fnt file can be authored manually, most will be created with <em>Playdate Caps</em>. This informataion is included here for thoroughness.)</p>
</div>
<div class="paragraph">
<p>Embedding a font&#8217;s pixel data requires 4 additional properties: the string length of the base64-encoded image table data as <code>datalen</code>, a base64-encoded image table as <code>data</code>, and the pixel dimensions of each uniform cell in the image table as <code>width</code>, and <code>height</code>.</p>
</div>
<div class="literalblock">
<div class="title">Sample standalone .fnt file excerpt</div>
<div class="content">
<pre>datalen=8984
data=iVBO...YII=
width=8
height=12</pre>
</div>
</div>
<div class="paragraph">
<p><em>Playdate Caps</em> will also embed some metrics used for authoring as a JSON object in a comment.</p>
</div>
<div class="literalblock">
<div class="title">Sample standalone .fnt file excerpt</div>
<div class="content">
<pre>--metrics={"baseline":17,"xHeight":6,"capHeight":2}</pre>
</div>
</div>
<div class="sect5">
<h6 id="_supported_characters">Supported characters</h6>
<div class="paragraph">
<p>Playdate supports all code points in the first four Unicode planes, up to U+3FFFF.</p>
</div>
<div class="paragraph">
<p>If a replacement character is specified it will be drawn in place of any missing characters in your font. If it is not, characters missing from the font will be drawn using the system font, if available.</p>
</div>
</div>
<div class="sect5">
<h6 id="_variants">Variants</h6>
<div class="paragraph">
<p>In order to support formatting and localization, Playdate allows you to set up to three font files as variants: normal, bold, and italic.</p>
</div>
</div>
<div class="sect5">
<h6 id="_font_class_functions">Font class functions</h6>
<div id="f-graphics.font.new" class="openblock item function">
<div class="title">playdate.graphics.font.new(path)</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-graphics.font">playdate.graphics.font</a> object from the data at <em>path</em>. If there is no file at <em>path</em>, the function returns nil.</p>
</div>
</div>
</div>
<div id="f-graphics.font.newFamily" class="openblock item function">
<div class="title">playdate.graphics.font.newFamily(fontPaths)</div>
<div class="content">
<div class="paragraph">
<p>Returns a font family table from the font files specified in <em>fontPaths</em>. <em>fontPaths</em> should be a table with the following format:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>local fontPaths = {
 [playdate.graphics.font.kVariantNormal] = "path/to/normalFont",
    [playdate.graphics.font.kVariantBold] = "path/to/boldFont",
    [playdate.graphics.font.kVariantItalic] = "path/to/italicFont"
}</pre>
</div>
</div>
<div class="paragraph">
<p>The table returned is of the same format with font objects in place of the paths, and is appropriate to pass to the functions <a href="#f-graphics.setFontFamily">setFontFamily()</a> and <a href="#f-graphics.getTextSize">getTextSize()</a>.</p>
</div>
</div>
</div>
<div id="f-graphics.setFont" class="openblock item function xref">
<div class="title">playdate.graphics.setFont(font, [variant])</div>
<div class="content">
<div class="paragraph">
<p>Sets the current font, a <a href="#C-graphics.font">playdate.graphics.font</a>.</p>
</div>
<div class="paragraph">
<p><em>variant</em> should be one of the strings "normal", "bold", or "italic", or one of the constants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.font.kVariantNormal</em></p>
</li>
<li>
<p><em>playdate.graphics.font.kVariantBold</em></p>
</li>
<li>
<p><em>playdate.graphics.font.kVariantItalic</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If no variant is specified, <em>kFontVariantNormal</em> is used.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.setFont"><code>playdate-&gt;graphics-&gt;setFont()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-graphics.getFont" class="openblock item function">
<div class="title">playdate.graphics.getFont([variant])</div>
<div class="content">
<div class="paragraph">
<p>Returns the current font, a <a href="#C-graphics.font">playdate.graphics.font</a>.</p>
</div>
</div>
</div>
<div id="f-graphics.setFontFamily" class="openblock item function">
<div class="title">playdate.graphics.setFontFamily(fontFamily)</div>
<div class="content">
<div class="paragraph">
<p>Sets multiple font variants at once. <code>fontFamily</code> should be a table using the following format:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>local fontFamily = {
 [playdate.graphics.font.kVariantNormal] = normal_font,
    [playdate.graphics.font.kVariantBold] = bold_font,
    [playdate.graphics.font.kVariantItalic] = italic_font
}</pre>
</div>
</div>
<div class="paragraph">
<p>All fonts and font variants need not be present in the table.</p>
</div>
</div>
</div>
<div id="f-graphics.setFontTracking" class="openblock item function">
<div class="title">playdate.graphics.setFontTracking(pixels)</div>
<div class="content">
<div class="paragraph">
<p>Sets the global font tracking (spacing between letters) in pixels. This value is added to the font&#8217;s own tracking value as specified in its .fnt file.</p>
</div>
<div class="paragraph">
<p>See <a href="#m-graphics.font.setTracking">playdate.graphics.font:setTracking</a> to adjust tracking on a specific font.</p>
</div>
</div>
</div>
<div id="f-graphics.getFontTracking" class="openblock item function">
<div class="title">playdate.graphics.getFontTracking()</div>
<div class="content">
<div class="paragraph">
<p>Gets the global font tracking (spacing between letters) in pixels.</p>
</div>
</div>
</div>
<div id="f-graphics.getSystemFont" class="openblock item function">
<div class="title">playdate.graphics.getSystemFont([variant])</div>
<div class="content">
<div class="paragraph">
<p>Like <a href="#f-graphics.getFont">getFont()</a> but returns the system font rather than the currently set font.</p>
</div>
<div class="paragraph">
<p><em>variant</em> should be one of the strings "normal", "bold", or "italic", or one of the constants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.font.kVariantNormal</em></p>
</li>
<li>
<p><em>playdate.graphics.font.kVariantBold</em></p>
</li>
<li>
<p><em>playdate.graphics.font.kVariantItalic</em></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_font_instance_functions">Font instance functions</h6>
<div id="m-graphics.font.drawText" class="openblock item method">
<div class="title">playdate.graphics.font:drawText(text, x, y, [width, height], [leadingAdjustment], [wrapMode], [alignment]) <br> playdate.graphics.font:drawText(text, rect, [leadingAdjustment], [wrapMode], [alignment])</div>
<div class="content">
<div class="paragraph">
<p>Draws a string at the specified <em>x, y</em> coordinate using this particular font instance. (Compare to <a href="#f-graphics.drawText">playdate.graphics.drawText(text, x, y)</a>, which draws the string with whatever the "current font" is, as defined by <a href="#f-graphics.setFont">playdate.graphics.setFont(font)</a>).</p>
</div>
<div class="paragraph">
<p>If <em>width</em> and <em>height</em> are specified, drawing is constrained to the rectangle <code>(x,y,width,height)</code>, using the given <code>wrapMode</code> and <code>alignment</code> if provided. Alternatively, a <a href="#C-geometry.rect"><code>playdate.geometry.rect</code></a> object can be passed instead of <code>x,y,width,height</code>. Valid values for <em>wrapMode</em> are</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kWrapClip</em></p>
</li>
<li>
<p><em>playdate.graphics.kWrapCharacter</em></p>
</li>
<li>
<p><em>playdate.graphics.kWrapWord</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and values for <em>alignment</em> are</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kAlignLeft</em></p>
</li>
<li>
<p><em>playdate.graphics.kAlignCenter</em></p>
</li>
<li>
<p><em>playdate.graphics.kAlignRight</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The default wrap mode is <code>playdate.graphics.kWrapWord</code> and the default alignment is <code>playdate.graphics.kAlignLeft</code>.</p>
</div>
<div class="paragraph">
<p>The optional <em>leadingAdjustment</em> may be used to modify the spacing between lines of text.</p>
</div>
<div class="paragraph">
<p>The function returns two numbers indicating the width and height of the drawn text.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>font:drawText()</code> does not support inline styles like bold and italics. Instead use <a href="#f-graphics.drawText">playdate.graphics.drawText()</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-graphics.font.drawTextAligned" class="openblock item method">
<div class="title">playdate.graphics.font:drawTextAligned(text, x, y, alignment, [leadingAdjustment])</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/graphics</em> to use this function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Draws the string <em>text</em> aligned to the left, right, or centered on the <em>x</em> coordinate. Pass one of <em>kTextAlignment.left</em>, <em>kTextAlignment.center</em>, <em>kTextAlignment.right</em> for the <em>alignment</em> parameter. (Compare to <a href="#f-graphics.drawTextAligned">playdate.graphics.drawTextAligned(text, x, y, alignment)</a>, which draws the string with the "current font", as defined by <a href="#f-graphics.setFont">playdate.graphics.setFont(font)</a>).</p>
</div>
</div>
</div>
<div id="m-graphics.font.getHeight" class="openblock item method">
<div class="title">playdate.graphics.font:getHeight()</div>
<div class="content">
<div class="paragraph">
<p>Returns the pixel height of this font.</p>
</div>
</div>
</div>
<div id="m-graphics.font.getTextWidth" class="openblock item method">
<div class="title">playdate.graphics.font:getTextWidth(text)</div>
<div class="content">
<div class="paragraph">
<p>Returns the pixel width of the text when rendered with this font.</p>
</div>
</div>
</div>
<div id="m-graphics.font.setTracking" class="openblock item method xref">
<div class="title">playdate.graphics.font:setTracking(pixels)</div>
<div class="content">
<div class="paragraph">
<p>Sets the tracking of this font (spacing between letters), in pixels.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.setTextTracking"><code>playdate-&gt;graphics-&gt;setTextTracking()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="m-graphics.font.getTracking" class="openblock item method">
<div class="title">playdate.graphics.font:getTracking()</div>
<div class="content">
<div class="paragraph">
<p>Returns the tracking of this font (spacing between letters), in pixels.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.getTextTracking"><code>playdate-&gt;graphics-&gt;getTextTracking()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="m-graphics.font.setLeading" class="openblock item method xref">
<div class="title">playdate.graphics.font:setLeading(pixels)</div>
<div class="content">
<div class="paragraph">
<p>Sets the leading (spacing between lines) of this font, in pixels.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.setTextLeading"><code>playdate-&gt;graphics-&gt;setTextLeading()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="m-graphics.font.getLeading" class="openblock item method">
<div class="title">playdate.graphics.font:getLeading()</div>
<div class="content">
<div class="paragraph">
<p>Returns the leading (spacing between lines) of this font, in pixels.</p>
</div>
</div>
</div>
<div id="m-graphics.font.getGlyph" class="openblock item method">
<div class="title">playdate.graphics.font:getGlyph(character)</div>
<div class="content">
<div class="paragraph">
<p>Returns the <a href="#C-graphics.image"><code>playdate.graphics.image</code></a> containing the requested glyph. <em>character</em> can either be a string or a unicode codepoint number.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_drawing_text">Drawing Text</h5>
<div id="f-graphics.drawText" class="openblock item function xref">
<div class="title">playdate.graphics.drawText(text, x, y, [width, height], [fontFamily], [leadingAdjustment], [wrapMode], [alignment]) <br> playdate.graphics.drawText(text, rect, [fontFamily], [leadingAdjustment], [wrapMode], [alignment])</div>
<div class="content">
<div class="paragraph">
<p>Draws the text using the current font and font advance at location (<em>x</em>, <em>y</em>). If <em>width</em> and <em>height</em> are specified, drawing is constrained to the rectangle <code>(x,y,width,height)</code>, using the given <em>wrapMode</em> and <em>alignment</em>, if provided. Alternatively, a <a href="#C-geometry.rect"><code>playdate.geometry.rect</code></a> object can be passed instead of <code>x,y,width,height</code>. Valid values for <em>wrapMode</em> are</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kWrapClip</em></p>
</li>
<li>
<p><em>playdate.graphics.kWrapCharacter</em></p>
</li>
<li>
<p><em>playdate.graphics.kWrapWord</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and values for <em>alignment</em> are</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.kAlignLeft</em></p>
</li>
<li>
<p><em>playdate.graphics.kAlignCenter</em></p>
</li>
<li>
<p><em>playdate.graphics.kAlignRight</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The default wrap mode is <code>playdate.graphics.kWrapWord</code> and the default alignment is <code>playdate.graphics.kAlignLeft</code>.</p>
</div>
<div class="paragraph">
<p>If <em>fontFamily</em> is provided, the text is draw using the given fonts instead of the currently set font. <em>fontFamily</em> should be a table of fonts using keys as specified in <a href="#f-graphics.setFontFamily">setFontFamily(fontFamily)</a>.</p>
</div>
<div class="paragraph">
<p>The optional <em>leadingAdjustment</em> may be used to modify the spacing between lines of text. Pass nil to use the default leading for the font.</p>
</div>
<div class="paragraph">
<p>Returns two numbers indicating the width and height of the drawn text.</p>
</div>
<div class="paragraph">
<p><strong>Styling text</strong></p>
</div>
<div class="paragraph">
<p>To draw bold text, surround the bold portion of text with asterisks. To draw italic text, surround the italic portion of text with underscores. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>playdate.graphics.drawText("normal *bold* _italic_", x, y)</pre>
</div>
</div>
<div class="paragraph">
<p>which will output: "normal <strong>bold</strong> <em>italic</em>". Bold and italic font variations must be set using <a href="#f-graphics.setFont">setFont()</a> with the appropriate variant argument, otherwise the default Playdate fonts will be used.</p>
</div>
<div class="paragraph">
<p><strong>Escaping styling characters</strong></p>
</div>
<div class="paragraph">
<p>To draw an asterisk or underscore, use a double-asterisk or double-underscore. Styles may not be nested, but double-characters can be used inside of a styled portion of text.</p>
</div>
<div class="paragraph">
<p>For a complete set of characters allowed in <em>text</em>, see <a href="#C-graphics.font">playdate.graphics.font</a>. In addition, the newline character <code>\n</code> is allowed and works as expected.</p>
</div>
<div class="paragraph">
<p><strong>Avoiding styling</strong></p>
</div>
<div class="paragraph">
<p>Use <a href="#m-graphics.font.drawText">playdate.graphics.font:drawText()</a>, which doesn&#8217;t support formatted text.</p>
</div>
<div class="paragraph">
<p><strong>Inverting text color</strong></p>
</div>
<div class="paragraph">
<p>To draw white-on-black text (assuming the font you are using is defined in the standard black-on-transparent manner), first call <a href="#f-graphics.setImageDrawMode">playdate.graphics.setImageDrawMode(playdate.graphics.kDrawModeFillWhite)</a>, followed by the appropriate drawText() call. setImageDrawMode() affects how text is rendered because characters are technically images.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-graphics.drawText"><code>playdate-&gt;graphics-&gt;drawText()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-graphics.drawLocalizedText" class="openblock item function">
<div class="title">playdate.graphics.drawLocalizedText(key, x, y, [width, height], [language], [leadingAdjustment], [wrapMode], [alignment]) <br> playdate.graphics.drawLocalizedText(key, rect, [language], [leadingAdjustment])</div>
<div class="content">
<div class="paragraph">
<p>Draws the text found by doing a lookup of <em>key</em> in the .strings file corresponding to the current system language, or <em>language</em>, if specified.</p>
</div>
<div class="paragraph">
<p>The optional <em>language</em> argument can be one of the strings "en", "jp", or one of the constants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.font.kLanguageEnglish</em></p>
</li>
<li>
<p><em>playdate.graphics.font.kLanguageJapanese</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Other arguments work the same as in <a href="#f-graphics.drawText"><code>drawText()</code></a>.</p>
</div>
<div class="paragraph">
<p>For more information about localization and strings files, see the <a href="#localization">Localization</a> section.</p>
</div>
</div>
</div>
<div id="f-graphics.getLocalizedText" class="openblock item function">
<div class="title">playdate.graphics.getLocalizedText(key, [language])</div>
<div class="content">
<div class="paragraph">
<p>Returns a string found by doing a lookup of <em>key</em> in the .strings file corresponding to the current system language, or <em>language</em>, if specified.</p>
</div>
<div class="paragraph">
<p>The optional <em>language</em> argument can be one of the strings "en", "jp", or one of the constants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.graphics.font.kLanguageEnglish</em></p>
</li>
<li>
<p><em>playdate.graphics.font.kLanguageJapanese</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about localization and strings files, see the <a href="#localization">Localization</a> section.</p>
</div>
</div>
</div>
<div id="f-graphics.getTextSize" class="openblock item function">
<div class="title">playdate.graphics.getTextSize(str, [fontFamily, [leadingAdjustment]])</div>
<div class="content">
<div class="paragraph">
<p>Returns multiple values <em>(width, height)</em> giving the dimensions required to draw the text <em>str</em> using <a href="#f-graphics.drawText">drawText()</a>. Newline characters (<code>\n</code>) are respected.</p>
</div>
<div class="paragraph">
<p><em>fontFamily</em> should be a table of fonts using keys as specified in <a href="#f-graphics.setFontFamily">setFontFamily(fontFamily)</a>. If provided, fonts from <em>fontFamily</em> will be used for calculating the size of <em>str</em> instead of the currently set font.</p>
</div>
</div>
</div>
<div id="f-graphics.drawTextAligned" class="openblock item function">
<div class="title">playdate.graphics.drawTextAligned(text, x, y, alignment, [leadingAdjustment])</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/graphics</em> to use this function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Draws the string <em>text</em> aligned to the left, right, or centered on the <em>x</em> coordinate. Pass one of <em>kTextAlignment.left</em>, <em>kTextAlignment.center</em>, <em>kTextAlignment.right</em> for the <em>alignment</em> parameter.</p>
</div>
<div class="paragraph">
<p>For text formatting options, see <a href="#f-graphics.drawText">drawText()</a></p>
</div>
<div class="paragraph">
<p>To draw unstyled text using a single font, see <a href="#m-graphics.font.drawTextAligned">playdate.graphics.font:drawTextAligned()</a></p>
</div>
</div>
</div>
<div id="f-graphics.drawTextInRect" class="openblock item function">
<div class="title">playdate.graphics.drawTextInRect(text, x, y, width, height, [leadingAdjustment, [truncationString, [alignment, [font]]]]) <br> playdate.graphics.drawTextInRect(text, rect, [leadingAdjustment, [truncationString, [alignment, [font]]]])</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/graphics</em> to use these functions.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Draws the text using the current font and font advance into the rect defined by (<code><em>x</em></code>, <code><em>y</em></code>, <code><em>width</em></code>, <code><em>height</em></code>) (or <code><em>rect</em></code>).</p>
</div>
<div class="paragraph">
<p>If <code><em>truncationString</em></code> is provided and the text cannot fit in the rect, <code><em>truncationString</em></code> will be appended to the last line.</p>
</div>
<div class="paragraph">
<p><code><em>alignment</em></code>, if provided, should be one of one of <code><em>kTextAlignment.left</em></code>, <code><em>kTextAlignment.center</em></code>, <code><em>kTextAlignment.right</em></code>. Pass <code>nil</code> for <code><em>leadingAdjustment</em></code> and <code><em>truncationString</em></code> if those parameters are not required.</p>
</div>
<div class="paragraph">
<p><code><em>font</em></code>, if provided, will cause the text to be drawn unstyled using <a href="#m-graphics.font.drawText">font:drawText()</a> rather than <a href="#f-graphics.drawText">playdate.graphics.drawText()</a> using the currently-set system fonts.</p>
</div>
<div class="paragraph">
<p>For text formatting options, see <a href="#f-graphics.drawText">drawText()</a></p>
</div>
<div class="paragraph">
<p>Returns <code><em>width</em></code>, <code><em>height</em></code>, <code><em>textWasTruncated</em></code></p>
</div>
<div class="paragraph">
<p><code><em>width</em></code> and <code><em>height</em></code> indicate the size in pixels of the drawn text. These values may be smaller than the width and height specified when calling the function.</p>
</div>
<div class="paragraph">
<p><code><em>textWasTruncated</em></code> indicates if the text was truncated to fit within the specified rect.</p>
</div>
</div>
</div>
<div id="f-graphics.drawLocalizedTextAligned" class="openblock item function">
<div class="title">playdate.graphics.drawLocalizedTextAligned(text, x, y, alignment, [language, [leadingAdjustment]])</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/graphics</em> to use this function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Same as <a href="#f-graphics.drawTextAligned">drawTextAligned()</a> except localized text is drawn.</p>
</div>
</div>
</div>
<div id="f-graphics.drawLocalizedTextInRect" class="openblock item function">
<div class="title">playdate.graphics.drawLocalizedTextInRect(text, x, y, width, height, [leadingAdjustment, [truncationString, [alignment, [font, [language]]]]]) <br> playdate.graphics.drawLocalizedTextInRect(text, rect, [leadingAdjustment, [truncationString, [alignment, [font, [language]]]]])</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/graphics</em> to use these functions.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Same as <a href="#f-graphics.drawTextInRect">drawTextInRect()</a> except localized text is drawn.</p>
</div>
</div>
</div>
<div id="f-graphics.getTextSizeForMaxWidth" class="openblock item function">
<div class="title">playdate.graphics.getTextSizeForMaxWidth(text, maxWidth, [leadingAdjustment, [font]]])</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/graphics</em> to use this function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Returns <code><em>width</em></code>, <code><em>height</em></code> which indicate the minimum size required for <code><em>text</em></code> to be drawn using <a href="#f-graphics.drawTextInRect">drawTextInRect()</a>. The <code><em>width</em></code> returned will be less than or equal to <code><em>maxWidth</em></code>.</p>
</div>
<div class="paragraph">
<p><code><em>font</em></code>, if provided, will cause the text size to be calculated without bold or italic styling using the specified font.</p>
</div>
</div>
</div>
<div id="f-graphics.imageWithText" class="openblock item function">
<div class="title">playdate.graphics.imageWithText(text, maxWidth, maxHeight, [backgroundColor, [leadingAdjustment, [truncationString, [alignment, [font]]]]])</div>
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/graphics</em> to use this function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Generates an image containing <code><em>text</em></code>. This is useful if you need to redraw the same text frequently.</p>
</div>
<div class="paragraph">
<p><code><em>maxWidth</em></code> and <code><em>maxHeight</em></code> specify the maximum size of the returned image.</p>
</div>
<div class="paragraph">
<p><code><em>backgroundColor</em></code>, if specified, will cause the image&#8217;s background to be one of <em>playdate.graphics.kColorWhite</em>, <em>playdate.graphics.kColorBlack</em>, or <em>playdate.graphics.kColorClear</em>.</p>
</div>
<div class="paragraph">
<p><code><em>font</em></code>, if provided, will cause the text to be drawn without bold or italic styling using the specified font.</p>
</div>
<div class="paragraph">
<p>The remaining arguments are the same as those in <a href="#f-graphics.drawTextInRect">drawTextInRect()</a>.</p>
</div>
<div class="paragraph">
<p>Returns <code><em>image</em></code>, <code><em>textWasTruncated</em></code></p>
</div>
<div class="paragraph">
<p><code><em>image</em></code> is a newly-created image containing the specified text, or nil if an image could not be created. The image&#8217;s dimensions may be smaller than <code><em>maxWidth</em></code>, <code><em>maxHeight</em></code>.</p>
</div>
<div class="paragraph">
<p><code><em>textWasTruncated</em></code> indicates if the text was truncated to fit within the specified width and height.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-graphics.video">Video</h4>
<div class="paragraph">
<p>The video player renders frames from a pdv file into an image or directly to the screen. Note that the renderer expects to have ownership of the data in its drawing context, whether it&#8217;s the screen or a separate image. Drawing over the video frames in the render context can cause the image to become garbled. If you want to use drawing functions on top of the video, create a context image for the video to render to (calling video:getContext() will create the image), call video:renderFrame(), then draw the context image to the screen, then draw on top of that. The pdv file does not (currently) contain audio, so typically you&#8217;d play the audio in a fileplayer or sampleplayer and use the current audio offset to determine which video frame to display.</p>
</div>
<div class="paragraph">
<p>A minimal video player:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">disp</span> = playdate.display
<span class="keyword">local</span> <span class="local-variable">gfx</span> = playdate.graphics
<span class="keyword">local</span> <span class="local-variable">snd</span> = playdate.sound

disp.setRefreshRate(<span class="integer">0</span>)

<span class="keyword">local</span> <span class="local-variable">video</span> = gfx.video.new(<span class="string"><span class="delimiter">'</span><span class="content">movie</span><span class="delimiter">'</span></span>)
video:useScreenContext()
video:renderFrame(<span class="integer">0</span>)

<span class="keyword">local</span> <span class="local-variable">lastframe</span> = <span class="integer">0</span>

<span class="keyword">local</span> <span class="local-variable">audio</span>, <span class="local-variable">loaderr</span> = snd.sampleplayer.new(<span class="string"><span class="delimiter">'</span><span class="content">movie</span><span class="delimiter">'</span></span>)

<span class="keyword">if</span> audio ~= <span class="predefined-constant">nil</span> <span class="keyword">then</span>
        audio:play(<span class="integer">0</span>)
<span class="keyword">else</span>
        <span class="predefined">print</span>(loaderr)
<span class="keyword">end</span>

<span class="keyword">function</span> playdate.<span class="function">update</span>()

        <span class="keyword">local</span> <span class="local-variable">frame</span> = math.floor(audio:getOffset() * video:getFrameRate())

        <span class="keyword">if</span> frame ~= lastframe <span class="keyword">then</span>
                video:renderFrame(frame)
                lastframe = frame
        <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div id="f-graphics.video.new" class="openblock item function">
<div class="title">playdate.graphics.video.new(path)</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-graphics.video">playdate.graphics.video</a> object from the pdv file at <em>path</em>. If the file at <em>path</em> can&#8217;t be opened, the function returns nil.</p>
</div>
</div>
</div>
<div id="m-graphics.video.getSize" class="openblock item method">
<div class="title">playdate.graphics.video:getSize()</div>
<div class="content">
<div class="paragraph">
<p>Returns the width and height of the video as multiple vlaues (<em>width</em>, <em>height</em>).</p>
</div>
</div>
</div>
<div id="m-graphics.video.getFrameCount" class="openblock item method">
<div class="title">playdate.graphics.video:getFrameCount()</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of frames in the video.</p>
</div>
</div>
</div>
<div id="m-graphics.video.getFrameRate" class="openblock item method">
<div class="title">playdate.graphics.video:getFrameRate()</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of frames per second of the video source. This number is simply for record-keeping, it is not used internally&#8212;&#8203;the game code is responsible for figuring out which frame to show when.</p>
</div>
</div>
</div>
<div id="m-graphics.video.setContext" class="openblock item method">
<div class="title">playdate.graphics.video:setContext(image)</div>
<div class="content">
<div class="paragraph">
<p>Sets the given image to the video render context. Future <code>video:renderFrame()</code> calls will draw into this image.</p>
</div>
</div>
</div>
<div id="m-graphics.video.getContext" class="openblock item method">
<div class="title">playdate.graphics.video:getContext()</div>
<div class="content">
<div class="paragraph">
<p>Returns the image into which the video will be rendered, creating it if needed.</p>
</div>
</div>
</div>
<div id="m-graphics.video.useScreenContext" class="openblock item method">
<div class="title">playdate.graphics.video:useScreenContext()</div>
<div class="content">
<div class="paragraph">
<p>Sets the display framebuffer as the video&#8217;s render context.</p>
</div>
</div>
</div>
<div id="m-graphics.video.renderFrame" class="openblock item method">
<div class="title">playdate.graphics.video:renderFrame(number)</div>
<div class="content">
<div class="paragraph">
<p>Draws the given frame into the video&#8217;s render context.</p>
</div>
</div>
</div>
<div id="m-graphics.video.getCurrentFrame" class="openblock item method">
<div class="title">playdate.graphics.video:getCurrentFrame()</div>
<div class="content">
<div class="paragraph">
<p>Returns the frame number of the currently displayed frame.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-json">7.21. JSON</h3>
<div class="paragraph">
<p>Provides encoding and decoding of JSON files and strings.</p>
</div>
<div id="f-json.decode" class="openblock item function xref">
<div class="title">json.decode(string)</div>
<div class="content">
<div class="paragraph">
<p>Takes the JSON encoded string and converts it to a Lua table.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-json.decode"><code>playdate-&gt;json-&gt;decode()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-json.decodeFile" class="openblock item function">
<div class="title">json.decodeFile(file) <br> json.decodeFile(path)</div>
<div class="content">
<div class="paragraph">
<p>Reads the given <a href="#M-file">playdate.file.file</a> object or the file at the given <code>path</code> and converts it to a Lua table.</p>
</div>
</div>
</div>
<div id="f-json.encode" class="openblock item function">
<div class="title">json.encode(table)</div>
<div class="content">
<div class="paragraph">
<p>Returns a string containing the JSON representation of the passed-in Lua table.</p>
</div>
</div>
</div>
<div id="f-json.encodePretty" class="openblock item function">
<div class="title">json.encodePretty(table)</div>
<div class="content">
<div class="paragraph">
<p>Returns a string containing the JSON representation of a Lua table, with human-readable formatting.</p>
</div>
</div>
</div>
<div id="f-json.encodeToFile" class="openblock item function">
<div class="title">json.encodeToFile(file, [pretty], table) <br> json.encodeToFile(path, [pretty], table)</div>
<div class="content">
<div class="paragraph">
<p>Encodes the Lua table <code>table</code> to JSON and writes it to the given <a href="#M-file">playdate.file.file</a> object or the given <code>path</code>. If <code>pretty</code> is true, the output is formatted to make it human-readable. Otherwise, no additional whitespace is added.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
For a very simple way to serialize a table to a file, see <a href="#M-datastore">playdate.datastore</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-keyboard">7.22. Keyboard</h3>
<div class="paragraph">
<p>An on-screen keyboard that can be used for text entry.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/keyboard</em> to use these functions.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Keyboard is only designed to work at 1x display scale, and will not work well at other <a href="#f-display.setScale">scale factors</a>.
</td>
</tr>
</table>
</div>
<div id="f-keyboard.show" class="openblock item function">
<div class="title">playdate.keyboard.show([text])</div>
<div class="content">
<div class="paragraph">
<p>Opens the keyboard, taking over input focus.</p>
</div>
<div class="paragraph">
<p><em>text</em>, if provided, will be used to set the initial text value of the keyboard.</p>
</div>
</div>
</div>
<div id="m-keyboard.hide" class="openblock item method">
<div class="title">playdate.keyboard.hide()</div>
<div class="content">
<div class="paragraph">
<p>Hides the keyboard.</p>
</div>
</div>
</div>
<div id="v-keyboard.text" class="openblock item variable">
<div class="title">playdate.keyboard.text</div>
<div class="content">
<div class="paragraph">
<p>Access or set the text value of the keyboard.</p>
</div>
</div>
</div>
<div id="f-keyboard.setCapitalizationBehavior" class="openblock item function">
<div class="title">playdate.keyboard.setCapitalizationBehavior(behavior)</div>
<div class="content">
<div class="paragraph">
<p><em>behavior</em> should be one of the constants <em>playdate.keyboard.kCapitalizationNormal</em>, <em>playdate.keyboard.kCapitalizationWords</em>, or <em>playdate.keyboard.kCapitalizationSentences</em>.</p>
</div>
<div class="paragraph">
<p>In the case of <em>playdate.keyboard.kCapitalizationWords</em>, the keyboard selection will automatically move to the upper case column after a space is entered. For <em>playdate.keyboard.kCapitalizationSentences</em> the selection will automatically move to the upper case column after a period and a space have been entered.</p>
</div>
</div>
</div>
<div id="f-keyboard.left" class="openblock item function">
<div class="title">playdate.keyboard.left()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current x location of the left edge of the keyboard.</p>
</div>
</div>
</div>
<div id="f-keyboard.width" class="openblock item function">
<div class="title">playdate.keyboard.width()</div>
<div class="content">
<div class="paragraph">
<p>Returns the pixel width of the keyboard.</p>
</div>
</div>
</div>
<div id="f-keyboard.isVisible" class="openblock item function">
<div class="title">playdate.keyboard.isVisible()</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the keyboard is currently being shown.</p>
</div>
</div>
</div>
<div id="c-keyboard.keyboardDidShowCallback" class="openblock item callback">
<div class="title">playdate.keyboard.keyboardDidShowCallback</div>
<div class="content">
<div class="paragraph">
<p>If set, this function will be called when the keyboard is finished the opening animation.</p>
</div>
</div>
</div>
<div id="c-keyboard.keyboardDidHideCallback" class="openblock item callback">
<div class="title">playdate.keyboard.keyboardDidHideCallback</div>
<div class="content">
<div class="paragraph">
<p>If set, this function will be called when the keyboard has finished the hide animation.</p>
</div>
</div>
</div>
<div id="c-keyboard.keyboardWillHideCallback" class="openblock item callback">
<div class="title">playdate.keyboard.keyboardWillHideCallback</div>
<div class="content">
<div class="paragraph">
<p>If set, this function will be called when the keyboard starts to close. A Boolean argument will be passed to the callback, <code>true</code> if the user selected "OK" close the keyboard, <code>false</code> otherwise.</p>
</div>
</div>
</div>
<div id="c-keyboard.keyboardAnimatingCallback" class="openblock item callback">
<div class="title">playdate.keyboard.keyboardAnimatingCallback</div>
<div class="content">
<div class="paragraph">
<p>If set, this function is called as the keyboard animates open or closed. Provided as a way to sync animations with the keyboard movement.</p>
</div>
</div>
</div>
<div id="c-keyboard.textChangedCallback" class="openblock item callback">
<div class="title">playdate.keyboard.textChangedCallback</div>
<div class="content">
<div class="paragraph">
<p>If set, this function will be called every time a character is entered or deleted.</p>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-math">7.23. Math</h3>
<div id="f-math.lerp" class="openblock item function">
<div class="title">playdate.math.lerp(min, max, t)</div>
<div class="content">
<div class="paragraph">
<p>Returns a number that is the linear interpolation between <em>min</em> and <em>max</em> based on <em>t</em>, where <em>t = 0.0</em> will return <em>min</em> and <em>t = 1.0</em> will return <em>max</em>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/math</em> to use this function.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-network">7.24. Networking</h3>
<div class="paragraph">
<p>Playdate OS 2.7 adds support for both HTTP and TCP networking. Up to four simultaneous connections are possible.</p>
</div>
<div id="f-network.setEnabled" class="openblock item function">
<div class="title">playdate.network.setEnabled(flag, function)</div>
<div class="content">
<div class="paragraph">
<p>Playdate will connect to the configured access point automatically as needed and turn off the wifi radio after a 30 second idle timeout. This function allows a game to start connecting to the access point sooner, since that can take upwards of 10 seconds, or turn off wifi as soon as it&#8217;s no longer needed instead of waiting 30 seconds. If <code>flag</code> is true, a callback function can be provided to check for an error connecting to the access point; the argument passed to the callback is a string describing the error, or nil if no error occurred.</p>
</div>
</div>
</div>
<div id="f-network.getStatus" class="paragraph item function">
<div class="title">playdate.network.getStatus()</div>
<p>Returns one of the constants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.network.kStatusNotConnected</em> : Not connected to an AP</p>
</li>
<li>
<p><em>playdate.network.kStatusConnected</em> : Device is connected to an AP</p>
</li>
<li>
<p><em>playdate.network.kStatusNotAvailable</em> : No configured AP is available</p>
</li>
</ul>
</div>
<div class="sect3 class">
<h4 id="C-network.http">HTTP <a id="C-network.http"></a></h4>
<div id="f-network.http.new" class="openblock item function">
<div class="title">playdate.network.http.new(server, [port], [usessl], [reason])</div>
<div class="content">
<div class="paragraph">
<p>Returns a <code>playdate.network.http</code> object for connecting to the given server. The default port is 443 if <code>usessl</code> is true, otherwise 80; the default value for <code>usessl</code> is false. If the user has not yet given permission for the device to connect to the server, the game is paused while the system asks the user to allow or deny network access for the provided <code>reason</code>, if one is given. Since the system uses a coroutine <code>yield()</code> to show the dialog to request access (if not already given), it cannot be called at load time or from an input handler or other system callback.</p>
</div>
</div>
</div>
<div id="f-network.http.requestAccess" class="openblock item function">
<div class="title">playdate.network.http.requestAccess([server], [port], [usessl], [reason])</div>
<div class="content">
<div class="paragraph">
<p><code>playdate.network.http.new()</code> will automatically request access if needed (and note that <code>new()</code> only creates an object for connecting, doesn&#8217;t open the connection until <code>get()</code> or <code>post()</code> is called) but if you want to present the access dialog ahead of time you can use this function. Notably, this lets you request access to all HTTP servers by leaving the <code>server</code> field empty, or all subdomains of a domain by passing in the parent. Note that this function uses a coroutine <code>yield()</code> to pause the runtime while the permission dialog is up, so it can&#8217;t be called immediately at startup, must be called from a <code>playdate.update()</code> context</p>
</div>
</div>
</div>
<div id="m-network.http.close" class="openblock item method">
<div class="title">playdate.network.http:close()</div>
<div class="content">
<div class="paragraph">
<p>Closes the HTTP connection. The connection may be used again for another request.</p>
</div>
</div>
</div>
<div id="m-network.http.setKeepAlive" class="openblock item method">
<div class="title">playdate.network.http:setKeepAlive(flag)</div>
<div class="content">
<div class="paragraph">
<p>If <code>flag</code> is true, this causes the HTTP request to include a <em>Connection: keep-alive</em> header.</p>
</div>
</div>
</div>
<div id="m-network.http.setByteRange" class="openblock item method">
<div class="title">playdate.network.http:setByteRange(from, to)</div>
<div class="content">
<div class="paragraph">
<p>Adds a <code>Range: bytes</code> header to the HTTP request.</p>
</div>
</div>
</div>
<div id="m-network.http.setConnectTimeout" class="openblock item method">
<div class="title">playdate.network.http:setConnectTimeout(seconds)</div>
<div class="content">
<div class="paragraph">
<p>Sets the length of time (in seconds) to wait for the connection to the server to be made.</p>
</div>
</div>
</div>
<div id="m-network.http.get" class="openblock item method">
<div class="title">playdate.network.http:get(path, [headers])</div>
<div class="content">
<div class="paragraph">
<p>Opens the connection to the server if it&#8217;s not already open (e.g. from a previous request with the given path and additional <em>headers</em> if specified. The <em>headers</em> argument can either be a string containing all of the headers to send (with newlines between individual headers), an array of strings, or a table of key/value pairs.</p>
</div>
<div class="paragraph">
<p>If the request is successfully queued, the function returns <code>true</code>. On error, the function returns <code>false</code> and a string indicating the error.</p>
</div>
</div>
</div>
<div id="m-network.http.query" class="openblock item method">
<div class="title">playdate.network.http:query(path, [headers], data)</div>
<div class="content">
<div class="paragraph">
<p>Opens the connection to the server if it&#8217;s not already open (e.g. from a previous request with keep-alive enabled) and sends the given request with the given path, additional <em>headers</em> if specified, and the provided <em>data</em>. The <em>headers</em> argument can either be a string containing all of the headers to send (with newlines between individual headers), an array of strings, or a table of key/value pairs. If there is only one argument after <em>path</em> it is assumed to be <em>data</em>.</p>
</div>
<div class="paragraph">
<p>If the request is successfully queued, the function returns <code>true</code>. On error, the function returns <code>false</code> and a string indicating the error.</p>
</div>
</div>
</div>
<div id="m-network.http.post" class="openblock item method">
<div class="title">playdate.network.http:post(path, [headers], data)</div>
<div class="content">
<div class="paragraph">
<p>Equivalent to calling <code>playdate.network.http:query()</code> with <em>method</em> equal to <code>POST</code>.</p>
</div>
</div>
</div>
<div id="m-network.http.getError" class="openblock item method">
<div class="title">playdate.network.http:getError()</div>
<div class="content">
<div class="paragraph">
<p>Returns a text description of the last error on the connection, or nil if no error occurred.</p>
</div>
</div>
</div>
<div id="m-network.http.getProgress" class="openblock item method">
<div class="title">playdate.network.http:getProgress()</div>
<div class="content">
<div class="paragraph">
<p>Returns two values: the number of bytes already read from the connection and the total bytes the server plans to send.</p>
</div>
</div>
</div>
<div id="m-network.http.getBytesAvailable" class="openblock item method">
<div class="title">playdate.network.http:getBytesAvailable()</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of bytes currently available for reading from the connection.</p>
</div>
</div>
</div>
<div id="m-network.http.setReadTimeout" class="openblock item method">
<div class="title">playdate.network.http:setReadTimeout(seconds)</div>
<div class="content">
<div class="paragraph">
<p>Sets the length of time, in seconds, <code>playdate.network.http:read()</code> will wait for incoming data before returning. The default value is one second.</p>
</div>
</div>
</div>
<div id="m-network.http.setReadBufferSize" class="openblock item method">
<div class="title">playdate.network.http:setReadBufferSize(bytes)</div>
<div class="content">
<div class="paragraph">
<p>Sets the size of the connection&#8217;s read buffer.</p>
</div>
</div>
</div>
<div id="m-network.http.read" class="openblock item method">
<div class="title">playdate.network.http:read([length])</div>
<div class="content">
<div class="paragraph">
<p>On success, returns up to <code>length</code> bytes (maximum 64KB) from the connection. If <code>length</code> is more than the number of bytes available the function will wait for more data up to the length of time set by <code>setReadTimeout()</code> (default one second).</p>
</div>
</div>
</div>
<div id="m-network.http.getResponseStatus" class="openblock item method">
<div class="title">playdate.network.http:getResponseStatus()</div>
<div class="content">
<div class="paragraph">
<p>Returns the HTTP status response code, if the request response headers have been received and parsed.</p>
</div>
</div>
</div>
<div id="m-network.http.getResponseHeaders" class="openblock item method">
<div class="title">playdate.network.http:getResponseHeaders()</div>
<div class="content">
<div class="paragraph">
<p>Returns a table containing the key/value pairs in the HTTP response headers, or nil if no headers were received.</p>
</div>
</div>
</div>
<div id="m-network.http.setRequestCallback" class="openblock item method">
<div class="title">playdate.network.http:setRequestCallback(function)</div>
<div class="content">
<div class="paragraph">
<p>Sets a function to be called when response data is available.</p>
</div>
</div>
</div>
<div id="m-network.http.setHeadersReadCallback" class="openblock item method">
<div class="title">playdate.network.http:setHeadersReadCallback(function)</div>
<div class="content">
<div class="paragraph">
<p>Sets a function to be called after the connection has parsed the headers from the server response. At this point, <code>getResponseStatus()</code> and <code>getProgress()</code> can be used to query the status and size of the response, and <code>get()</code>/<code>post()</code> can queue another request if <code>connection:setKeepAlive(true)</code> was set.</p>
</div>
</div>
</div>
<div id="m-network.http.setRequestCompleteCallback" class="openblock item method">
<div class="title">playdate.network.http:setRequestCompleteCallback(function)</div>
<div class="content">
<div class="paragraph">
<p>Sets a function to be called when all data for the request has been received (if the response contained a Content-Length header and the size is known) or the request times out.</p>
</div>
</div>
</div>
<div id="m-network.http.setConnectionClosedCallback" class="openblock item method">
<div class="title">playdate.network.http:setConnectionClosedCallback(function)</div>
<div class="content">
<div class="paragraph">
<p>Sets a function to be called when the server has closed the connection.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="M-network.tcp">TCP <a id="C-network.tcp"></a></h4>
<div id="f-network.tcp.new" class="openblock item function">
<div class="title">playdate.network.tcp.new(server, port, [usessl], [reason])</div>
<div class="content">
<div class="paragraph">
<p>Returns a <code>playdate.network.tcp</code> object for connecting to the given server. The default value for <code>usessl</code> is false. If the user has not yet given permission for the device to connect to the server, the game is paused while the system asks the user to allow or deny network access for the provided <code>reason</code>, if one is given. Since the system uses a coroutine <code>yield()</code> to show the dialog to request access (if not already given), it cannot be called at load time or from an input handler or other system callback.</p>
</div>
</div>
</div>
<div id="f-network.tcp.requestAccess" class="openblock item function">
<div class="title">playdate.network.tcp.requestAccess([server], [port], [reason])</div>
<div class="content">
<div class="paragraph">
<p><code>playdate.network.tcp.new()</code> will automatically request access if needed (and note that <code>new()</code> only creates an object for connecting, doesn&#8217;t open the connection until <code>open()</code> is called) but if you want to present the access dialog ahead of time you can use this function. Notably, this lets you request access to all servers by leaving the <code>server</code> field empty, or all subdomains of a domain by passing in the parent. Access to all ports on a given server can be requested by leaving <code>port</code> empty. Note that this function uses a coroutine <code>yield()</code> to pause the runtime while the permission dialog is up, so it can&#8217;t be called immediately at startup, must be called from a <code>playdate.update()</code> context</p>
</div>
</div>
</div>
<div id="m-network.tcp.setConnectTimeout" class="openblock item method">
<div class="title">playdate.network.tcp:setConnectTimeout(seconds)</div>
<div class="content">
<div class="paragraph">
<p>Sets the length of time (in seconds) to wait for the connection to the server to be made.</p>
</div>
</div>
</div>
<div id="m-network.tcp.open" class="openblock item method">
<div class="title">playdate.network.tcp:open(connectCallback)</div>
<div class="content">
<div class="paragraph">
<p>Attempts to open the TCP connection. <code>connectCallback</code> is a function to be called when the connection either succeeds or fails. The function is called with a boolean indicating whether the connection was successful, and an error string if the connection failed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">connection:open(<span class="keyword">function</span> <span class="function">tcpConnectCallback</span>(connected, err)
        <span class="keyword">if</span> connected <span class="keyword">then</span> <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">connected!</span><span class="delimiter">&quot;</span></span>) <span class="keyword">else</span> <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">connection failed: </span><span class="delimiter">&quot;</span></span>..err) <span class="keyword">end</span>
<span class="keyword">end</span>)</code></pre>
</div>
</div>
</div>
</div>
<div id="m-network.tcp.close" class="openblock item method">
<div class="title">playdate.network.tcp:close()</div>
<div class="content">
<div class="paragraph">
<p>Closes the connection. <code>open()</code> may be called again after this to reopen the connection to the server.</p>
</div>
</div>
</div>
<div id="m-network.tcp.getBytesAvailable" class="openblock item method">
<div class="title">playdate.network.tcp:getBytesAvailable()</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of bytes currently available in the connection&#8217;s read buffer for reading from the connection.</p>
</div>
</div>
</div>
<div id="m-network.tcp.setReadTimeout" class="openblock item method">
<div class="title">playdate.network.tcp:setReadTimeout(seconds)</div>
<div class="content">
<div class="paragraph">
<p>Sets the length of time, in seconds, <code>playdate.network.tcp:read()</code> will wait for incoming data before returning. The default value is one second.</p>
</div>
</div>
</div>
<div id="m-network.tcp.setReadBufferSize" class="openblock item method">
<div class="title">playdate.network.tcp:setReadBufferSize(bytes)</div>
<div class="content">
<div class="paragraph">
<p>Sets the size of the connection&#8217;s read buffer.</p>
</div>
</div>
</div>
<div id="m-network.tcp.read" class="openblock item method">
<div class="title">playdate.network.tcp:read([length])</div>
<div class="content">
<div class="paragraph">
<p>On success, returns up to <code>length</code> bytes (maximum 64KB) from the connection as well as the number of bytes that were read. If <code>length</code> is more than the number of bytes available the function will wait for more data up to the length of time set by <code>setReadTimeout()</code> (default one second).</p>
</div>
</div>
</div>
<div id="m-network.tcp.write" class="openblock item method">
<div class="title">playdate.network.tcp:write(data)</div>
<div class="content">
<div class="paragraph">
<p>Attempts to write the given data to the connection. On success, returns <code>true</code>; on failure, returns <code>false</code> and a string describing the error.</p>
</div>
</div>
</div>
<div id="m-network.tcp.getError" class="openblock item method">
<div class="title">playdate.network.tcp:getError()</div>
<div class="content">
<div class="paragraph">
<p>Returns a text description of the last error on the connection, or nil if no error occurred.</p>
</div>
</div>
</div>
<div id="m-network.tcp.setConnectionClosedCallback" class="openblock item method">
<div class="title">playdate.network.tcp:setConnectionClosedCallback(function)</div>
<div class="content">
<div class="paragraph">
<p>Sets a function to be called when the server has closed the connection.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-pathfinder">7.25. Pathfinding</h3>
<div class="paragraph">
<p>An implementation of the popular A* pathfinding algorithm. To find a path first create a <a href="#C-playdate.pathfinder.graph">playdate.pathfinder.graph</a> containing connected <a href="#C-playdate.pathfinder.node">playdate.pathfinder.nodes</a> then call <a href="#m-pathfinder.graph.findPath">findPath</a> on the graph. A heuristic function callback can be specified for determining an estimate of the distance between two nodes, otherwise the manhattan distance between nodes will be used. In that case it is important to set appropriate x and y values on the nodes.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Example code: <code>&lt;Playdate SDK&gt;/Examples/Pathfinder/</code>
</td>
</tr>
</table>
</div>
<div class="sect3 class">
<h4 id="C-pathfinder.graph">Graph <a id="C-playdate.pathfinder.graph"></a></h4>
<div id="f-pathfinder.graph.new" class="openblock item function">
<div class="title">playdate.pathfinder.graph.new([nodeCount, [coordinates]])</div>
<div class="content">
<div class="paragraph">
<p>Returns a new empty <a href="#C-playdate.pathfinder.graph">playdate.pathfinder.graph</a> object.</p>
</div>
<div class="paragraph">
<p>If <code>nodeCount</code> is supplied, that number of nodes will be allocated and added to the graph. Their IDs will be set from 1 to <code>nodeCount</code>.</p>
</div>
<div class="paragraph">
<p><code>coordinates</code>, if supplied, should be a table containing tables of x, y values, indexed by node IDs. For example, <code>{{10, 10}, {50, 30}, {20, 100}, {100, 120}, {160, 130}}</code>.</p>
</div>
</div>
</div>
<div id="f-pathfinder.graph.new2DGrid" class="openblock item function">
<div class="title">playdate.pathfinder.graph.new2DGrid(width, height, [allowDiagonals, [includedNodes]])</div>
<div class="content">
<div class="paragraph">
<p>Convenience function that returns a new <a href="#C-playdate.pathfinder.graph">playdate.pathfinder.graph</a> object containing nodes for for each grid position, even if not connected to any other nodes. This allows for easier graph modification once the graph is generated. Weights for connections between nodes are set to 10 for horizontal and vertical connections and 14 for diagonal connections (if included), as this tends to produce nicer paths than using uniform weights. Nodes have their indexes set from 1 to <em>width</em> * <em>height</em>, and have their <em>x, y</em> values set appropriately for the node&#8217;s position.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>width</em>: The width of the grid to be created.</p>
</li>
<li>
<p><em>height</em>: The height of the grid to be created.</p>
</li>
<li>
<p><em>allowDiagonals</em>: If true, diagonal connections will also be created.</p>
</li>
<li>
<p><em>includedNodes</em>: A one-dimensional array of length <em>width</em> * <em>height</em>. Each entry should be a 1 or a 0 to indicate nodes that should be connected to their neighbors and nodes that should not have any connections added. If not provided, all nodes will be connected to their neighbors.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-pathfinder.graph.addNewNode" class="openblock item method">
<div class="title">playdate.pathfinder.graph:addNewNode(id, [x, y, [connectedNodes, weights, addReciprocalConnections]])</div>
<div class="content">
<div class="paragraph">
<p>Creates a new <a href="#C-playdate.pathfinder.node">playdate.pathfinder.node</a> and adds it to the graph.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>id</em>: id value for the new node.</p>
</li>
<li>
<p><em>x</em>: Optional x value for the node.</p>
</li>
<li>
<p><em>y</em>: Optional y value for the node.</p>
</li>
<li>
<p><em>connectedNodes</em>: Array of existing nodes to create connections to from the new node.</p>
</li>
<li>
<p><em>weights</em>: Array of weights for the new connections. Array must be the same length as <em>connectedNodes</em>. Weights affect the path the A* algorithm will solve for. A longer, lighter-weighted path will be chosen over a shorter heavier path, if available.</p>
</li>
<li>
<p><em>addReciprocalConnections</em>: If true, connections will also be added in the reverse direction for each node.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-pathfinder.graph.addNewNodes" class="openblock item method">
<div class="title">playdate.pathfinder.graph:addNewNodes(count)</div>
<div class="content">
<div class="paragraph">
<p>Creates <em>count</em> new nodes, adding them to the graph, and returns them in an array-style table. The new node&#8217;s <em>id_s will be assigned values 1 through _count</em>-1.</p>
</div>
<div class="paragraph">
<p>This method is useful to improve performance if many nodes need to be allocated at once rather than one at a time, for example when creating a new graph.</p>
</div>
</div>
</div>
<div id="m-pathfinder.graph.addNode" class="openblock item method">
<div class="title">playdate.pathfinder.graph:addNode(node, [connectedNodes, weights, addReciprocalConnections])</div>
<div class="content">
<div class="paragraph">
<p>Adds an already-existing node to the graph. The node must have originally belonged to the same graph.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>node</em>: Node to be added to the graph.</p>
</li>
<li>
<p><em>connectedNodes</em>: Array of existing nodes to create connections to from the new node.</p>
</li>
<li>
<p><em>weights</em>: Array of weights for the new connections. Array must be the same length as <em>connectedNodes</em>. Weights affect the path the A* algorithm will solve for. A longer, lighter-weighted path will be chosen over a shorter heavier path, if available.</p>
</li>
<li>
<p><em>addReciprocalConnections</em>: If true, connections will also be added in the reverse direction for each connection added.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-pathfinder.graph.addNodes" class="openblock item method">
<div class="title">playdate.pathfinder.graph:addNodes(nodes)</div>
<div class="content">
<div class="paragraph">
<p>Adds an array of already-existing nodes to the graph.</p>
</div>
</div>
</div>
<div id="m-pathfinder.graph.allNodes" class="openblock item method">
<div class="title">playdate.pathfinder.graph:allNodes()</div>
<div class="content">
<div class="paragraph">
<p>Returns an array containing all nodes in the graph.</p>
</div>
</div>
</div>
<div id="m-pathfinder.graph.removeNode" class="openblock item method">
<div class="title">playdate.pathfinder.graph:removeNode(node)</div>
<div class="content">
<div class="paragraph">
<p>Removes node from the graph. Also removes all connections to and from the node.</p>
</div>
</div>
</div>
<div id="m-pathfinder.graph.removeNodeWithXY" class="openblock item method">
<div class="title">playdate.pathfinder.graph:removeNodeWithXY(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Returns the first node found with coordinates matching <em>x, y</em>, after removing it from the graph and removing all connections to and from the node.</p>
</div>
</div>
</div>
<div id="m-pathfinder.graph.removeNodeWithID" class="openblock item method">
<div class="title">playdate.pathfinder.graph:removeNodeWithID(id)</div>
<div class="content">
<div class="paragraph">
<p>Returns the first node found with a matching <em>id</em>, after removing it from the graph and removing all connections to and from the node.</p>
</div>
</div>
</div>
<div id="m-pathfinder.graph.nodeWithID" class="openblock item method">
<div class="title">playdate.pathfinder.graph:nodeWithID(id)</div>
<div class="content">
<div class="paragraph">
<p>Returns the first node found in the graph with a matching <em>id</em>, or nil if no such node is found.</p>
</div>
</div>
</div>
<div id="m-pathfinder.graph.nodeWithXY" class="openblock item method">
<div class="title">playdate.pathfinder.graph:nodeWithXY(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Returns the first node found in the graph with matching <em>x</em> and <em>y</em> values, or nil if no such node is found.</p>
</div>
</div>
</div>
<div id="m-pathfinder.graph.addConnections" class="openblock item method">
<div class="title">playdate.pathfinder.graph:addConnections(connections)</div>
<div class="content">
<div class="paragraph">
<p><code>connections</code> should be a table of array-style tables. The keys of the outer table should correspond to node IDs, while the inner array should be a series if connecting node ID and weight combinations that will be assigned to that node. For example, <code>{[1]={2, 10, 3, 12}, [2]={1, 20}, [3]={1, 20, 2, 10}}</code> will create a connection from node ID 1 to node ID 2 with a weight of 10, and a connection to node ID 3 with a weight of 12, and so on for the other entries.</p>
</div>
</div>
</div>
<div id="m-pathfinder.graph.addConnectionToNodeWithID" class="openblock item method">
<div class="title">playdate.pathfinder.graph:addConnectionToNodeWithID(fromNodeID, toNodeID, weight, addReciprocalConnection)</div>
<div class="content">
<div class="paragraph">
<p>Adds a connection from the node with <code>id</code> <code>fromNodeID</code> to the node with <code>id</code> <code>toNodeID</code> with a weight value of <code>weight</code>. Weights affect the path the A* algorithm will solve for. A longer, lighter-weighted path will be chosen over a shorter heavier path, if available. If <code>addReciprocalConnection</code> is true, the reverse connection will also be added.</p>
</div>
</div>
</div>
<div id="m-pathfinder.graph.removeAllConnections" class="openblock item method">
<div class="title">playdate.pathfinder.graph:removeAllConnections()</div>
<div class="content">
<div class="paragraph">
<p>Removes all connections from all nodes in the graph.</p>
</div>
</div>
</div>
<div id="m-pathfinder.graph.removeAllConnectionsFromNodeWithID" class="openblock item method">
<div class="title">playdate.pathfinder.graph:removeAllConnectionsFromNodeWithID(id, [removeIncoming])</div>
<div class="content">
<div class="paragraph">
<p>Removes all connections from the matching node.</p>
</div>
<div class="paragraph">
<p>If <code>removeIncoming</code> is true, all connections from other nodes to the calling node are also removed. False by default. Please note: this can signficantly increase the time this function takes as it requires a full search of the graph - O(1) vs O(n)).</p>
</div>
</div>
</div>
<div id="m-pathfinder.graph.findPath" class="openblock item method">
<div class="title">playdate.pathfinder.graph:findPath(startNode, goalNode, [heuristicFunction, [findPathToGoalAdjacentNodes]])</div>
<div class="content">
<div class="paragraph">
<p>Returns an array of nodes representing the path from <em>startNode</em> to <em>goalNode</em>, or <em>nil</em> if no path can be found.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>heuristicFunction</em>: If provided, this function should be of the form <em>function(startNode, goalNode)</em> and should return an integer value estimate or underestimate of the distance from <em>startNode</em> to <em>goalNode</em>. If not provided, a manhattan distance function will be used to calculate the estimate. This requires that the <em>x, y</em> values of the nodes in the graph have been set properly.</p>
</li>
<li>
<p><em>findPathToGoalAdjacentNodes</em>: If true, a path will be found to any node adjacent to the goal node, based on the <em>x, y</em> values of those nodes and the goal node. This does not rely on connections between adjacent nodes and  the goal node, which can be entirely disconnected from the rest of the graph.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-pathfinder.graph.findPathWithIDs" class="openblock item method">
<div class="title">playdate.pathfinder.graph:findPathWithIDs(startNodeID, goalNodeID, [heuristicFunction, [findPathToGoalAdjacentNodes]])</div>
<div class="content">
<div class="paragraph">
<p>Works the same as <a href="#m-pathfinder.graph.findPath">findPath</a>, but looks up nodes to find a path between using startNodeID and goalNodeID and returns a list of nodeIDs rather than the nodes themselves.</p>
</div>
</div>
</div>
<div id="m-pathfinder.graph.setXYForNodeWithID" class="openblock item method">
<div class="title">playdate.pathfinder.graph:setXYForNodeWithID(id, x, y)</div>
<div class="content">
<div class="paragraph">
<p>Sets the matching node&#8217;s <code>x</code> and <code>y</code> values.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-playdate.pathfinder.node">Node</h4>
<div class="paragraph">
<p>You can directly read or write <strong>x</strong>, <strong>y</strong> and <strong>id</strong> values on a playdate.pathfinder.node.</p>
</div>
<div id="m-pathfinder.node.addConnection" class="openblock item method">
<div class="title">playdate.pathfinder.node:addConnection(node, weight, addReciprocalConnection)</div>
<div class="content">
<div class="paragraph">
<p>Adds a new connection between nodes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>node</em>: The node the new connection will point to.</p>
</li>
<li>
<p><em>weight</em>: Weight for the new connection. Weights affect the path the A* algorithm will solve for. A longer, lighter-weighted path will be chosen over a shorter heavier path, if available.</p>
</li>
<li>
<p><em>addReciprocalConnection</em>: If true, a second connection will be created with the same weight in the opposite direction.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-pathfinder.node.addConnections" class="openblock item method">
<div class="title">playdate.pathfinder.node:addConnections(nodes, weights, addReciprocalConnections)</div>
<div class="content">
<div class="paragraph">
<p>Adds a new connection to each node in the nodes array.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>nodes</em>: An array of nodes which the new connections will point to.</p>
</li>
<li>
<p><em>weights</em>: An array of weights for the new connections. Must be of the same length as the nodes array. Weights affect the path the A* algorithm will solve for. A longer, lighter-weighted path will be chosen over a shorter heavier path, if available.</p>
</li>
<li>
<p><em>addReciprocalConnections</em>: If true, connections will also be added in the reverse direction for each node.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-pathfinder.node.addConnectionToNodeWithXY" class="openblock item method">
<div class="title">playdate.pathfinder.node:addConnectionToNodeWithXY(x, y, weight, addReciprocalConnection)</div>
<div class="content">
<div class="paragraph">
<p>Adds a connection to the first node found with matching <em>x</em> and <em>y</em> values, if it exists.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>weight</em>: The weight for the new connection. Weights affect the path the A* algorithm will solve for. A longer, lighter-weighted path will be chosen over a shorter heavier path, if available.</p>
</li>
<li>
<p><em>addReciprocalConnections</em>: If true, a connection will also be added in the reverse direction, from the node at x, y to the caller.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-pathfinder.node.connectedNodes" class="openblock item method">
<div class="title">playdate.pathfinder.node:connectedNodes()</div>
<div class="content">
<div class="paragraph">
<p>Returns an array of nodes that have been added as connections to this node.</p>
</div>
</div>
</div>
<div id="m-pathfinder.node.removeConnection" class="openblock item method">
<div class="title">playdate.pathfinder.node:removeConnection(node, [removeReciprocal])</div>
<div class="content">
<div class="paragraph">
<p>Removes a connection to node, if it exists. If <em>removeReciprocal</em> is true the reverse connection will also be removed, if it exists.</p>
</div>
</div>
</div>
<div id="m-pathfinder.node.removeAllConnections" class="openblock item method">
<div class="title">playdate.pathfinder.node:removeAllConnections([removeIncoming])</div>
<div class="content">
<div class="paragraph">
<p>Removes all connections from the calling node.</p>
</div>
<div class="paragraph">
<p>If <code>removeIncoming</code> is true, all connections from other nodes to the calling node are also removed. False by default. Please note: this can signficantly increase the time this function takes as it requires a full search of the graph - O(1) vs O(n)).</p>
</div>
</div>
</div>
<div id="m-pathfinder.node.setXY" class="openblock item method">
<div class="title">playdate.pathfinder.node:setXY(x, y)</div>
<div class="content">
<div class="paragraph">
<p>Sets the <em>x</em> and <em>y</em> values for the node.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="power">7.26. Power</h3>
<div id="f-getPowerStatus" class="openblock item function">
<div class="title">playdate.getPowerStatus()</div>
<div class="content">
<div class="paragraph">
<p>Returns a table holding booleans with the following keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>charging</em>: The battery is actively being charged</p>
</li>
<li>
<p><em>USB</em>: There is a powered USB cable connected</p>
</li>
<li>
<p><em>screws</em>: There is 5V being applied to the corner screws (via the dock, for example)</p>
</li>
</ul>
</div>
</div>
</div>
<div id="f-getBatteryPercentage" class="openblock item function">
<div class="title">playdate.getBatteryPercentage()</div>
<div class="content">
<div class="paragraph">
<p>Returns a value from 0-100 denoting the current level of battery charge. 0 = empty; 100 = full.</p>
</div>
</div>
</div>
<div id="f-getBatteryVoltage" class="openblock item function">
<div class="title">playdate.getBatteryVoltage()</div>
<div class="content">
<div class="paragraph">
<p>Returns the battery&#8217;s current voltage level.</p>
</div>
</div>
</div>
</div>
<div class="sect2 section">
<h3 id="simulator">7.27. Simulator-only functionality</h3>
<div id="v-isSimulator" class="openblock item variable">
<div class="title">playdate.isSimulator</div>
<div class="content">
<div class="paragraph">
<p>This variable—not a function, so don&#8217;t invoke with <em>()</em>—it is set to 1 when running inside of the Simulator and is <em>nil</em> otherwise.</p>
</div>
</div>
</div>
<div id="f-simulator.writeToFile" class="openblock item function">
<div class="title">playdate.simulator.writeToFile(image, path)</div>
<div class="content">
<div class="paragraph">
<p>Writes an image to a PNG file at the path specified. Only available on the Simulator.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>path</em> represents a path on your development computer, not the Playdate filesystem. It&#8217;s recommended you prefix your path with <code>~/</code> to ensure you are writing to a writeable directory, for example, <code>~/myImageFile.png</code>. Please include the <code>.png</code> file extension in your path name. Any directories in your path must already exist on your development computer in order for the file to be written.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-simulator.exit" class="openblock item function">
<div class="title">playdate.simulator.exit()</div>
<div class="content">
<div class="paragraph">
<p>Quits the Playdate Simulator app.</p>
</div>
</div>
</div>
<div id="f-simulator.getURL" class="openblock item function">
<div class="title">playdate.simulator.getURL(url)</div>
<div class="content">
<div class="paragraph">
<p>Returns the contents of the URL <em>url</em> as a string.</p>
</div>
</div>
</div>
<div id="f-clearConsole" class="openblock item function">
<div class="title">playdate.clearConsole()</div>
<div class="content">
<div class="paragraph">
<p>Clears the simulator console.</p>
</div>
</div>
</div>
<div id="f-setDebugDrawColor" class="openblock item function">
<div class="title">playdate.setDebugDrawColor(r, g, b, a)</div>
<div class="content">
<div class="paragraph">
<p>Sets the color of the <a href="#c-debugDraw">playdate.debugDraw()</a> overlay image. Values are in the range 0-1.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_simulator_debug_callbacks">Simulator debug callbacks</h4>
<div class="paragraph">
<p>These callbacks are only invoked when your game is running in the Simulator.</p>
</div>
<div id="c-keyPressed" class="openblock item callback">
<div class="title">playdate.keyPressed(key)</div>
<div class="content">
<div class="paragraph">
<p>Lets you act on keyboard keypresses when running in the Simulator ONLY. These can be useful for adding debugging functions that can be enabled via your keyboard.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It is possible test a game on Playdate hardware and trap computer keyboard keypresses if you are using the Simulator&#8217;s <code>Control Device with Simulator</code> option.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>key</code> is a string containing the character pressed or released on the keyboard. Note that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The key in question needs to have a textual representation or these functions will not be called. For instance, alphanumeric keys will call these functions; keyboard directional arrows will not.</p>
</li>
<li>
<p>If the keypress in question is already in use by the Simulator for another purpose (say, to control the d-pad or A/B buttons), these functions will not be called.</p>
</li>
<li>
<p>If <em>key</em> is an alphabetic character, the value will always be lowercase, even if the user deliberately typed an uppercase character.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="c-keyReleased" class="openblock item callback">
<div class="title">playdate.keyReleased(key)</div>
<div class="content">
<div class="paragraph">
<p>Lets you act on keyboard key releases when running in the Simulator ONLY. These can be useful for adding debugging functions that can be enabled via your keyboard.</p>
</div>
</div>
</div>
<div id="c-debugDraw" class="openblock item callback">
<div class="title">playdate.debugDraw()</div>
<div class="content">
<div class="paragraph">
<p>Called immediately after <a href="#c-update">playdate.update()</a>, any drawing performed during this callback is overlaid on the display in 50% transparent red (or another color selected with <a href="#f-setDebugDrawColor">playdate.setDebugDrawColor()</a>).</p>
</div>
<div class="paragraph">
<p>White pixels are drawn in the <a href="#f-setDebugDrawColor">debugDrawColor</a>. Black pixels are transparent.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-sound">7.28. Sound</h3>
<div class="paragraph">
<p>The Playdate audio engine provides <a href="#C-sound.sampleplayer">sample playback</a> from memory for short on-demand samples, <a href="#C-sound.fileplayer">file streaming</a> for playing longer files (uncompressed, MP3, and ADPCM formats), and a <a href="#C-sound.synth">synthesis</a> library for generating "computer-y" sounds. Sound sources are grouped into <a href="#C-sound.channel">channels</a>, which can be panned separately, and various <a href="#C-sound.effect">effects</a> may be applied to the channels. Additionally, <a href="#C-sound.signal">signals</a> can automate various parameters of the sound objects.</p>
</div>
<div id="f-sound.getSampleRate" class="openblock item function">
<div class="title">playdate.sound.getSampleRate()</div>
<div class="content">
<div class="paragraph">
<p>Returns the sample rate of the audio system (44100). The sample rate is determined by the hardware, and is not currently mutable.</p>
</div>
</div>
</div>
<div id="M-sound-prep" class="sidebarblock module">
<div class="content">
<div class="title">Preparing your sound files</div>
<div class="paragraph">
<p><strong>ADPCM</strong> is the ideal audio format to use for Playdate games. It is less CPU-intensive to decode than MP3, while still providing a much smaller file size than uncompressed audio.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">To encode into ADPCM with <a href="https://www.audacityteam.org">Audacity</a></dt>
<dd>
<p>File &gt; Export Audio… &gt; File type: WAV (Microsoft), Encoding: IMA ADPCM.</p>
</dd>
<dt class="hdlist1">To encode into ADPCM with <a href="https://www.ffmpeg.org">ffmpeg</a></dt>
<dd>
<p>type <code>ffmpeg -i input.mp3 -acodec adpcm_ima_wav output.wav</code> at the command line.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.sampleplayer">Sampleplayer</h4>
<div class="paragraph">
<p>The sampleplayer class is used for playing short samples like sound effects. Audio data is loaded into memory at instantiation, so it plays with little overhead. For longer audio like background music, the <a href="#C-sound.fileplayer">fileplayer</a> class may be more appropriate; there, audio data is streamed from disk as it&#8217;s played and only a small portion of the data is in memory at any given time.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Unlike <a href="#C-sound.fileplayer">fileplayer</a>, sampleplayer cannot play MP3 files. For a balance of good performance and small file size, we recommend encoding audio into <a href="#M-sound-prep">ADPCM .wav files</a>.
</td>
</tr>
</table>
</div>
<div id="f-sound.sampleplayer.new" class="openblock item function">
<div class="title">playdate.sound.sampleplayer.new(path)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.sound.sampleplayer object, with the sound data loaded in memory. If the sample can&#8217;t be loaded, the function returns nil and a second value containing the error.</p>
</div>
</div>
</div>
<div id="f-sound.sampleplayer.new-1" class="openblock item function">
<div class="title">playdate.sound.sampleplayer.new(sample)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.sound.sampleplayer object for playing the given <a href="#C-sound.sample">sample</a>.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.copy" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:copy()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.sound.sampleplayer with the same sample, volume, and rate as the given sampleplayer.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.play" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:play([repeatCount], [rate])</div>
<div class="content">
<div class="paragraph">
<p>Starts playing the sample. If <em>repeatCount</em> is greater than one, it loops the given number of times. If zero, it loops endlessly until it is stopped with <a href="#m-sound.sampleplayer.stop">playdate.sound.sampleplayer:stop()</a>. If <em>rate</em> is set, the sample will be played at the given rate instead of the rate previous set with <a href="#m-sound.sampleplayer.setRate">playdate.sound.sampleplayer.setRate()</a>.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.playAt" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:playAt(when, [vol], [rightvol], [rate])</div>
<div class="content">
<div class="paragraph">
<p>Schedules the sound for playing at device time <em>when</em>. If <em>vol</em> is specified, the sample will be played at level <em>vol</em> (with optional separate right channel volume <em>rightvol</em>), otherwise it plays at the volume set by <a href="#m-sound.sampleplayer.setVolume">playdate.sound.sampleplayer.setVolume()</a>. Note that the <em>when</em> argument is an offset in the audio device&#8217;s time scale, as returned by <a href="#f-sound.getCurrentTime">playdate.sound.getCurrentTime()</a>; it is <strong>not</strong> relative to the current time! If <em>when</em> is less than the current audio time, the sample is played immediately. If <em>rate</em> is set, the sample will be played at the given rate instead of the rate previously set with <a href="#m-sound.sampleplayer.setRate">playdate.sound.sampleplayer.setRate()</a>.</p>
</div>
<div class="paragraph">
<p>Only one event can be queued at a time. If <code>playAt()</code> is called while another event is queued, it will overwrite it with the new values.</p>
</div>
<div class="paragraph">
<p>The function returns true if the sample was successfully added to the sound channel, otherwise false (i.e., if the channel is full).</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.setVolume" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:setVolume(left, [right])</div>
<div class="content">
<div class="paragraph">
<p>Sets the playback volume (0.0 - 1.0) for left and right channels. If the optional <em>right</em> argument is omitted, it is the same as <em>left</em>. If the sampleplayer is currently playing using the default volume (that is, it wasn&#8217;t triggered by <code>playAt()</code> with a volume given) it also changes the volume of the playing sample.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.getVolume" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:getVolume()</div>
<div class="content">
<div class="paragraph">
<p>Returns the playback volume for the sampleplayer, a single value for mono sources or a pair of values (left, right) for stereo sources.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.setLoopCallback" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:setLoopCallback(callback, [arg])</div>
<div class="content">
<div class="paragraph">
<p>Sets a function to be called every time the sample loops. The sample object is passed to this function as the first argument, and the optional <em>arg</em> argument is passed as the second.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.setPlayRange" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:setPlayRange(start, end)</div>
<div class="content">
<div class="paragraph">
<p>Sets the range of the sample to play. <em>start</em> and <em>end</em> are frame offsets from the beginning of the sample.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.setPaused" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:setPaused(flag)</div>
<div class="content">
<div class="paragraph">
<p>Pauses or resumes playback.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.isPlaying" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:isPlaying()</div>
<div class="content">
<div class="paragraph">
<p>Returns a boolean indicating whether the sample is playing.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.stop" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:stop()</div>
<div class="content">
<div class="paragraph">
<p>Stops playing the sample.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.setFinishCallback" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:setFinishCallback(func, [arg])</div>
<div class="content">
<div class="paragraph">
<p>Sets a function to be called when playback has completed. The sample object is passed to this function as the first argument, and the optional <em>arg</em> argument is passed as the second.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.setSample" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:setSample(sample)</div>
<div class="content">
<div class="paragraph">
<p>Sets the <a href="#C-sound.sample">sample</a> to be played.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.getSample" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:getSample()</div>
<div class="content">
<div class="paragraph">
<p>Gets the <a href="#C-sound.sample">sample</a> to be played.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.getLength" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:getLength()</div>
<div class="content">
<div class="paragraph">
<p>Returns the length of the sampleplayer&#8217;s sample, in seconds. Length is not scaled by playback rate.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.setRate" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:setRate(rate)</div>
<div class="content">
<div class="paragraph">
<p>Sets the playback rate for the sample. 1.0 is normal speed, 0.5 is down an octave, 2.0 is up an octave, etc. Sampleplayers can also play samples backwards, by setting a negative rate; note, however, this does not work with ADPCM-encoded files.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.getRate" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:getRate()</div>
<div class="content">
<div class="paragraph">
<p>Returns the playback rate for the sample.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.setRateMod" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:setRateMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets the <a href="#C-sound.signal">signal</a> to use as a rate modulator, added to the rate set with <a href="#m-sound.sampleplayer.setRate">playdate.sound.sampleplayer:setRate()</a>.  Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.setOffset" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:setOffset(seconds)</div>
<div class="content">
<div class="paragraph">
<p>Sets the current offset of the sampleplayer, in seconds. This value is not adjusted for rate.</p>
</div>
</div>
</div>
<div id="m-sound.sampleplayer.getOffset" class="openblock item method">
<div class="title">playdate.sound.sampleplayer:getOffset()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current offset of the sampleplayer, in seconds. This value is not adjusted for rate.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.fileplayer">Fileplayer</h4>
<div class="paragraph">
<p>The fileplayer class is used for streaming audio from a file on disk. This requires less memory than keeping all of the file&#8217;s data in memory (as with the <a href="#C-sound.sampleplayer">sampleplayer</a>), but can increase overhead at run time.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Fileplayer can play MP3 files, but MP3 decoding is CPU-intensive. For a balance of good performance and small file size, we recommend encoding audio into <a href="#M-sound-prep">ADPCM .wav files</a>.
</td>
</tr>
</table>
</div>
<div id="f-sound.fileplayer.new-empty" class="openblock item function">
<div class="title">playdate.sound.fileplayer.new([buffersize])</div>
<div class="content">
<div class="paragraph">
<p>Returns a fileplayer object, which can stream samples from disk. The file to play is set with the <a href="#m-sound.fileplayer.load">playdate.sound.fileplayer:load()</a> function.</p>
</div>
<div class="paragraph">
<p>If given, <em>buffersize</em> specifies the size in seconds of the fileplayer&#8217;s data buffer. A shorter value reduces the latency of a <a href="#m-sound.fileplayer.setOffset">playdate.sound.fileplayer:setOffset()</a> call, but increases the chance of a buffer underrun.</p>
</div>
</div>
</div>
<div id="f-sound.fileplayer.new" class="openblock item function">
<div class="title">playdate.sound.fileplayer.new(path, [buffersize])</div>
<div class="content">
<div class="paragraph">
<p>Returns a fileplayer object for streaming samples from the file at <em>path</em>. Note that the file isn&#8217;t loaded until <a href="#m-sound.fileplayer.play">playdate.sound.fileplayer:play()</a> or <a href="#m-sound.fileplayer.setBufferSize">playdate.sound.fileplayer:setBufferSize()</a> is called, in order to reduce initialization overhead.</p>
</div>
<div class="paragraph">
<p>If given, <em>buffersize</em> specifies the size in seconds of the fileplayer&#8217;s data buffer. A shorter value reduces the latency of a <a href="#m-sound.fileplayer.setOffset">playdate.sound.fileplayer:setOffset()</a> call, but increases the chance of a buffer underrun.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.load" class="openblock item method">
<div class="title">playdate.sound.fileplayer:load(path)</div>
<div class="content">
<div class="paragraph">
<p>Instructs the fileplayer to load the file at <em>path</em> when <a href="#m-sound.fileplayer.play">play()</a> is called on it. The fileplayer must not be playing when this function is called. The fileplayer&#8217;s play offset is reset to the beginning of the file, and its loop range is cleared.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.play" class="openblock item method">
<div class="title">playdate.sound.fileplayer:play([repeatCount])</div>
<div class="content">
<div class="paragraph">
<p>Opens and starts playing the file, first creating and filling a 1/4 second playback buffer if a buffer size hasn&#8217;t been set yet.</p>
</div>
<div class="paragraph">
<p>If repeatCount is set, playback repeats when it reaches the end of the file or the end of the <a href="#m-sound.fileplayer.setLoopRange">loop range</a> if one is set. After the loop has run <em>repeatCount</em> times, it continues playing to the end of the file. A <em>repeatCount</em> of zero loops endlessly. If repeatCount is not set, the file plays once.</p>
</div>
<div class="paragraph">
<p>The function returns true if the file was successfully opened and the fileplayer added to the sound channel, otherwise false and a string describing the error.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.stop" class="openblock item method">
<div class="title">playdate.sound.fileplayer:stop()</div>
<div class="content">
<div class="paragraph">
<p>Stops playing the file, resets the playback offset to zero, and calls the finish callback.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.pause" class="openblock item method">
<div class="title">playdate.sound.fileplayer:pause()</div>
<div class="content">
<div class="paragraph">
<p>Stops playing the file. A subsequent play() call resumes playback from where it was paused.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.isPlaying" class="openblock item method">
<div class="title">playdate.sound.fileplayer:isPlaying()</div>
<div class="content">
<div class="paragraph">
<p>Returns a boolean indicating whether the fileplayer is playing.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.getLength" class="openblock item method">
<div class="title">playdate.sound.fileplayer:getLength()</div>
<div class="content">
<div class="paragraph">
<p>Returns the length, in seconds, of the audio file.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.setFinishCallback" class="openblock item method">
<div class="title">playdate.sound.fileplayer:setFinishCallback(func, [arg])</div>
<div class="content">
<div class="paragraph">
<p>Sets a function to be called when playback has completed. The fileplayer is passed as the first argument to <em>func</em>. The optional argument <em>arg</em> is passed as the second.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.didUnderrun" class="openblock item method">
<div class="title">playdate.sound.fileplayer:didUnderrun()</div>
<div class="content">
<div class="paragraph">
<p>Returns the fileplayer&#8217;s underrun flag, indicating that the player ran out of data. This can be checked in the finish callback function to check for an underrun error.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.setStopOnUnderrun" class="openblock item method">
<div class="title">playdate.sound.fileplayer:setStopOnUnderrun(flag)</div>
<div class="content">
<div class="paragraph">
<p>By default, if the fileplayer runs out of data it does not stop playback but instead restarts (after an audible stutter) as soon as data becomes available. Setting the flag to <em>true</em> changes this behavior so that it stops playback and calls the fileplayer&#8217;s <a href="#m-sound.fileplayer.setFinishCallback">finish callback</a>, if set.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.setLoopRange" class="openblock item method">
<div class="title">playdate.sound.fileplayer:setLoopRange(start, [end, [loopCallback, [arg]]])</div>
<div class="content">
<div class="paragraph">
<p>Provides a way to loop a portion of an audio file. In the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">fp</span> = playdate.sound.fileplayer.new( <span class="string"><span class="delimiter">&quot;</span><span class="content">myaudiofile</span><span class="delimiter">&quot;</span></span> )
fp:setLoopRange( <span class="integer">10</span>, <span class="integer">20</span> )
fp:play( <span class="integer">3</span> )</code></pre>
</div>
</div>
<div class="paragraph">
<p>…the fileplayer will start playing from the beginning of the audio file, loop the 10-20 second range three times, and then stop playing.</p>
</div>
<div class="paragraph">
<p><em>start</em> and <em>end</em> are specified in seconds. If <em>end</em> is omitted, the end of the file is used. If the function <em>loopCallback</em> is provided, it is called every time the player loops, with the fileplayer as the first argument and the optional <em>arg</em> argument as the second.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
The <a href="#m-sound.fileplayer.play">fileplayer:play([repeatCount])</a> call needs to be invoked with a <em>repeatCount</em> value of 0 (infinite looping), or 2 or greater in order for the looping action to happen.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-sound.fileplayer.setLoopCallback" class="openblock item method">
<div class="title">playdate.sound.fileplayer:setLoopCallback(callback, [arg])</div>
<div class="content">
<div class="paragraph">
<p>Sets a function to be called every time the fileplayer loops. The fileplayer object is passed to this function as the first argument, and <em>arg</em> as the second.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
The <a href="#m-sound.fileplayer.play">fileplayer:play([repeatCount])</a> call needs to be invoked with a <em>repeatCount</em> value of 0 (infinite looping), or 2 or greater in order for the loop callback to be invoked.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-sound.fileplayer.setBufferSize" class="openblock item method">
<div class="title">playdate.sound.fileplayer:setBufferSize(seconds)</div>
<div class="content">
<div class="paragraph">
<p>Sets the buffer size for the fileplayer, in seconds. Larger buffers protect against buffer underruns, but consume more memory. Calling this function also fills the output buffer if a source file has been set. On success, the function returns <em>true</em>; otherwise it returns <em>false</em> and a string describing the error.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.setRate" class="openblock item method">
<div class="title">playdate.sound.fileplayer:setRate(rate)</div>
<div class="content">
<div class="paragraph">
<p>Sets the playback rate for the file. 1.0 is normal speed, 0.5 is down an octave, 2.0 is up an octave, etc. Unlike sampleplayers, fileplayers can&#8217;t play in reverse (i.e., rate &lt; 0).</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.getRate" class="openblock item method">
<div class="title">playdate.sound.fileplayer:getRate()</div>
<div class="content">
<div class="paragraph">
<p>Returns the playback rate for the file. as set with <code>setRate()</code>.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.setRateMod" class="openblock item method">
<div class="title">playdate.sound.fileplayer:setRateMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets the <a href="#C-sound.signal">signal</a> to use as a rate modulator, added to the rate set with <a href="#m-sound.fileplayer.setRate">playdate.sound.fileplayer:setRate()</a>.  Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.setVolume" class="openblock item method">
<div class="title">playdate.sound.fileplayer:setVolume(left, [right, [fadeSeconds, [fadeCallback, [arg]]]])</div>
<div class="content">
<div class="paragraph">
<p>Sets the playback volume (0.0 - 1.0). If a single value is passed in, both left side and right side volume are set to the given value. If two values are given, volumes are set separately. The optional <em>fadeSeconds</em> specifies the time it takes to fade from the current volume to the specified volume, in seconds. If the function <em>fadeCallback</em> is given, it is called when the volume fade has completed. The fileplayer object is passed as the first argument to the callback, and the optional <em>arg</em> argument is passed as the second.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.getVolume" class="openblock item method">
<div class="title">playdate.sound.fileplayer:getVolume()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current volume for the fileplayer, a single value for mono sources or a pair of values (left, right) for stereo sources.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.setOffset" class="openblock item method">
<div class="title">playdate.sound.fileplayer:setOffset(seconds)</div>
<div class="content">
<div class="paragraph">
<p>Sets the current offset of the fileplayer, in seconds. This value is not adjusted for rate.</p>
</div>
</div>
</div>
<div id="m-sound.fileplayer.getOffset" class="openblock item method">
<div class="title">playdate.sound.fileplayer:getOffset()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current offset of the fileplayer, in seconds. This value is not adjusted for rate.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.sample">Sample</h4>
<div class="paragraph">
<p>playdate.sound.sample is an abstraction of an individual sound sample.  If all you want to do is play
a single sound sample, you may wish to use <a href="#C-sound.sampleplayer">playdate.sound.sampleplayer</a> instead. However,
playdate.sound.sample exists so you can preload sounds and swap them in and out without fragmenting device memory.</p>
</div>
<div id="f-sound.sample.new-path" class="openblock item function">
<div class="title">playdate.sound.sample.new(path)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.sound.sample object, with the sound data loaded in memory. If the sample can&#8217;t be loaded, the function returns nil and a second value containing the error.</p>
</div>
</div>
</div>
<div id="f-sound.sample.new" class="openblock item function">
<div class="title">playdate.sound.sample.new(seconds, [format])</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.sound.sample object, with a buffer size of <em>seconds</em> in the given format. If <em>format</em> is not specified, it defaults to <a href="#m-sound.sample.getFormat">playdate.sound.kFormat16bitStereo</a>. When used with playdate.sound.sample:load(), this allows you to swap in a different sample without re-allocating the buffer, which could lead to memory fragmentation.</p>
</div>
</div>
</div>
<div id="m-sound.sample.getSubsample" class="openblock item method">
<div class="title">playdate.sound.sample:getSubsample(startOffset, endOffset)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new subsample containing a subrange of the given sample. Offset values are in frames, not bytes.</p>
</div>
</div>
</div>
<div id="m-sound.sample.load" class="openblock item method">
<div class="title">playdate.sound.sample:load(path)</div>
<div class="content">
<div class="paragraph">
<p>Loads the sound data from the file at <em>path</em> into an existing sample buffer. If there is no file at <em>path</em>, the function returns nil.</p>
</div>
</div>
</div>
<div id="m-sound.sample.decompress" class="openblock item method">
<div class="title">playdate.sound.sample:decompress()</div>
<div class="content">
<div class="paragraph">
<p>If the sample is ADPCM compressed, decompresses the sample data to 16-bit PCM data. This increases the sample&#8217;s memory footprint by 4x and does not affect the quality in any way, but it is necessary if you want to use the sample in a synth or play the file backwards. Returns <code>true</code> if successful, or <code>false</code> and an error message as a second return value if decompression failed.</p>
</div>
</div>
</div>
<div id="m-sound.sample.getSampleRate" class="openblock item method">
<div class="title">playdate.sound.sample:getSampleRate()</div>
<div class="content">
<div class="paragraph">
<p>Returns the sample rate as an integer, such as 44100 or 22050.</p>
</div>
</div>
</div>
<div id="m-sound.sample.getFormat" class="openblock item method">
<div class="title">playdate.sound.sample:getFormat()</div>
<div class="content">
<div class="paragraph">
<p>Returns the format of the sample, one of</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>playdate.sound.kFormat8bitMono</em></p>
</li>
<li>
<p><em>playdate.sound.kFormat8bitStereo</em></p>
</li>
<li>
<p><em>playdate.sound.kFormat16bitMono</em></p>
</li>
<li>
<p><em>playdate.sound.kFormat16bitStereo</em></p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-sound.sample.getLength" class="openblock item method">
<div class="title">playdate.sound.sample:getLength()</div>
<div class="content">
<div class="paragraph">
<p>Returns two values, the length of the available sample data and the size of the allocated buffer. Both values are measured in seconds. For a sample loaded from disk, these will be the same; for a sample used for recording, the available data may be less than the allocated size.</p>
</div>
</div>
</div>
<div id="m-sound.sample.play" class="openblock item method">
<div class="title">playdate.sound.sample:play([repeatCount], [rate])</div>
<div class="content">
<div class="paragraph">
<p>Convenience function: Creates a new sampleplayer for the sample and passes the function arguments to its <a href="#m-sound.sampleplayer.play">play</a> function.</p>
</div>
</div>
</div>
<div id="m-sound.sample.playAt" class="openblock item method">
<div class="title">playdate.sound.sample:playAt(when, [vol], [rightvol], [rate])</div>
<div class="content">
<div class="paragraph">
<p>Convenience function: Creates a new sampleplayer for the sample and passes the function arguments to its <a href="#m-sound.sampleplayer.playAt">playAt</a> function.</p>
</div>
</div>
</div>
<div id="m-sound.sample.save" class="openblock item method">
<div class="title">playdate.sound.sample:save(filename)</div>
<div class="content">
<div class="paragraph">
<p>Saves the sample to the given file. If <code>filename</code> has a <code>.wav</code> extension it will be saved in WAV format (and be unreadable by the Playdate sound functions), otherwise it will be saved in the Playdate pda format.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.channel">Channel</h4>
<div class="paragraph">
<p>Channels are collections of sources (<a href="#C-sound.synth">synths</a>, <a href="#C-sound.sampleplayer">sampleplayers</a>, and <a href="#C-sound.fileplayer">fileplayers</a>) with a list of effects to apply to the sounds, and pan and volume parameters.</p>
</div>
<div id="f-sound.channel.new" class="openblock item function">
<div class="title">playdate.sound.channel.new()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new channel object and adds it to the global list.</p>
</div>
</div>
</div>
<div id="m-sound.channel.remove" class="openblock item method">
<div class="title">playdate.sound.channel:remove()</div>
<div class="content">
<div class="paragraph">
<p>Removes the channel from the global list.</p>
</div>
</div>
</div>
<div id="m-sound.channel.addEffect" class="openblock item method">
<div class="title">playdate.sound.channel:addEffect(effect)</div>
<div class="content">
<div class="paragraph">
<p>Adds an <a href="#C-sound.effect">effect</a> to the channel.</p>
</div>
</div>
</div>
<div id="m-sound.channel.removeEffect" class="openblock item method">
<div class="title">playdate.sound.channel:removeEffect(effect)</div>
<div class="content">
<div class="paragraph">
<p>Removes an <a href="#C-sound.effect">effect</a> from the channel.</p>
</div>
</div>
</div>
<div id="m-sound.channel.addSource" class="openblock item method">
<div class="title">playdate.sound.channel:addSource(source)</div>
<div class="content">
<div class="paragraph">
<p>Adds a <a href="#C-sound.source">source</a> to the channel. If a source is not assigned to a channel, it plays on the default global channel.</p>
</div>
</div>
</div>
<div id="m-sound.channel.removeSource" class="openblock item method">
<div class="title">playdate.sound.channel:removeSource(source)</div>
<div class="content">
<div class="paragraph">
<p>Removes a <a href="#C-sound.source">source</a> from the channel.</p>
</div>
</div>
</div>
<div id="m-sound.channel.setVolume" class="openblock item method">
<div class="title">playdate.sound.channel:setVolume(volume)</div>
<div class="content">
<div class="paragraph">
<p>Sets the volume (0.0 - 1.0) for the channel.</p>
</div>
</div>
</div>
<div id="m-sound.channel.getVolume" class="openblock item method">
<div class="title">playdate.sound.channel:getVolume()</div>
<div class="content">
<div class="paragraph">
<p>Gets the volume (0.0 - 1.0) for the channel.</p>
</div>
</div>
</div>
<div id="m-sound.channel.setPan" class="openblock item method">
<div class="title">playdate.sound.channel:setPan(pan)</div>
<div class="content">
<div class="paragraph">
<p>Sets the pan parameter for the channel. -1 is left, 0 is center, and 1 is right.</p>
</div>
</div>
</div>
<div id="m-sound.channel.setPanMod" class="openblock item method">
<div class="title">playdate.sound.channel:setPanMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to automate the pan parameter. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.channel.setVolumeMod" class="openblock item method">
<div class="title">playdate.sound.channel:setVolumeMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to automate the volume parameter. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.channel.getDryLevelSignal" class="openblock item method">
<div class="title">playdate.sound.channel:getDryLevelSignal()</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-sound.signal">signal</a> that follows the volume of the channel before effects are applied.</p>
</div>
</div>
</div>
<div id="m-sound.channel.getWetLevelSignal" class="openblock item method">
<div class="title">playdate.sound.channel:getWetLevelSignal()</div>
<div class="content">
<div class="paragraph">
<p>Returns a <a href="#C-sound.signal">signal</a> that follows the volume of the channel after effects are applied.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.source">Source</h4>
<div class="paragraph">
<p><em>playdate.sound.source</em> is the parent class of our sound sources, <a href="#C-sound.fileplayer">playdate.sound.fileplayer</a>, <a href="#C-sound.sampleplayer">playdate.sound.sampleplayer</a>, <a href="#C-sound.synth">playdate.sound.synth</a>, and <a href="#C-sound.instrument">playdate.sound.instrument</a>.</p>
</div>
<div id="f-sound.playingSources" class="openblock item function">
<div class="title">playdate.sound.playingSources()</div>
<div class="content">
<div class="paragraph">
<p>Returns a list of all sources currently playing.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.synth">Synth</h4>
<div id="f-sound.synth.new_w" class="openblock item function">
<div class="title">playdate.sound.synth.new([waveform])</div>
<div class="content">
<div class="paragraph">
<p>Returns a new synth object to play a waveform or wavetable. See <a href="#m-sound.synth.setWaveform">playdate.sound.synth:setWaveform</a> for <code>waveform</code> values.</p>
</div>
</div>
</div>
<div id="f-sound.synth.new" class="openblock item function">
<div class="title">playdate.sound.synth.new(sample, [sustainStart, sustainEnd])</div>
<div class="content">
<div class="paragraph">
<p>Returns a new synth object to play a <a href="#C-sound.sample">Sample</a>. Sample data must be uncompressed PCM, not ADPCM. An optional sustain region (measured in sample frames) defines a loop to play while the note is active. When the note ends, if an envelope has been set on the synth and the sustain range goes to the end of the sample (i.e. there&#8217;s no release section of the sample after the sustain range) then the sustain section continues looping during the envelope release; otherwise it plays through the end of the sample and stops. As a convenience, if <code>sustainStart</code> is greater than zero and <code>sustainEnd</code> isn&#8217;t given, it will be set to the length of the sample.</p>
</div>
</div>
</div>
<div id="m-sound.synth.copy" class="openblock item method">
<div class="title">playdate.sound.synth:copy()</div>
<div class="content">
<div class="paragraph">
<p>Returns a copy of the given synth.</p>
</div>
</div>
</div>
<div id="m-sound.synth.playNote" class="openblock item method">
<div class="title">playdate.sound.synth:playNote(pitch, [volume, [length, [when]]])</div>
<div class="content">
<div class="paragraph">
<p>Plays a note with the current waveform or sample.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>pitch</em>: the pitch value is in Hertz. If a sample is playing, pitch=261.63 (C4) plays at normal speed</p>
<div class="ulist">
<ul>
<li>
<p>in either function, a string like <code>Db3</code> can be used instead of a number</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>volume</em>: 0 to 1, defaults to 1</p>
</li>
<li>
<p><em>length</em>: in seconds. If omitted, note will play until you call noteOff()</p>
</li>
<li>
<p><em>when</em>: seconds since the sound engine started (see <a href="#f-sound.getCurrentTime">playdate.sound.getCurrentTime</a>). Defaults to the current time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function returns true if the synth was successfully added to the sound channel, otherwise false (i.e., if the channel is full).</p>
</div>
<div class="paragraph">
<p>If <em>pitch</em> is zero, this function calls <code>noteOff()</code> instead of potentially adding a non-zero sample, or DC offset, to the output.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Synths currently only have a buffer of one note event. If you call <em>playNote()</em> while another note is waiting to play, it will replace that note. To create a sequence of notes to play over a period of time, see <a href="#C-sound.sequence">playdate.sound.sequence</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="m-sound.synth.playMIDINote" class="openblock item method">
<div class="title">playdate.sound.synth:playMIDINote(note, [volume, [length, [when]]])</div>
<div class="content">
<div class="paragraph">
<p>Identical to <a href="#m-sound.synth.playNote">playNote</a> but uses a note name like "C4", or MIDI note number (60=C4, 61=C#4, etc.). In the latter case, fractional values are allowed.</p>
</div>
</div>
</div>
<div id="m-sound.synth.noteOff" class="openblock item method">
<div class="title">playdate.sound.synth:noteOff()</div>
<div class="content">
<div class="paragraph">
<p>Releases the note, if one is playing. The note will continue to be voiced through the release section of the synth&#8217;s envelope.</p>
</div>
</div>
</div>
<div id="m-sound.synth.stop" class="openblock item method">
<div class="title">playdate.sound.synth:stop()</div>
<div class="content">
<div class="paragraph">
<p>Stops the synth immediately, without playing the release part of the envelope.</p>
</div>
</div>
</div>
<div id="m-sound.synth.isPlaying" class="openblock item method">
<div class="title">playdate.sound.synth:isPlaying()</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the synth is still playing, including the release phase of the envelope.</p>
</div>
</div>
</div>
<div id="m-sound.synth.setAmplitudeMod" class="openblock item method">
<div class="title">playdate.sound.synth:setAmplitudeMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets the <a href="#C-sound.signal">signal</a> to use as the amplitude modulator. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.synth.setADSR" class="openblock item method">
<div class="title">playdate.sound.synth:setADSR(attack, decay, sustain, release)</div>
<div class="content">
<div class="paragraph">
<p>Sets the attack time, decay time, sustain level, and release time for the sound envelope, and optionally the <a href="#m-sound.synth.setEnvelopeCurvature">curvature</a>.</p>
</div>
</div>
</div>
<div id="m-sound.synth.setAttack" class="openblock item method">
<div class="title">playdate.sound.synth:setAttack(time)</div>
<div class="content">
<div class="paragraph">
<p>Sets the attack time, in seconds.</p>
</div>
</div>
</div>
<div id="m-sound.synth.setDecay" class="openblock item method">
<div class="title">playdate.sound.synth:setDecay(time)</div>
<div class="content">
<div class="paragraph">
<p>Sets the decay time, in seconds.</p>
</div>
</div>
</div>
<div id="m-sound.synth.setSustain" class="openblock item method">
<div class="title">playdate.sound.synth:setSustain(level)</div>
<div class="content">
<div class="paragraph">
<p>Sets the sustain level, as a proportion of the total level (0.0 to 1.0).</p>
</div>
</div>
</div>
<div id="m-sound.synth.setRelease" class="openblock item method">
<div class="title">playdate.sound.synth:setRelease(time)</div>
<div class="content">
<div class="paragraph">
<p>Sets the release time, in seconds.</p>
</div>
</div>
</div>
<div id="m-sound.synth.clearEnvelope" class="openblock item method">
<div class="title">playdate.sound.synth:clearEnvelope()</div>
<div class="content">
<div class="paragraph">
<p>Clears the synth&#8217;s envelope settings.</p>
</div>
</div>
</div>
<div id="m-sound.synth.setEnvelopeCurvature" class="openblock item method">
<div class="title">playdate.sound.synth:setEnvelopeCurvature(amount)</div>
<div class="content">
<div class="paragraph">
<p>Smoothly changes the envelope&#8217;s shape from linear (amount=0) to exponential (amount=1).</p>
</div>
</div>
</div>
<div id="m-sound.synth.getEnvelope" class="openblock item method">
<div class="title">playdate.sound.synth:getEnvelope()</div>
<div class="content">
<div class="paragraph">
<p>Returns the synth&#8217;s envelope as a <a href="#C-sound.envelope">playdate.sound.envelope</a> object.</p>
</div>
</div>
</div>
<div id="m-sound.synth.setFinishCallback" class="openblock item method">
<div class="title">playdate.sound.synth:setFinishCallback(function)</div>
<div class="content">
<div class="paragraph">
<p>Sets a function to be called when the synth stops playing.</p>
</div>
</div>
</div>
<div id="m-sound.synth.setFrequencyMod" class="openblock item method">
<div class="title">playdate.sound.synth:setFrequencyMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets the <a href="#C-sound.signal">signal</a> to use as the frequency modulator. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.synth.setLegato" class="openblock item method">
<div class="title">playdate.sound.synth:setLegato(flag)</div>
<div class="content">
<div class="paragraph">
<p>Sets whether to use legato phrasing for the synth. If the legato flag is set and a new note starts while a previous note is still playing, the synth&#8217;s envelope remains in the sustain phase instead of starting a new attack.</p>
</div>
</div>
</div>
<div id="m-sound.synth.setVolume" class="openblock item method">
<div class="title">playdate.sound.synth:setVolume(left, [right])</div>
<div class="content">
<div class="paragraph">
<p>Sets the synth volume. If a single value is passed in, sets both left side and right side volume to the given value. If two values are given, volumes are set separately.</p>
</div>
<div class="paragraph">
<p>Volume values are between 0.0 and 1.0.</p>
</div>
</div>
</div>
<div id="m-sound.synth.getVolume" class="openblock item method">
<div class="title">playdate.sound.synth:getVolume()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current volume for the synth, a single value for mono sources or a pair of values (left, right) for stereo sources.</p>
</div>
<div class="paragraph">
<p>Volume values are between 0.0 and 1.0.</p>
</div>
</div>
</div>
<div id="m-sound.synth.setWaveform" class="openblock item method">
<div class="title">playdate.sound.synth:setWaveform(waveform)</div>
<div class="content">
<div class="paragraph">
<p>Sets the waveform or <a href="#C-sound.sample">Sample</a> the synth plays. If a sample is given, its data must be uncompressed PCM, not ADPCM. Otherwise <em>waveform</em> should be one of the following constants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="k-sound.kWaveSine"></a> <em class="constant">playdate.sound.kWaveSine</em></p>
</li>
<li>
<p><a id="k-sound.kWaveSquare"></a> <em class="constant">playdate.sound.kWaveSquare</em></p>
</li>
<li>
<p><a id="k-sound.kWaveSawtooth"></a> <em class="constant">playdate.sound.kWaveSawtooth</em></p>
</li>
<li>
<p><a id="k-sound.kWaveTriangle"></a> <em class="constant">playdate.sound.kWaveTriangle</em></p>
</li>
<li>
<p><a id="k-sound.kWaveNoise"></a> <em class="constant">playdate.sound.kWaveNoise</em></p>
</li>
<li>
<p><a id="k-sound.kWavePOPhase"></a> <em class="constant">playdate.sound.kWavePOPhase</em></p>
</li>
<li>
<p><a id="k-sound.kWavePODigital"></a> <em class="constant">playdate.sound.kWavePODigital</em></p>
</li>
<li>
<p><a id="k-sound.kWavePOVosim"></a> <em class="constant">playdate.sound.kWavePOVosim</em></p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-sound.synth.setWavetable" class="openblock item method">
<div class="title">playdate.sound.synth:setWavetable(sample, samplesize, xsize, [ysize])</div>
<div class="content">
<div class="paragraph">
<p>Sets a wavetable for the synth to play. Sample data must be 16-bit mono uncompressed. <code>samplesize</code> is the number of samples in each waveform "cell" in the table and must be a power of 2. <code>xsize</code> is the number of cells across the wavetable. If the wavetable is two-dimensional, <code>ysize</code> gives the number of cells in the y direction.</p>
</div>
<div class="paragraph">
<p>The synth&#8217;s "position" in the wavetable is set manually with <a href="#m-sound.synth.setParameter">setParameter()</a> or automated with <a href="#m-sound.synth.setParameterMod">setParameterMod()</a>. In some cases it&#8217;s easier to use a parameter that matches the waveform position in the table, in others (notably when using envelopes and lfos) it&#8217;s more convenient to use a 0-1 scale, so there&#8217;s some redundancy here. Parameters are</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1: x position, values are from 0 to the table width</p>
</li>
<li>
<p>2: x position, values are from 0 to 1, parameter is scaled up to table width</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For 2-D tables (<code>rowwidth</code> &gt; 0):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>3: y position, values are from 0 to the table height</p>
</li>
<li>
<p>4: y position, values are from 0 to 1, parameter is scaled up to table height</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_synth_parameters">Synth parameters</h5>
<div class="paragraph">
<p>Some synth types have parameters that can be set manually or driven by a signal, such as an envelope or LFO. On the square waveform the single parameter changes the pulse width; the PO synths have 2 parameters each, changing various aspects of the generator algorithm; and wavetable synths have up to four, <a href="#m-sound.synth.setWavetable">described above</a>.</p>
</div>
<div id="m-sound.synth.setParameter" class="openblock item method">
<div class="title">playdate.sound.synth:setParameter(parameter, value)</div>
<div class="content">
<div class="paragraph">
<p>Sets the parameter at (1-based) position <em>num</em> to the given value. Unless otherwise specified, <em>value</em> ranges from 0 to 1.</p>
</div>
</div>
</div>
<div id="m-sound.synth.setParameterMod" class="openblock item method">
<div class="title">playdate.sound.synth:setParameterMod(parameter, signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets the <a href="#C-sound.signal">signal</a> to modulate the parameter. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.signal">Signal</h4>
<div class="paragraph">
<p><em>playdate.sound.signal</em> is the parent class of our low-frequency signals, <a href="#C-sound.lfo">playdate.sound.lfo</a>, <a href="#C-sound.envelope">playdate.sound.envelope</a>, and <a href="#C-sound.controlsignal">playdate.sound.controlsignal</a>. These can be used to automate certain parameters in the audio engine.</p>
</div>
<div id="f-sound.signal.setOffset" class="openblock item method">
<div class="title">playdate.sound.signal:setOffset(offset)</div>
<div class="content">
<div class="paragraph">
<p>Adds a constant offset to the signal (lfo, envelope, etc.).</p>
</div>
</div>
</div>
<div id="f-sound.signal.setScale" class="openblock item method">
<div class="title">playdate.sound.signal:setScale(scale)</div>
<div class="content">
<div class="paragraph">
<p>Multiplies the signal&#8217;s output by the given scale factor. The scale is applied before the offset.</p>
</div>
</div>
</div>
<div id="f-sound.signal.getValue" class="openblock item method">
<div class="title">playdate.sound.signal:getValue()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current output value of the signal.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.lfo">LFO</h4>
<div id="f-sound.lfo.new" class="openblock item function">
<div class="title">playdate.sound.lfo.new([type])</div>
<div class="content">
<div class="paragraph">
<p>Returns a new LFO object, which can be used to modulate sounds. See <a href="#m-sound.lfo.setType">playdate.sound.lfo:setType()</a> for LFO types.</p>
</div>
</div>
</div>
<div id="m-sound.lfo.setType" class="openblock item method">
<div class="title">playdate.sound.lfo:setType(type)</div>
<div class="content">
<div class="paragraph">
<p>Sets the waveform of the LFO. Valid values are</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="k-sound.kLFOSquare"></a> <em class="constant">playdate.sound.kLFOSquare</em></p>
</li>
<li>
<p><a id="k-sound.kLFOSawtoothUp"></a> <em class="constant">playdate.sound.kLFOSawtoothUp</em></p>
</li>
<li>
<p><a id="k-sound.kLFOSawtoothDown"></a> <em class="constant">playdate.sound.kLFOSawtoothDown</em></p>
</li>
<li>
<p><a id="k-sound.kLFOTriangle"></a> <em class="constant">playdate.sound.kLFOTriangle</em></p>
</li>
<li>
<p><a id="k-sound.kLFOSine"></a> <em class="constant">playdate.sound.kLFOSine</em></p>
</li>
<li>
<p><a id="k-sound.kLFOSampleAndHold"></a> <em class="constant">playdate.sound.kLFOSampleAndHold</em></p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-sound.lfo.setArpeggio" class="openblock item method">
<div class="title">playdate.sound.lfo:setArpeggio(note1, ...)</div>
<div class="content">
<div class="paragraph">
<p>Sets the LFO type to arpeggio, where the given values are in half-steps from the center note. For example, the sequence (0, 4, 7, 12) plays the notes of a major chord.</p>
</div>
</div>
</div>
<div id="m-sound.lfo.setCenter" class="openblock item method">
<div class="title">playdate.sound.lfo:setCenter(center)<br>playdate.sound.lfo:setOffset(center)</div>
<div class="content">
<div class="paragraph">
<p>Sets the center value of the LFO.</p>
</div>
</div>
</div>
<div id="m-sound.lfo.setDepth" class="openblock item method">
<div class="title">playdate.sound.lfo:setDepth(depth)<br>playdate.sound.lfo:setScale(depth)</div>
<div class="content">
<div class="paragraph">
<p>Sets the depth of the LFO’s modulation.</p>
</div>
</div>
</div>
<div id="m-sound.lfo.setRate" class="openblock item method">
<div class="title">playdate.sound.lfo:setRate(rate)</div>
<div class="content">
<div class="paragraph">
<p>Sets the rate of the LFO, in cycles per second.</p>
</div>
</div>
</div>
<div id="m-sound.lfo.setPhase" class="openblock item method">
<div class="title">playdate.sound.lfo:setPhase(phase)</div>
<div class="content">
<div class="paragraph">
<p>Sets the current phase of the LFO, from 0 to 1.</p>
</div>
</div>
</div>
<div id="m-sound.lfo.setStartPhase" class="openblock item method">
<div class="title">playdate.sound.lfo:setStartPhase(phase)</div>
<div class="content">
<div class="paragraph">
<p>Sets the initial phase of the LFO, from 0 to 1.</p>
</div>
</div>
</div>
<div id="m-sound.lfo.setGlobal" class="openblock item method">
<div class="title">playdate.sound.lfo:setGlobal(flag)</div>
<div class="content">
<div class="paragraph">
<p>If an LFO is marked global, it is continuously updated whether or not it&#8217;s attached to any source.</p>
</div>
</div>
</div>
<div id="m-sound.lfo.setRetrigger" class="openblock item method">
<div class="title">playdate.sound.lfo:setRetrigger(flag)</div>
<div class="content">
<div class="paragraph">
<p>If retrigger is on, the LFO&#8217;s phase is reset to its initial phase (default 0) when a synth using the LFO starts playing a note.</p>
</div>
</div>
</div>
<div id="m-sound.lfo.setDelay" class="openblock item method">
<div class="title">playdate.sound.lfo:setDelay(holdoff, ramp)</div>
<div class="content">
<div class="paragraph">
<p>Sets an initial holdoff time for the LFO where the LFO remains at its center value, and a ramp time where the value increases linearly to its maximum depth. Values are in seconds.</p>
</div>
</div>
</div>
<div id="f-sound.lfo.getValue" class="openblock item method">
<div class="title">playdate.sound.lfo:getValue()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current signal value of the LFO.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.envelope">Envelope</h4>
<div id="f-sound.envelope.new" class="openblock item function">
<div class="title">playdate.sound.envelope.new([attack, decay, sustain, release])</div>
<div class="content">
<div class="paragraph">
<p>Creates a new envelope with the given (optional) parameters.</p>
</div>
</div>
</div>
<div id="m-sound.envelope.setAttack" class="openblock item method">
<div class="title">playdate.sound.envelope:setAttack(attack)</div>
<div class="content">
<div class="paragraph">
<p>Sets the envelope attack time to <em>attack</em>, in seconds.</p>
</div>
</div>
</div>
<div id="m-sound.envelope.setDecay" class="openblock item method">
<div class="title">playdate.sound.envelope:setDecay(decay)</div>
<div class="content">
<div class="paragraph">
<p>Sets the envelope decay time to <em>decay</em>, in seconds.</p>
</div>
</div>
</div>
<div id="m-sound.envelope.setSustain" class="openblock item method">
<div class="title">playdate.sound.envelope:setSustain(sustain)</div>
<div class="content">
<div class="paragraph">
<p>Sets the envelope sustain level to <em>sustain</em>, as a proportion of the maximum. For example, if the sustain level is 0.5, the signal value rises to its full value over the attack phase of the envelope, then drops to half its maximum over the decay phase, and remains there while the envelope is active.</p>
</div>
</div>
</div>
<div id="m-sound.envelope.setRelease" class="openblock item method">
<div class="title">playdate.sound.envelope:setRelease(release)</div>
<div class="content">
<div class="paragraph">
<p>Sets the envelope release time to <em>release</em>, in seconds.</p>
</div>
</div>
</div>
<div id="m-sound.envelope.setCurvature" class="openblock item method">
<div class="title">playdate.sound.envelope:setCurvature(amount)</div>
<div class="content">
<div class="paragraph">
<p>Smoothly changes the envelope&#8217;s shape from linear (amount=0) to exponential (amount=1).</p>
</div>
</div>
</div>
<div id="m-sound.envelope.setVelocitySensitivity" class="openblock item method">
<div class="title">playdate.sound.envelope:setVelocitySensitivity(amount)</div>
<div class="content">
<div class="paragraph">
<p>Changes the amount by which note velocity scales output level. At the default value of 1, output is proportional to velocity; at 0 velocity has no effect on output level.</p>
</div>
</div>
</div>
<div id="m-sound.envelope.setRateScaling" class="openblock item method">
<div class="title">playdate.sound.envelope:setRateScaling(scaling, [start, end])</div>
<div class="content">
<div class="paragraph">
<p>Scales the envelope rate according to the played note. For notes below <code>start</code>, the envelope&#8217;s set rate is used; for notes above <code>end</code> envelope rates are scaled by the <code>scaling</code> parameter. Between the two notes the scaling factor is interpolated from 1.0 to <code>scaling</code>. <code>start</code> and <code>end</code> are either MIDI note numbers or names like "C4". If omitted, the default range is C1 (36) to C5 (84).</p>
</div>
</div>
</div>
<div id="m-sound.envelope.setScale" class="openblock item method">
<div class="title">playdate.sound.envelope:setScale(scale)</div>
<div class="content">
<div class="paragraph">
<p>Sets the scale value for the envelope. The transformed envelope has an initial value of <em>offset</em> and a maximum (minimum if <em>scale</em> is negative) of <em>offset</em> + <em>scale</em>.</p>
</div>
</div>
</div>
<div id="m-sound.envelope.setOffset" class="openblock item method">
<div class="title">playdate.sound.envelope:setOffset(offset)</div>
<div class="content">
<div class="paragraph">
<p>Sets the offset value for the envelope. The transformed envelope has an initial value of <em>offset</em> and a maximum (minimum if <em>scale</em> is negative) of <em>offset</em> + <em>scale</em>.</p>
</div>
</div>
</div>
<div id="m-sound.envelope.setLegato" class="openblock item method">
<div class="title">playdate.sound.envelope:setLegato(flag)</div>
<div class="content">
<div class="paragraph">
<p>Sets whether to use legato phrasing for the envelope. If the legato flag is set, when the envelope is re-triggered before it&#8217;s released, it remains in the sustain phase instead of jumping back to the attack phase.</p>
</div>
</div>
</div>
<div id="m-sound.envelope.setRetrigger" class="openblock item method">
<div class="title">playdate.sound.envelope:setRetrigger(flag)</div>
<div class="content">
<div class="paragraph">
<p>If retrigger is on, the envelope always starts from 0 when a note starts playing, instead of the current value if it&#8217;s active.</p>
</div>
</div>
</div>
<div id="m-sound.envelope.trigger" class="openblock item method">
<div class="title">playdate.sound.envelope:trigger(velocity, [length])</div>
<div class="content">
<div class="paragraph">
<p>Triggers the envelope at the given <em>velocity</em>. If a <em>length</em> parameter is given, the envelope moves to the release phase after the given time. Otherwise, the envelope is held in the sustain phase until the trigger function is called again with <em>velocity</em> equal to zero.</p>
</div>
</div>
</div>
<div id="m-sound.envelope.setGlobal" class="openblock item method">
<div class="title">playdate.sound.envelope:setGlobal(flag)</div>
<div class="content">
<div class="paragraph">
<p>If an envelope is marked global, it is continuously updated whether or not it&#8217;s attached to any source.</p>
</div>
</div>
</div>
<div id="f-sound.envelope.getValue" class="openblock item method">
<div class="title">playdate.sound.envelope:getValue()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current signal value of the envelope.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.effect">Effects</h4>
<div class="paragraph">
<p><em>playdate.sound.effect</em> is the parent class of our sound effects, <a href="#C-sound.bitcrusher">playdate.sound.bitcrusher</a>, <a href="#C-sound.twopolefilter">playdate.sound.twopolefilter</a>, <a href="#C-sound.onepolefilter">playdate.sound.onepolefilter</a>, <a href="#C-sound.ringmod">playdate.sound.ringmod</a>, <a href="#C-sound.overdrive">playdate.sound.overdrive</a>, and <a href="#C-sound.delayline">playdate.sound.delayline</a></p>
</div>
<div id="f-sound.addEffect" class="openblock item function">
<div class="title">playdate.sound.addEffect(effect)</div>
<div class="content">
<div class="paragraph">
<p>Adds the given <a href="#C-sound.effect">playdate.sound.effect</a> to the default sound channel.</p>
</div>
</div>
</div>
<div id="f-sound.removeEffect" class="openblock item function">
<div class="title">playdate.sound.removeEffect(effect)</div>
<div class="content">
<div class="paragraph">
<p>Removes the given effect from the default sound channel.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.bitcrusher">Bitcrusher</h4>
<div id="f-sound.bitcrusher.new" class="openblock item function">
<div class="title">playdate.sound.bitcrusher.new()</div>
<div class="content">
<div class="paragraph">
<p>Creates a new bitcrusher filter.</p>
</div>
</div>
</div>
<div id="m-sound.bitcrusher.setMix" class="openblock item method">
<div class="title">playdate.sound.bitcrusher:setMix(level)</div>
<div class="content">
<div class="paragraph">
<p>Sets the wet/dry mix for the effect. A level of 1 (full wet) replaces the input with the effect output; 0 leaves the effect out of the mix.</p>
</div>
</div>
</div>
<div id="m-sound.bitcrusher.setMixMod" class="openblock item method">
<div class="title">playdate.sound.bitcrusher:setMixMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the mix level. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.bitcrusher.setAmount" class="openblock item method">
<div class="title">playdate.sound.bitcrusher:setAmount(amt)</div>
<div class="content">
<div class="paragraph">
<p>Sets the amount of crushing to <em>amt</em>. Valid values are 0 (no effect) to 1 (quantizing output to 1-bit).</p>
</div>
</div>
</div>
<div id="m-sound.bitcrusher.setAmountMod" class="openblock item method">
<div class="title">playdate.sound.bitcrusher:setAmountMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the filter level. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.bitcrusher.setUndersampling" class="openblock item method">
<div class="title">playdate.sound.bitcrusher:setUndersampling(amt)</div>
<div class="content">
<div class="paragraph">
<p>Sets the number of samples to repeat; 0 is no undersampling, 1 effectively halves the sample rate.</p>
</div>
</div>
</div>
<div id="m-sound.bitcrusher.setUndersamplingMod" class="openblock item method">
<div class="title">playdate.sound.bitcrusher:setUndersamplingMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the filter level. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.ringmod">Ring Modulator</h4>
<div id="f-sound.ringmod.new" class="openblock item function">
<div class="title">playdate.sound.ringmod.new()</div>
<div class="content">
<div class="paragraph">
<p>Creates a new ring modulator filter.</p>
</div>
</div>
</div>
<div id="m-sound.ringmod.setMix" class="openblock item method">
<div class="title">playdate.sound.ringmod:setMix(level)</div>
<div class="content">
<div class="paragraph">
<p>Sets the wet/dry mix for the effect. A level of 1 (full wet) replaces the input with the effect output; 0 leaves the effect out of the mix.</p>
</div>
</div>
</div>
<div id="m-sound.ringmod.setMixMod" class="openblock item method">
<div class="title">playdate.sound.ringmod:setMixMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the mix level. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.ringmod.setFrequency" class="openblock item method">
<div class="title">playdate.sound.ringmod:setFrequency(f)</div>
<div class="content">
<div class="paragraph">
<p>Sets the ringmod frequency to <em>f</em>.</p>
</div>
</div>
</div>
<div id="m-sound.ringmod.setFrequencyMod" class="openblock item method">
<div class="title">playdate.sound.ringmod:setFrequencyMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the ringmod frequency. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.onepolefilter">One pole filter</h4>
<div class="paragraph">
<p>The one pole filter is a simple low/high pass filter, with a single parameter describing the cutoff frequency: values above 0 (up to 1) are high-pass, values below 0 (down to -1) are low-pass.</p>
</div>
<div id="f-sound.onepolefilter.new" class="openblock item function">
<div class="title">playdate.sound.onepolefilter.new()</div>
<div class="content">
<div class="paragraph">
<p>Returns a new one pole filter.</p>
</div>
</div>
</div>
<div id="m-sound.onepolefilter.setMix" class="openblock item method">
<div class="title">playdate.sound.onepolefilter:setMix(level)</div>
<div class="content">
<div class="paragraph">
<p>Sets the wet/dry mix for the effect. A level of 1 (full wet) replaces the input with the effect output; 0 leaves the effect out of the mix.</p>
</div>
</div>
</div>
<div id="m-sound.onepolefilter.setMixMod" class="openblock item method">
<div class="title">playdate.sound.onepolefilter:setMixMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the mix level. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.onepolefilter.setParameter" class="openblock item method">
<div class="title">playdate.sound.onepolefilter:setParameter(p)</div>
<div class="content">
<div class="paragraph">
<p>Sets the filter&#8217;s single parameter (cutoff frequency) to <em>p</em>.</p>
</div>
</div>
</div>
<div id="m-sound.onepolefilter.setParameterMod" class="openblock item method">
<div class="title">playdate.sound.onepolefilter:setParameterMod(m)</div>
<div class="content">
<div class="paragraph">
<p>Sets a modulator for the filter&#8217;s parameter. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.twopolefilter">Two pole filter</h4>
<div id="f-sound.twopolefilter.new" class="openblock item function">
<div class="title">playdate.sound.twopolefilter.new(type)</div>
<div class="content">
<div class="paragraph">
<p>Creates a new two pole IIR filter of the given <em>type</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="k-sound.twopolefilter.kFilterLowPass"></a> <em class="constant">playdate.sound.kFilterLowPass</em> (or the string "lowpass" or "lopass")</p>
</li>
<li>
<p><a id="k-sound.twopolefilter.kFilterHighPass"></a> <em class="constant">playdate.sound.kFilterHighPass</em> (or "highpass" or "hipass")</p>
</li>
<li>
<p><a id="k-sound.twopolefilter.kFilterBandPass"></a> <em class="constant">playdate.sound.kFilterBandPass</em> (or "bandpass")</p>
</li>
<li>
<p><a id="k-sound.twopolefilter.kFilterNotch"></a> <em class="constant">playdate.sound.kFilterNotch</em> (or "notch")</p>
</li>
<li>
<p><a id="k-sound.twopolefilter.kFilterPEQ"></a> <em class="constant">playdate.sound.kFilterPEQ</em> (or "peq")</p>
</li>
<li>
<p><a id="k-sound.twopolefilter.kFilterLowShelf"></a> <em class="constant">playdate.sound.kFilterLowShelf</em> (or "lowshelf" or "loshelf")</p>
</li>
<li>
<p><a id="k-sound.twopolefilter.kFilterHighShelf"></a> <em class="constant">playdate.sound.kFilterHighShelf</em> (or "highshelf" or "hishelf")</p>
</li>
</ul>
</div>
</div>
</div>
<div id="m-sound.twopolefilter.setMix" class="openblock item method">
<div class="title">playdate.sound.twopolefilter:setMix(level)</div>
<div class="content">
<div class="paragraph">
<p>Sets the wet/dry mix for the effect. A level of 1 (full wet) replaces the input with the effect output; 0 leaves the effect out of the mix.</p>
</div>
</div>
</div>
<div id="m-sound.twopolefilter.setMixMod" class="openblock item method">
<div class="title">playdate.sound.twopolefilter:setMixMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the mix level. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.twopolefilter.setFrequency" class="openblock item method">
<div class="title">playdate.sound.twopolefilter:setFrequency(f)</div>
<div class="content">
<div class="paragraph">
<p>Sets the center frequency (in Hz) of the filter to <em>f</em>.</p>
</div>
</div>
</div>
<div id="m-sound.twopolefilter.setFrequencyMod" class="openblock item method">
<div class="title">playdate.sound.twopolefilter:setFrequencyMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the filter frequency. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.twopolefilter.setResonance" class="openblock item method">
<div class="title">playdate.sound.twopolefilter:setResonance(r)</div>
<div class="content">
<div class="paragraph">
<p>Sets the resonance of the filter to <em>r</em>. Valid values are in the range 0-1. This parameter has no effect on shelf type filters.</p>
</div>
</div>
</div>
<div id="m-sound.twopolefilter.setResonanceMod" class="openblock item method">
<div class="title">playdate.sound.twopolefilter:setResonanceMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the filter resonance. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.twopolefilter.setGain" class="openblock item method">
<div class="title">playdate.sound.twopolefilter:setGain(g)</div>
<div class="content">
<div class="paragraph">
<p>Sets the gain of the filter to <em>g</em>. Gain is only used in PEQ and shelf type filters.</p>
</div>
</div>
</div>
<div id="m-sound.twopolefilter.setType" class="openblock item method">
<div class="title">playdate.sound.twopolefilter:setType(type)</div>
<div class="content">
<div class="paragraph">
<p>Sets the type of the filter to <em>type</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.overdrive">Overdrive</h4>
<div id="f-sound.overdrive.new" class="openblock item function">
<div class="title">playdate.sound.overdrive.new()</div>
<div class="content">
<div class="paragraph">
<p>Creates a new overdrive effect.</p>
</div>
</div>
</div>
<div id="m-sound.overdrive.setMix" class="openblock item method">
<div class="title">playdate.sound.overdrive:setMix(level)</div>
<div class="content">
<div class="paragraph">
<p>Sets the wet/dry mix for the effect. A level of 1 (full wet) replaces the input with the effect output; 0 leaves the effect out of the mix.</p>
</div>
</div>
</div>
<div id="m-sound.overdrive.setMixMod" class="openblock item method">
<div class="title">playdate.sound.overdrive:setMixMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the mix level. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.overdrive.setGain" class="openblock item method">
<div class="title">playdate.sound.overdrive:setGain(level)</div>
<div class="content">
<div class="paragraph">
<p>Sets the gain of the filter.</p>
</div>
</div>
</div>
<div id="m-sound.overdrive.setLimit" class="openblock item method">
<div class="title">playdate.sound.overdrive:setLimit(level)</div>
<div class="content">
<div class="paragraph">
<p>Sets the level where the amplified input clips.</p>
</div>
</div>
</div>
<div id="m-sound.overdrive.setLimitMod" class="openblock item method">
<div class="title">playdate.sound.overdrive:setLimitMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the limit level. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.overdrive.setOffset" class="openblock item method">
<div class="title">playdate.sound.overdrive:setOffset(level)</div>
<div class="content">
<div class="paragraph">
<p>Adds an offset to the upper and lower limits to create an asymmetric clipping.</p>
</div>
</div>
</div>
<div id="m-sound.overdrive.setOffsetMod" class="openblock item method">
<div class="title">playdate.sound.overdrive:setOffsetMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the offset value. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.delayline">Delay line</h4>
<div id="f-sound.delayline.new" class="openblock item function">
<div class="title">playdate.sound.delayline.new(length)</div>
<div class="content">
<div class="paragraph">
<p>Creates a new delay line effect, with the given length (in seconds).</p>
</div>
</div>
</div>
<div id="m-sound.delayline.setMix" class="openblock item method">
<div class="title">playdate.sound.delayline:setMix(level)</div>
<div class="content">
<div class="paragraph">
<p>Sets the wet/dry mix for the effect. A level of 1 (full wet) replaces the input with the effect output; 0 leaves the effect out of the mix, which is useful if you&#8217;re using taps for varying delays.</p>
</div>
</div>
</div>
<div id="m-sound.delayline.setMixMod" class="openblock item method">
<div class="title">playdate.sound.delayline:setMixMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the mix level. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.delayline.addTap" class="openblock item method">
<div class="title">playdate.sound.delayline:addTap(delay)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new <a href="#C-sound.delaylinetap">playdate.sound.delaylinetap</a> on the delay line, at the given delay (which must be less than or equal to the delay line&#8217;s length).</p>
</div>
</div>
</div>
<div id="m-sound.delayline.setFeedback" class="openblock item method">
<div class="title">playdate.sound.delayline:setFeedback(level)</div>
<div class="content">
<div class="paragraph">
<p>Sets the feedback level of the delay line.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.delaylinetap">Delay line tap</h4>
<div class="paragraph">
<p><em>playdate.sound.delaylinetap</em> is a subclass of <em>playdate.sound.source</em>. Note that a tap can be added to any channel, not just the channel the tap&#8217;s delay line is on.</p>
</div>
<div id="m-sound.delaylinetap.setDelay" class="openblock item method">
<div class="title">playdate.sound.delaylinetap:setDelay(time)</div>
<div class="content">
<div class="paragraph">
<p>Sets the position of the tap on the delay line, up to the delay line&#8217;s length.</p>
</div>
</div>
</div>
<div id="m-sound.delaylinetap.setDelayMod" class="openblock item method">
<div class="title">playdate.sound.delaylinetap:setDelayMod(signal)</div>
<div class="content">
<div class="paragraph">
<p>Sets a <a href="#C-sound.signal">signal</a> to modulate the tap delay. If the signal is continuous (e.g. an envelope or a triangle LFO, but not a square LFO) playback is sped up or slowed down to compress or expand time. Set to <em>nil</em> to clear the modulator.</p>
</div>
</div>
</div>
<div id="m-sound.delaylinetap.setVolume" class="openblock item method">
<div class="title">playdate.sound.delaylinetap:setVolume(level)</div>
<div class="content">
<div class="paragraph">
<p>Sets the tap&#8217;s volume.</p>
</div>
</div>
</div>
<div id="m-sound.delaylinetap.getVolume" class="openblock item method">
<div class="title">playdate.sound.delaylinetap:getVolume()</div>
<div class="content">
<div class="paragraph">
<p>Returns the tap&#8217;s volume.</p>
</div>
</div>
</div>
<div id="m-sound.delaylinetap.setFlipChannels" class="openblock item method">
<div class="title">playdate.sound.delaylinetap:setFlipChannels(flag)</div>
<div class="content">
<div class="paragraph">
<p>If set and the delay line is stereo, the tap outputs the delay line&#8217;s left channel to its right output and vice versa.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.sequence">Sequence</h4>
<div id="f-sound.sequence.new" class="openblock item function">
<div class="title">playdate.sound.sequence.new([midi_path])</div>
<div class="content">
<div class="paragraph">
<p>Creates a new sound sequence. If <code>midi_path</code> is given, it attempts to load data from the midi file into the sequence.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.play" class="openblock item method">
<div class="title">playdate.sound.sequence:play([finishCallback])</div>
<div class="content">
<div class="paragraph">
<p>Starts playing the sequence. <code>finishCallback</code> is an optional function to be called when the sequence finishes playing or is stopped. The sequence is passed to the callback as its single argument.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.stop" class="openblock item method">
<div class="title">playdate.sound.sequence:stop()</div>
<div class="content">
<div class="paragraph">
<p>Stops playing the sequence.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.isPlaying" class="openblock item method">
<div class="title">playdate.sound.sequence:isPlaying()</div>
<div class="content">
<div class="paragraph">
<p>Returns true if the sequence is currently playing.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.getLength" class="openblock item method">
<div class="title">playdate.sound.sequence:getLength()</div>
<div class="content">
<div class="paragraph">
<p>Returns the length of the longest track in the sequence, in steps. See also <a href="#m-sound.track.getLength">playdate.sound.track.getLength()</a>.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.goToStep" class="openblock item method">
<div class="title">playdate.sound.sequence:goToStep(step, [play])</div>
<div class="content">
<div class="paragraph">
<p>Moves the play position for the sequence to step number <code>step</code>. If <code>play</code> is set, triggers the notes at that step.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.getCurrentStep" class="openblock item method">
<div class="title">playdate.sound.sequence:getCurrentStep()</div>
<div class="content">
<div class="paragraph">
<p>Returns the step number the sequence is currently at.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.setTempo" class="openblock item method">
<div class="title">playdate.sound.sequence:setTempo(stepsPerSecond)</div>
<div class="content">
<div class="paragraph">
<p>Sets the tempo of the sequence, in steps per second.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.getTempo" class="openblock item method">
<div class="title">playdate.sound.sequence:getTempo()</div>
<div class="content">
<div class="paragraph">
<p>Returns the tempo of the sequence, in steps per second.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.setLoops" class="openblock item method">
<div class="title">playdate.sound.sequence:setLoops(startStep, endStep, [loopCount])</div>
<div class="content">
<div class="paragraph">
<p>Sets the looping range of the sequence. If <em>loops</em> is 0 or unset, the loop repeats endlessly.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.setLoops-2" class="openblock item method">
<div class="title">playdate.sound.sequence:setLoops(loopCount)</div>
<div class="content">
<div class="paragraph">
<p>Same as above, with startStep set to 0 and endStep set to <code>sequence:getLength()</code>.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.getTrackCount" class="openblock item method">
<div class="title">playdate.sound.sequence:getTrackCount()</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of tracks in the sequence.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.addTrack" class="openblock item method">
<div class="title">playdate.sound.sequence:addTrack([track])</div>
<div class="content">
<div class="paragraph">
<p>Adds the given <a href="#C-sound.track">playdate.sound.track</a> to the sequence. If <code>track</code> omitted, the function creates and returns a new track.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.setTrackAtIndex" class="openblock item method">
<div class="title">playdate.sound.sequence:setTrackAtIndex(n, track)</div>
<div class="content">
<div class="paragraph">
<p>Sets the given <a href="#C-sound.track">playdate.sound.track</a> object at position <code>n</code> in the sequence.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.getTrackAtIndex" class="openblock item method">
<div class="title">playdate.sound.sequence:getTrackAtIndex(n)</div>
<div class="content">
<div class="paragraph">
<p>Returns the <a href="#C-sound.track">playdate.sound.track</a> object at position <code>n</code> in the sequence.</p>
</div>
</div>
</div>
<div id="m-sound.sequence.allNotesOff" class="openblock item method">
<div class="title">playdate.sound.sequence:allNotesOff()</div>
<div class="content">
<div class="paragraph">
<p>Sends an <a href="#m-sound.instrument.allNotesOff">allNotesOff()</a> message to each track&#8217;s instrument.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.track">Track</h4>
<div id="f-sound.track.new" class="openblock item function">
<div class="title">playdate.sound.track.new()</div>
<div class="content">
<div class="paragraph">
<p>Creates a new <code>playdate.sound.track</code> object.</p>
</div>
</div>
</div>
<div id="m-sound.track.addNote2" class="openblock item method">
<div class="title">playdate.sound.track:addNote(step, note, length, [velocity]) <br> playdate.sound.track:addNote(table)</div>
<div class="content">
<div class="paragraph">
<p>Adds a single note event to the track, letting you specify <code>step</code>, <code>note</code>, <code>length</code>, and <code>velocity</code> directly. The second format allows you to pack them into a table, using the format returned by <a href="#m-sound.track.getNotes">getNotes()</a>. The <code>note</code> argument can be a MIDI note number or a note name like "Db3". <code>length</code> is the length of the note in steps, not time&#8212;&#8203;that is, it follows the sequence&#8217;s tempo. The default velocity is 1.0.</p>
</div>
<div class="paragraph">
<p>See <a href="#m-sound.track.setNotes">setNotes()</a> for the ability to add more than one note at a time.</p>
</div>
</div>
</div>
<div id="m-sound.track.setNotes" class="openblock item method">
<div class="title">playdate.sound.track:setNotes(list)</div>
<div class="content">
<div class="paragraph">
<p>Set multiple notes at once, each array element should be a table containing values for the keys The tables contain values for keys <code>step</code>, <code>note</code>, <code>length</code>, and <code>velocity</code>.</p>
</div>
</div>
</div>
<div id="m-sound.track.getNotes" class="openblock item method">
<div class="title">playdate.sound.track:getNotes([step], [endstep])</div>
<div class="content">
<div class="paragraph">
<p>Returns an array of tables representing the note events in the track.</p>
</div>
<div class="paragraph">
<p>The tables contain values for keys <code>step</code>, <code>note</code>, <code>length</code>, and <code>velocity</code>. If <code>step</code> is given, the function returns only the notes at that step; if both <code>step</code> and <code>endstep</code> are set, it returns the notes between the two steps (including notes at endstep). n.b. The <code>note</code> field in the event tables is always a MIDI note number value, even if the note was added using the string notation.</p>
</div>
</div>
</div>
<div id="m-sound.track.removeNote" class="openblock item method">
<div class="title">playdate.sound.track:removeNote(step, note)</div>
<div class="content">
<div class="paragraph">
<p>Removes the note event at <em>step</em> playing <em>note</em>.</p>
</div>
</div>
</div>
<div id="m-sound.track.clearNotes" class="openblock item method">
<div class="title">playdate.sound.track:clearNotes()</div>
<div class="content">
<div class="paragraph">
<p>Clears all notes from the track.</p>
</div>
</div>
</div>
<div id="m-sound.track.getLength" class="openblock item method">
<div class="title">playdate.sound.track:getLength()</div>
<div class="content">
<div class="paragraph">
<p>Returns the length, in steps, of the track&#8212;&#8203;that is, the step where the last note in the track ends.</p>
</div>
</div>
</div>
<div id="m-sound.track.getNotesActive" class="openblock item method">
<div class="title">playdate.sound.track:getNotesActive()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current number of notes active in the track.</p>
</div>
</div>
</div>
<div id="m-sound.track.getPolyphony" class="openblock item method">
<div class="title">playdate.sound.track:getPolyphony()</div>
<div class="content">
<div class="paragraph">
<p>Returns the maximum number of notes simultaneously active in the track. (Known bug: this currently only works for midi files)</p>
</div>
</div>
</div>
<div id="m-sound.track.setInstrument" class="openblock item method">
<div class="title">playdate.sound.track:setInstrument(inst)</div>
<div class="content">
<div class="paragraph">
<p>Sets the <a href="#C-sound.instrument">playdate.sound.instrument</a> that this track plays. If <code>inst</code> is a <a href="#C-sound.synth">playdate.sound.synth</a>, the function creates an instrument for the synth.</p>
</div>
</div>
</div>
<div id="m-sound.track.getInstrument" class="openblock item method">
<div class="title">playdate.sound.track:getInstrument()</div>
<div class="content">
<div class="paragraph">
<p>Gets the <a href="#C-sound.instrument">playdate.sound.instrument</a> that this track plays.</p>
</div>
</div>
</div>
<div id="m-sound.track.setMuted" class="openblock item method">
<div class="title">playdate.sound.track:setMuted(flag)</div>
<div class="content">
<div class="paragraph">
<p>Mutes or unmutes the track.</p>
</div>
</div>
</div>
<div id="m-sound.track.addControlSignal" class="openblock item method">
<div class="title">playdate.sound.track:addControlSignal(s)</div>
<div class="content">
<div class="paragraph">
<p>Adds a <a href="#C-sound.controlsignal">playdate.sound.controlsignal</a> object to the track. Note that the signal must be assigned to a modulation input for it to have any audible effect. The input can be anywhere in the sound engine&#8212;&#8203;it&#8217;s not required to belong to the track in any way.</p>
</div>
</div>
</div>
<div id="m-sound.track.getControlSignals" class="openblock item method">
<div class="title">playdate.sound.track:getControlSignals()</div>
<div class="content">
<div class="paragraph">
<p>Returns an array of <a href="#C-sound.controlsignal">playdate.sound.controlsignal</a> objects assigned to this track.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.instrument">Instrument</h4>
<div id="f-sound.instrument.new" class="openblock item function">
<div class="title">playdate.sound.instrument.new([synth])</div>
<div class="content">
<div class="paragraph">
<p>Creates a new <code>playdate.sound.instrument</code> object. If <code>synth</code> is given, adds it as a voice for the instrument.</p>
</div>
</div>
</div>
<div id="m-sound.instrument.addVoice" class="openblock item method">
<div class="title">playdate.sound.instrument:addVoice(v, [note], [rangeend], [transpose])</div>
<div class="content">
<div class="paragraph">
<p>Adds the given <a href="#C-sound.synth">playdate.sound.synth</a> to the instrument. If only the <em>note</em> argument is given, the voice is only used for that note, and is transposed to play at normal speed (i.e. rate=1.0 for samples, or C4 for synths). If <em>rangeend</em> is given, the voice is assigned to the range <em>note</em> to <em>rangeend</em>, inclusive, with the first note in the range transposed to rate=1.0/C4. The <code>note</code> and <code>rangeend</code> arguments can be MIDI note numbers or note names like "Db3". The final transpose argument transposes the note played, in half-tone units.</p>
</div>
</div>
</div>
<div id="m-sound.instrument.setPitchBend" class="openblock item method">
<div class="title">playdate.sound.instrument:setPitchBend(amount)</div>
<div class="content">
<div class="paragraph">
<p>Sets the pitch bend to be applied to the voices in the instrument, as a fraction of the full range.</p>
</div>
</div>
</div>
<div id="m-sound.instrument.setPitchBendRange" class="openblock item method">
<div class="title">playdate.sound.instrument:setPitchBendRange(halfsteps)</div>
<div class="content">
<div class="paragraph">
<p>Sets the pitch bend range for the voices in the instrument. The default range is 12, for a full octave.</p>
</div>
</div>
</div>
<div id="m-sound.instrument.setTranspose" class="openblock item method">
<div class="title">playdate.sound.instrument:setTranspose(halfsteps)</div>
<div class="content">
<div class="paragraph">
<p>Transposes all voices in the instrument. <em>halfsteps</em> can be a fractional value.</p>
</div>
</div>
</div>
<div id="m-sound.instrument.playNote" class="openblock item method">
<div class="title">playdate.sound.instrument:playNote(frequency, [vel], [length], [when])</div>
<div class="content">
<div class="paragraph">
<p>Plays the given note on the instrument. A string like <code>Db3</code> can be used instead of a pitch/note number. Fractional values are allowed. <em>vel</em> defaults to 1.0, fully on. If <em>length</em> isn&#8217;t specified, the note stays on until <em>instrument.noteOff(note)</em> is called. <em>when</em> is the number of seconds in the future to start playing the note, default is immediately.</p>
</div>
</div>
</div>
<div id="m-sound.instrument.playMIDINote" class="openblock item method">
<div class="title">playdate.sound.instrument:playMIDINote(note, [vel], [length], [when])</div>
<div class="content">
<div class="paragraph">
<p>Identical to <code>instrument:playNote()</code> but <em>note</em> is a MIDI note number: 60=C4, 61=C#4, etc. Fractional values are allowed.</p>
</div>
</div>
</div>
<div id="m-sound.instrument.noteOff" class="openblock item method">
<div class="title">playdate.sound.instrument:noteOff(note, [when])</div>
<div class="content">
<div class="paragraph">
<p>Stops the instrument voice playing note <em>note</em>. If <em>when</em> is given, the note is stopped <em>when</em> seconds in the future, otherwise it&#8217;s stopped immediately.</p>
</div>
</div>
</div>
<div id="m-sound.instrument.allNotesOff" class="openblock item method">
<div class="title">playdate.sound.instrument:allNotesOff()</div>
<div class="content">
<div class="paragraph">
<p>Sends a stop signal to all playing notes.</p>
</div>
</div>
</div>
<div id="m-sound.instrument.setVolume" class="openblock item method">
<div class="title">playdate.sound.instrument:setVolume(left, [right])</div>
<div class="content">
<div class="paragraph">
<p>Sets the instrument volume. If a single value is passed in, sets both left side and right side volume to the given value. If two values are given, volumes are set separately.</p>
</div>
<div class="paragraph">
<p>Volume values are between 0.0 and 1.0.</p>
</div>
</div>
</div>
<div id="m-sound.instrument.getVolume" class="openblock item method">
<div class="title">playdate.sound.instrument:getVolume()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current volume for the synth, a single value for mono sources or a pair of values (left, right) for stereo sources.</p>
</div>
<div class="paragraph">
<p>Volume values are between 0.0 and 1.0.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.controlsignal">Control Signal</h4>
<div id="f-sound.controlsignal.new" class="openblock item function">
<div class="title">playdate.sound.controlsignal.new()</div>
<div class="content">
<div class="paragraph">
<p>Creates a new control signal object, for automating effect parameters, channel pan and level, etc.</p>
</div>
</div>
</div>
<div id="v-sound.controlsignal.events" class="openblock item variable">
<div class="title">playdate.sound.controlsignal.events</div>
<div class="content">
<div class="paragraph">
<p>The signal&#8217;s event list is modified by getting and setting the <code>events</code> property of the object. This is an array of tables, each containing values for keys <code>step</code> and <code>value</code>, and optionally <code>interpolate</code>.</p>
</div>
</div>
</div>
<div id="m-sound.controlsignal.addEvent2" class="openblock item method">
<div class="title">playdate.sound.controlsignal:addEvent(step, value, [interpolate]) <br> playdate.sound.controlsignal:addEvent(event)</div>
<div class="content">
<div class="paragraph">
<p><code>addEvent</code> is a simpler way of adding events one at a time than setting the entire <em>events</em> table. Arguments are either the values themselves in the given order, or a table containing values for <code>step</code>, <code>value</code>, and optionally <code>interpolate</code>. If <code>interpolate</code> is set, the signal&#8217;s output value is linearly interpolated from <code>value</code> at step <code>step</code> to the next event&#8217;s value at its given step.</p>
</div>
</div>
</div>
<div id="m-sound.controlsignal.clearEvents" class="openblock item method">
<div class="title">playdate.sound.controlsignal:clearEvents()</div>
<div class="content">
<div class="paragraph">
<p>Clears all events from the control signal.</p>
</div>
</div>
</div>
<div id="m-sound.controlsignal.setControllerType" class="openblock item method">
<div class="title">playdate.sound.controlsignal:setControllerType(number)</div>
<div class="content">
<div class="paragraph">
<p>Sets the midi controller number for the control signal, if that&#8217;s something you want to do. The value has no effect on playback.</p>
</div>
</div>
</div>
<div id="m-sound.controlsignal.getControllerType" class="openblock item method">
<div class="title">playdate.sound.controlsignal:getControllerType()</div>
<div class="content">
<div class="paragraph">
<p>Control signals in midi files are assigned a controller number, which describes the intent of the control. This function returns the controller number.</p>
</div>
</div>
</div>
<div id="m-sound.controlsignal.setScale" class="openblock item method">
<div class="title">playdate.sound.controlsignal:setScale(scale)</div>
<div class="content">
<div class="paragraph">
<p>Sets the scale value for the control signal.</p>
</div>
</div>
</div>
<div id="m-sound.controlsignal.setOffset" class="openblock item method">
<div class="title">playdate.sound.controlsignal:setOffset(offset)</div>
<div class="content">
<div class="paragraph">
<p>Sets the offset value for the control signal.</p>
</div>
</div>
</div>
<div id="f-sound.controlsignal.getValue" class="openblock item method">
<div class="title">playdate.sound.controlsignal:getValue()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current output value of the control signal.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mic_input">Mic Input</h4>
<div id="f-sound.micinput.recordToSample" class="openblock item function">
<div class="title">playdate.sound.micinput.recordToSample(buffer, completionCallback)</div>
<div class="content">
<div class="paragraph">
<p><code>buffer</code> should be a <a href="#C-sound.sample">Sample</a> created with the following code, with <em>secondsToRecord</em> replaced by a number specifying the record duration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">buffer</span> = playdate.sound.sample.new(_secondsToRecord_, playdate.sound.kFormat16bitMono)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>completionCallback</code> is a function called at the end of recording, when the buffer is full. It has one argument, the recorded sample. To override the device&#8217;s headset detection and force recording from either the internal mic or a headset mic or line in connected to a headset splitter, first call <a href="#f-sound.micinput.startListening">playdate.sound.micinput.startListening()</a> with the required source. <code>recordToSample()</code> returns <code>true</code> on success, <code>false</code> on error.</p>
</div>
</div>
</div>
<div id="f-sound.micinput.stopRecording" class="openblock item function">
<div class="title">playdate.sound.micinput.stopRecording()</div>
<div class="content">
<div class="paragraph">
<p>Stops a sample recording started with recordToSample, if it hasn&#8217;t already reached the end of the buffer. The recording&#8217;s completion callback is called immediately.</p>
</div>
</div>
</div>
<div id="f-sound.micinput.startListening" class="openblock item function">
<div class="title">playdate.sound.micinput.startListening([source])</div>
<div class="content">
<div class="paragraph">
<p>Starts monitoring the microphone input level. The optional <em>source</em> argument of "headset" or "device" causes the mic input to record from the given source. If no source is given, it uses the headset detection circuit to determine which source to use. The function returns the pair <code>true</code> and a string indicating which source it&#8217;s recording from on success, or <code>false</code> on error.</p>
</div>
</div>
</div>
<div id="f-sound.micinput.stopListening" class="openblock item function">
<div class="title">playdate.sound.micinput.stopListening()</div>
<div class="content">
<div class="paragraph">
<p>Stops monitoring the microphone input level.</p>
</div>
</div>
</div>
<div id="f-sound.micinput.getLevel" class="openblock item function">
<div class="title">playdate.sound.micinput.getLevel()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current microphone input level, a value from 0.0 (quietest) to 1.0 (loudest).</p>
</div>
</div>
</div>
<div id="f-sound.micinput.getSource" class="openblock item function">
<div class="title">playdate.sound.micinput.getSource()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current microphone input source, either "headset" or "device".</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.output">Audio Output</h4>
<div id="f-sound.getHeadphoneState" class="openblock item function xref">
<div class="title">playdate.sound.getHeadphoneState(changeCallback)</div>
<div class="content">
<div class="paragraph">
<p>Returns a pair of booleans (headphone, mic) indicating whether headphones are plugged in, and if so whether they have a microphone attached. If <em>changeCallback</em> is a function, it will be called every time the headphone state changes, until it is cleared by calling <code>playdate.sound.getHeadphoneState(nil)</code>. If a change callback is set, the audio does <strong>not</strong> automatically switch from speaker to headphones when headphones are plugged in (and vice versa), so the callback should use <code>playdate.sound.setOutputsActive()</code> to change the output if needed. The callback is passed two booleans, matching the return values from <code>getHeadphoneState()</code>: the first <code>true</code> if headphones are connect, and the second <code>true</code> if the headphones have a microphone.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-sound.getHeadphoneState"><code>playdate-&gt;sound-&gt;getHeadphoneState()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-sound.setOutputsActive" class="openblock item function xref">
<div class="title">playdate.sound.setOutputsActive(headphones, speaker)</div>
<div class="content">
<div class="paragraph">
<p>Forces sound to be played on the headphones or on the speaker, regardless of whether headphones are plugged in or not. (With the caveat that it is not actually possible to play on the headphones if they&#8217;re not plugged in.) This function has no effect in the Simulator.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-sound.setOutputsActive"><code>playdate-&gt;sound-&gt;setOutputsActive()</code></a> in the C API.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-sound.time">Audio Device Time</h4>
<div id="f-sound.getCurrentTime" class="openblock item function xref">
<div class="title">playdate.sound.getCurrentTime()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current time, in seconds, as measured by the audio device. The audio device uses its own time base in order to provide accurate timing.</p>
</div>
<div class="paragraph xref xref-c">
<p>Equivalent to <a href="./Inside%20Playdate%20with%20C.html#f-sound.getCurrentTime"><code>playdate-&gt;sound-&gt;getCurrentTime()</code></a> in the C API.</p>
</div>
</div>
</div>
<div id="f-sound.resetTime" class="openblock item function">
<div class="title">playdate.sound.resetTime()</div>
<div class="content">
<div class="paragraph">
<p>Resets the audio output device time counter.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 class">
<h3 id="C-string">7.29. Strings</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/string</em> to use these functions.
</td>
</tr>
</table>
</div>
<div id="f-string.UUID" class="openblock item function">
<div class="title">playdate.string.UUID(length)</div>
<div class="content">
<div class="paragraph">
<p>Generates a random string of uppercase letters</p>
</div>
</div>
</div>
<div id="f-string.trimWhitespace" class="openblock item function">
<div class="title">playdate.string.trimWhitespace(string)</div>
<div class="content">
<div class="paragraph">
<p>Returns a string with the whitespace removed from the beginning and ending of <em>string</em>.</p>
</div>
</div>
</div>
<div id="f-string.trimLeadingWhitespace" class="openblock item function">
<div class="title">playdate.string.trimLeadingWhitespace(string)</div>
<div class="content">
<div class="paragraph">
<p>Returns a string with the whitespace removed from the beginning of <em>string</em>.</p>
</div>
</div>
</div>
<div id="f-string.trimTrailingWhitespace" class="openblock item function">
<div class="title">playdate.string.trimTrailingWhitespace(string)</div>
<div class="content">
<div class="paragraph">
<p>Returns a string with the whitespace removed from the ending of <em>string</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect2 class">
<h3 id="C-timer">7.30. Timers</h3>
<div class="paragraph">
<p>playdate.timer provides a time-based timer useful for handling animation timings, countdowns, or performing tasks after a delay. For a frame-based timer see <a href="#C-frameTimer">playdate.frameTimer</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/timer</em> to use these functions. It is <em><em>also</em></em> to critical to call <a href="#f-timer.updateTimers">playdate.timer.updateTimers()</a> in your <a href="#c-update">playdate.update()</a> function to ensure that all timers are updated every frame.
</td>
</tr>
</table>
</div>
<div id="f-timer.updateTimers" class="openblock item function">
<div class="title">playdate.timer.updateTimers()</div>
<div class="content">
<div class="paragraph">
<p>This should be called from the main playdate.update() loop to drive the timers.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_standard_timers">Standard timers</h4>
<div id="f-timer.new" class="openblock item function">
<div class="title">playdate.timer.new(duration, callback, ...)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.timer that will run for <em>duration</em> milliseconds. <em>callback</em> is a function closure that will be called when the timer is complete.</p>
</div>
<div class="paragraph">
<p>Accepts a variable number of arguments that will be passed to the callback function when it is called. If arguments are not provided, the timer itself will be passed to the callback instead.</p>
</div>
<div class="paragraph">
<p>By default, timers start upon instantiation. To modify the behavior of a timer, see <a href="#C-commonTimerMethods">common timer methods</a> and <a href="#C-commonTimerProperties">properties</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_delay_timers">Delay timers</h4>
<div id="f-timer.performAfterDelay" class="openblock item function">
<div class="title">playdate.timer.performAfterDelay(delay, callback, ...)</div>
<div class="content">
<div class="paragraph">
<p>Performs the function <em>callback</em> after <em>delay</em> milliseconds. Accepts a variable number of arguments that will be passed to the callback function when it is called. If arguments are not provided, the timer itself will be passed to the callback instead.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_value_timers">Value timers</h4>
<div id="f-timer.new2" class="openblock item function">
<div class="title">playdate.timer.new(duration, [startValue, endValue, [easingFunction]])</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.timer that will run for <em>duration</em> milliseconds. If not specified, <em>startValue</em> and <em>endValue</em> will be 0, and a linear easing function will be used.</p>
</div>
<div class="paragraph">
<p>By default, timers start upon instantiation. To modify the behavior of a timer, see <a href="#C-commonTimerMethods">common timer methods</a> and <a href="#C-commonTimerProperties">properties</a>.</p>
</div>
</div>
</div>
<div id="v-timer.value" class="openblock item variable">
<div class="title">playdate.timer.value</div>
<div class="content">
<div class="paragraph">
<p>Current value calculated from the start and end values, the time elapsed, and the easing function.</p>
</div>
</div>
</div>
<div id="v-timer.easingFunction" class="openblock item variable">
<div class="title">playdate.timer.easingFunction</div>
<div class="content">
<div class="paragraph">
<p>The function used to calculate <em>value</em>. The function should be of the form <em>function(t, b, c, d)</em>, where <em>t</em> is elapsed time, <em>b</em> is the beginning value, <em>c</em> is the change (or end value - start value), and <em>d</em> is the duration.  Many such functions are available in <a href="#M-easingFunctions">playdate.easingFunctions</a>.</p>
</div>
</div>
</div>
<div id="v-timer.easingAmplitude" class="openblock item variable">
<div class="title">playdate.timer.easingAmplitude <br> playdate.timer.easingPeriod</div>
<div class="content">
<div class="paragraph">
<p>For <a href="#M-easingFunctions">easing functions</a> that take additional amplitude and period arguments (such as <em>inOutElastic</em>), set these to the desired values.</p>
</div>
</div>
</div>
<div id="v-timer.reverseEasingFunction" class="openblock item variable">
<div class="title">playdate.timer.reverseEasingFunction</div>
<div class="content">
<div class="paragraph">
<p>Set to provide an easing function to be used for the reverse portion of the timer. The function should be of the form <em>function(t, b, c, d)</em>, where <em>t</em> is elapsed time, <em>b</em> is the beginning value, <em>c</em> is the change (or end value - start value), and <em>d</em> is the duration.  Many such functions are available in <a href="#M-easingFunctions">playdate.easingFunctions</a>.</p>
</div>
</div>
</div>
<div id="v-timer.startValue" class="openblock item variable">
<div class="title">playdate.timer.startValue</div>
<div class="content">
<div class="paragraph">
<p>Start value used when calculating <em>value</em>.</p>
</div>
</div>
</div>
<div id="v-timer.endValue" class="openblock item variable">
<div class="title">playdate.timer.endValue</div>
<div class="content">
<div class="paragraph">
<p>End value used when calculating <em>value</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_key_repeat_timers">Key repeat timers</h4>
<div id="f-timer.keyRepeatTimer" class="openblock item function">
<div class="title">playdate.timer.keyRepeatTimer(callback, ...)</div>
<div class="content">
<div class="paragraph">
<p>Calls <code>keyRepeatTimerWithDelay()</code> below with standard values of <em>delayAfterInitialFiring</em> = 300 and <em>delayAfterSecondFiring</em> = 100.</p>
</div>
</div>
</div>
<div id="f-timer.keyRepeatTimerWithDelay" class="openblock item function">
<div class="title">playdate.timer.keyRepeatTimerWithDelay(delayAfterInitialFiring, delayAfterSecondFiring, callback, ...)</div>
<div class="content">
<div class="paragraph">
<p>returns a timer that fires at key-repeat intervals. The function <em>callback</em> will be called immediately, then again after <em>delayAfterInitialFiring</em> milliseconds, then repeatedly at <em>delayAfterSecondFiring</em> millisecond intervals.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Both functions accept any number of arguments; those arguments will be passed to the callback function when it is called. If arguments are not provided, the timer itself will be passed instead.</p>
</div>
<div class="listingblock">
<div class="title">Sample keyRepeatTimer callback</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">import <span class="string"><span class="delimiter">&quot;</span><span class="content">CoreLibs/timer</span><span class="delimiter">&quot;</span></span>

<span class="keyword">local</span> <span class="local-variable">keyTimer</span> = <span class="predefined-constant">nil</span>

<span class="keyword">function</span> playdate.<span class="function">BButtonDown</span>()
    <span class="keyword">local</span> <span class="keyword">function</span> <span class="function">timerCallback</span>()
        <span class="predefined">print</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">key repeat timer fired!</span><span class="delimiter">&quot;</span></span>)
    <span class="keyword">end</span>
    keyTimer = playdate.timer.keyRepeatTimer(timerCallback)
<span class="keyword">end</span>

<span class="keyword">function</span> playdate.<span class="function">BButtonUp</span>()
    keyTimer:remove()
<span class="keyword">end</span>

<span class="keyword">function</span> playdate.<span class="function">update</span>()
    playdate.timer.updateTimers()
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-commonTimerMethods">Common timer methods</h4>
<div id="m-timer.pause" class="openblock item method">
<div class="title">playdate.timer:pause()</div>
<div class="content">
<div class="paragraph">
<p>Pauses a timer. (There is no need to call :start() on a newly-instantiated timer: timers start automatically.)</p>
</div>
</div>
</div>
<div id="m-timer.start" class="openblock item method">
<div class="title">playdate.timer:start()</div>
<div class="content">
<div class="paragraph">
<p>Resumes a previously paused timer. There is no need to call :start() on a newly-instantiated timer: timers start automatically.</p>
</div>
</div>
</div>
<div id="m-timer.remove" class="openblock item method">
<div class="title">playdate.timer:remove()</div>
<div class="content">
<div class="paragraph">
<p>Removes this timer from the list of timers. This happens automatically when a non-repeating timer reaches its end, but you can use this method to dispose of timers manually.</p>
</div>
<div class="paragraph">
<p>Note that timers do not actually get removed until the next invocation of <a href="#f-timer.updateTimers">playdate.timer.updateTimers()</a>.</p>
</div>
</div>
</div>
<div id="m-timer.reset" class="openblock item method">
<div class="title">playdate.timer:reset()</div>
<div class="content">
<div class="paragraph">
<p>Resets a timer to its initial values.</p>
</div>
</div>
</div>
<div id="f-timer.allTimers" class="openblock item function">
<div class="title">playdate.timer.allTimers()</div>
<div class="content">
<div class="paragraph">
<p>Returns an array listing all running timers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Note the "." syntax rather than ":". This is a class method, not an instance method.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-commonTimerProperties">Common timer properties</h4>
<div id="v-timer.currentTime" class="openblock item variable">
<div class="title">playdate.timer.currentTime</div>
<div class="content">
<div class="paragraph">
<p>The number of milliseconds the timer has been running. Read-only.</p>
</div>
</div>
</div>
<div id="v-timer.delay" class="openblock item variable">
<div class="title">playdate.timer.delay</div>
<div class="content">
<div class="paragraph">
<p>Number of milliseconds to wait before starting the timer.</p>
</div>
</div>
</div>
<div id="v-timer.discardOnCompletion" class="openblock item variable">
<div class="title">playdate.timer.discardOnCompletion</div>
<div class="content">
<div class="paragraph">
<p>If true, the timer is discarded once it is complete. Defaults to true.</p>
</div>
</div>
</div>
<div id="v-timer.duration" class="openblock item variable">
<div class="title">playdate.timer.duration</div>
<div class="content">
<div class="paragraph">
<p>The number of milliseconds for which the timer will run.</p>
</div>
</div>
</div>
<div id="v-timer.timeLeft" class="openblock item variable">
<div class="title">playdate.timer.timeLeft</div>
<div class="content">
<div class="paragraph">
<p>The number of milliseconds remaining in the timer. Read-only.</p>
</div>
</div>
</div>
<div id="v-timer.paused" class="openblock item variable">
<div class="title">playdate.timer.paused</div>
<div class="content">
<div class="paragraph">
<p>If true, the timer will be paused. The update callback will not be called when the timer is paused. Can be set directly, or by using <code>playdate.timer:pause()</code> and <code>playdate.timer:start()</code>. Defaults to false.</p>
</div>
</div>
</div>
<div id="v-timer.repeats" class="openblock item variable">
<div class="title">playdate.timer.repeats</div>
<div class="content">
<div class="paragraph">
<p>If true, the timer starts over from the beginning when it completes. Defaults to false.</p>
</div>
</div>
</div>
<div id="v-timer.reverses" class="openblock item variable">
<div class="title">playdate.timer.reverses</div>
<div class="content">
<div class="paragraph">
<p>If true, the timer plays in reverse once it has completed. The time to complete both the forward and reverse will be <em>duration</em> x 2. Defaults to false.</p>
</div>
<div class="paragraph">
<p>Please note that <em>currentTime</em> will restart at 0 and count up to <em>duration</em> again when the reverse timer starts, but <em>value</em> will be calculated in reverse, from <em>endValue</em> to <em>startValue</em>. The same easing function (as opposed to the inverse of the easing function) will be used for the reverse timer unless an alternate is provided by setting <em>reverseEasingFunction</em>.</p>
</div>
</div>
</div>
<div id="c-timer.timerEndedCallback" class="openblock item callback">
<div class="title">playdate.timer.timerEndedCallback</div>
<div class="content">
<div class="paragraph">
<p>A Function of the form <em>function(timer)</em> or <em>function(...)</em> where "..." corresponds to the values in the table assigned to <em>timerEndedArgs</em>. Called when the timer has completed.</p>
</div>
</div>
</div>
<div id="v-timer.timerEndedArgs" class="openblock item variable">
<div class="title">playdate.timer.timerEndedArgs</div>
<div class="content">
<div class="paragraph">
<p>For repeating timers, this function will be called each time the timer completes, before it starts again.</p>
</div>
<div class="paragraph">
<p>An array-style table of values that will be passed to the <em>timerEndedCallback</em> function.</p>
</div>
</div>
</div>
<div id="c-timer.updateCallback" class="openblock item callback">
<div class="title">playdate.timer.updateCallback</div>
<div class="content">
<div class="paragraph">
<p>A callback function that will be called on every frame (every time <em>timer.updateAll()</em> is called). If the timer was created with arguments, those will be passed as arguments to the function provided. Otherwise, the timer is passed as the single argument.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_timer_sample_code">Timer sample code</h4>
<div class="paragraph">
<p>To count milliseconds, a simple timer can be created as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>t = playdate.timer.new(1000)</pre>
</div>
</div>
<div class="paragraph">
<p>The timer will begin running immediately. The current time can be read by looking at <em>t.currentTime</em>.</p>
</div>
<div class="paragraph">
<p>To transition between two values, set up a timer like:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>t = timer(500, 0, 100)</pre>
</div>
</div>
<div class="paragraph">
<p>If no easing function is provided as a fourth argument linear easing will be used. As the timer runs, you can access the current value by looking at <em>t.value</em>.</p>
</div>
<div class="paragraph">
<p>In both of these examples, the timer will be automatically discarded once it is finished. Set <em>discardOnCompletion</em> to false to keep the timer around for later reuse.</p>
</div>
<div class="paragraph">
<p>An example of setting up a bouncing ball animation (assuming the ball would be drawn elsewhere based on the rectangle <em>r</em>):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>local r = playdate.geometry.rect.new(100, 10, 40, 40)</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>local t = playdate.timer.new(1000, 10, 150, easingFunctions.inCubic)
t.reverses = true
t.repeats = true
t.reverseEasingFunction = easingFunctions.outQuad
t.updateCallback = function(timer)
	r.y = timer.value
end</pre>
</div>
</div>
</div>
</div>
<div class="sect2 class">
<h3 id="C-frameTimer">7.31. Frame timers</h3>
<div class="paragraph">
<p>A frame-based timer useful for handling frame-precise animation timings. For a time-based timer see <a href="#C-timer">playdate.timer</a> or <a href="#C-graphics.animation.loop">playdate.graphics.animation.loop</a></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/frameTimer</em> to use these functions. It is <em><em>also</em></em> to critical to call <a href="#f-timer.updateTimers">playdate.frameTimer.updateTimers()</a> in your <a href="#c-update">playdate.update()</a> function to ensure that all timers are updated every frame.
</td>
</tr>
</table>
</div>
<div id="f-frameTimer.updateTimers" class="openblock item function">
<div class="title">playdate.frameTimer.updateTimers()</div>
<div class="content">
<div class="paragraph">
<p>This should be called from the main playdate.update() loop to drive the frame timers.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_standard_frame_timers">Standard frame timers</h4>
<div id="f-frameTimer.new" class="openblock item function">
<div class="title">playdate.frameTimer.new(duration, callback, ...)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.frameTimer that will run for <em>duration</em> frames. <em>callback</em> is a function closure that will be called when the timer is complete.</p>
</div>
<div class="paragraph">
<p>Accepts a variable number of arguments that will be passed to the callback function when it is called. If arguments are not provided, the timer itself will be passed to the callback instead.</p>
</div>
<div class="paragraph">
<p>By default, frame timers start upon instantiation. To modify the behavior of a frame timer, see <a href="#C-commonFrameTimerMethods">common frame timer methods</a> and <a href="#C-commonFrameTimerProperties">properties</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_delay_frame_timers">Delay frame timers</h4>
<div id="f-frameTimer.performAfterDelay" class="openblock item function">
<div class="title">playdate.frameTimer.performAfterDelay(delay, callback, ...)</div>
<div class="content">
<div class="paragraph">
<p>Performs the function <em>callback</em> after the <em>delay</em> number of frames. Accepts a variable number of arguments that will be passed to the callback function when it is called. If arguments are not provided, the timer itself will be passed to the callback instead.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_value_frame_timers">Value frame timers</h4>
<div id="f-frameTimer.new-value" class="openblock item function">
<div class="title">playdate.frameTimer.new(duration, [startValue, endValue, [easingFunction]])</div>
<div class="content">
<div class="paragraph">
<p>Returns a new playdate.frameTimer that will run for <em>duration</em> number of frames. If not specified, <em>startValue</em> and <em>endValue</em> will be 0, and a linear easing function will be used.</p>
</div>
<div class="paragraph">
<p>By default, frame timers start upon instantiation. To modify the behavior of a frame timer, see <a href="#C-commonFrameTimerMethods">common frame timer methods</a> and <a href="#C-commonFrameTimerProperties">properties</a>.</p>
</div>
</div>
</div>
<div id="v-frameTimer.value" class="openblock item variable">
<div class="title">playdate.frameTimer.value</div>
<div class="content">
<div class="paragraph">
<p>Current value calculated from the start and end values, the current frame, and the easing function.</p>
</div>
</div>
</div>
<div id="v-frameTimer.startValue" class="openblock item variable">
<div class="title">playdate.frameTimer.startValue</div>
<div class="content">
<div class="paragraph">
<p>Start value used when calculating <em>value</em>.</p>
</div>
</div>
</div>
<div id="v-frameTimer.endValue" class="openblock item variable">
<div class="title">playdate.frameTimer.endValue</div>
<div class="content">
<div class="paragraph">
<p>End value used when calculating <em>value</em>.</p>
</div>
</div>
</div>
<div id="v-frameTimer.easingFunction" class="openblock item variable">
<div class="title">playdate.frameTimer.easingFunction</div>
<div class="content">
<div class="paragraph">
<p>The function used to calculate <em>value</em>. The function should be of the form <em>function(t, b, c, d)</em>, where <em>t</em> is elapsed time, <em>b</em> is the beginning value, <em>c</em> is the change (or <em>endValue - startValue</em>), and <em>d</em> is the duration.</p>
</div>
</div>
</div>
<div id="v-frameTimer.easingAmplitude" class="openblock item variable">
<div class="title">playdate.frameTimer.easingAmplitude <br> playdate.frameTimer.easingPeriod</div>
<div class="content">
<div class="paragraph">
<p>For easing functions in <em>CoreLibs/easing</em> that take additional amplitude and period arguments (such as <em>inOutElastic</em>), set these to desired values.</p>
</div>
</div>
</div>
<div id="v-frameTimer.reverseEasingFunction" class="openblock item variable">
<div class="title">playdate.frameTimer.reverseEasingFunction</div>
<div class="content">
<div class="paragraph">
<p>Set to provide an easing function to be used for the reverse portion of the timer. The function should be of the form <em>function(t, b, c, d)</em>, where <em>t</em> is elapsed time, <em>b</em> is the beginning value, <em>c</em> is the change (or <em>endValue - startValue</em>), and <em>d</em> is the duration.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-commonFrameTimerMethods">Common frame timer methods</h4>
<div id="m-frameTimer.pause" class="openblock item method">
<div class="title">playdate.frameTimer:pause()</div>
<div class="content">
<div class="paragraph">
<p>Pauses a timer.</p>
</div>
</div>
</div>
<div id="m-frameTimer.start" class="openblock item method">
<div class="title">playdate.frameTimer:start()</div>
<div class="content">
<div class="paragraph">
<p>Resumes a timer. There is no need to call :start() on a newly-instantiated frame timer: frame timers start automatically.</p>
</div>
</div>
</div>
<div id="m-frameTimer.remove" class="openblock item method">
<div class="title">playdate.frameTimer:remove()</div>
<div class="content">
<div class="paragraph">
<p>Removes this timer from the list of timers. This happens automatically when a non-repeating timer reaches it’s end, but you can use this method to dispose of timers manually.</p>
</div>
</div>
</div>
<div id="m-frameTimer.reset" class="openblock item method">
<div class="title">playdate.frameTimer:reset()</div>
<div class="content">
<div class="paragraph">
<p>Resets a timer to its initial values.</p>
</div>
</div>
</div>
<div id="f-frameTimer.allTimers" class="openblock item function">
<div class="title">playdate.frameTimer.allTimers()</div>
<div class="content">
<div class="paragraph">
<p>Returns an array listing all running frameTimers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Note the "." syntax rather than ":". This is a class method, not an instance method.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-commonFrameTimerProperties">Common frame timer properties</h4>
<div id="v-frameTimer.delay" class="openblock item variable">
<div class="title">playdate.frameTimer.delay</div>
<div class="content">
<div class="paragraph">
<p>Number of frames to wait before starting the timer.</p>
</div>
</div>
</div>
<div id="v-frameTimer.discardOnCompletion" class="openblock item variable">
<div class="title">playdate.frameTimer.discardOnCompletion</div>
<div class="content">
<div class="paragraph">
<p>If true, the timer is discarded once it is complete. Defaults to true.</p>
</div>
</div>
</div>
<div id="v-frameTimer.duration" class="openblock item variable">
<div class="title">playdate.frameTimer.duration</div>
<div class="content">
<div class="paragraph">
<p>The number of frames for which the timer will run.</p>
</div>
</div>
</div>
<div id="v-frameTimer.frame" class="openblock item variable">
<div class="title">playdate.frameTimer.frame</div>
<div class="content">
<div class="paragraph">
<p>The current frame.</p>
</div>
</div>
</div>
<div id="v-frameTimer.repeats" class="openblock item variable">
<div class="title">playdate.frameTimer.repeats</div>
<div class="content">
<div class="paragraph">
<p>If true, the timer starts over from the beginning when it completes. Defaults to false.</p>
</div>
</div>
</div>
<div id="v-frameTimer.reverses" class="openblock item variable">
<div class="title">playdate.frameTimer.reverses</div>
<div class="content">
<div class="paragraph">
<p>If true, the timer plays in reverse once it has completed. The number of frames to complete both the forward and reverse will be <em>duration x 2</em>. Defaults to false.</p>
</div>
<div class="paragraph">
<p>Please note that the frame counter will restart at 0 and count up to <em>duration</em> again when the reverse timer starts, but <em>value</em> will be calculated in reverse, from <em>endValue</em> to <em>startValue</em>. The same easing function (as opposed to the inverse of the easing function) will be used for the reverse timer unless an alternate is provided by setting <em>reverseEasingFunction</em>.</p>
</div>
</div>
</div>
<div id="c-frameTimer.timerEndedCallback" class="openblock item callback">
<div class="title">playdate.frameTimer.timerEndedCallback</div>
<div class="content">
<div class="paragraph">
<p>A Function of the form <em>function(timer)</em> or <em>function(...)</em> where "..." corresponds to the values in the table assigned to <em>timerEndedArgs</em>. Called when the timer has completed.</p>
</div>
</div>
</div>
<div id="v-frameTimer.timerEndedArgs" class="openblock item variable">
<div class="title">playdate.frameTimer.timerEndedArgs</div>
<div class="content">
<div class="paragraph">
<p>For repeating timers, this function will be called each time the timer completes, before it starts again.</p>
</div>
<div class="paragraph">
<p>An array-style table of values that will be passed to the <em>timerEndedCallback</em> function.</p>
</div>
</div>
</div>
<div id="c-frameTimer.updateCallback" class="openblock item callback">
<div class="title">playdate.frameTimer.updateCallback</div>
<div class="content">
<div class="paragraph">
<p>A function to be called on every frame update. If the frame timer was created with arguments, those will be passed as arguments to the function provided. Otherwise, the timer is passed as the single argument.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_frame_timer_sample_code">Frame timer sample code</h4>
<div class="paragraph">
<p>To count frames a simple timer can be created as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">t = playdate.frameTimer.new(<span class="integer">200</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The timer will begin running immediately, and the current frame can be read by looking at <em>t.frame</em>.</p>
</div>
<div class="paragraph">
<p>To transition between two values, set up a timer like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua">t = FrameTimer(<span class="integer">50</span>, <span class="integer">0</span>, <span class="integer">100</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If no easing function is provided as a fourth argument linear easing will be used. As the timer runs, you can access the current value by looking at <em>t.value</em>.</p>
</div>
<div class="paragraph">
<p>In both of these examples, the timer will be automatically discarded once it is finished. Set <em>discardOnCompletion</em> to false to keep the timer around for later reuse.</p>
</div>
<div class="paragraph">
<p>An example of setting up a bouncing ball animation (assuming the ball would be drawn elsewhere based on the rectangle <em>r</em>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">r</span> = playdate.geometry.rect.new(<span class="integer">100</span>, <span class="integer">10</span>, <span class="integer">40</span>, <span class="integer">40</span>)

<span class="keyword">local</span> <span class="local-variable">t</span> = playdate.frameTimer.new(<span class="integer">20</span>, <span class="integer">10</span>, <span class="integer">150</span>, playdate.easingFunctions.inCubic)
t.reverses = <span class="predefined-constant">true</span>
t.repeats = <span class="predefined-constant">true</span>
t.reverseEasingFunction = playdate.easingFunctions.outQuad
t.updateCallback = <span class="keyword">function</span>(timer)
    r.y = timer.value
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-ui">7.32. UI components</h3>
<div class="paragraph">
<p>playdate.ui provides common UI elements for playdate games.</p>
</div>
<div class="sect3 class">
<h4 id="C-ui.crankIndicator">Crank indicator</h4>
<div class="paragraph">
<p><code>playdate.ui.crankIndicator</code> is used to draw a standard indicator at the lower right corner of the screen that directs the player to use the crank.</p>
</div>
<div class="paragraph">
<p>As your game calls <a href="#m-ui.crankIndicator.draw"><code>playdate.ui.crankIndicator:draw()</code></a> on successive frames, the Playdate screen will display a "Use the Crank" message for ~0.7 seconds, then an animation of a rotating crank for ~1.4 seconds. (The direction of animation is specified by <a href="#v-ui.crankIndicator.clockwise"><code>.clockwise</code></a>.)</p>
</div>
<div class="paragraph">
<p>In some situations you may only want to alert the player to "use the crank" if <a href="#f-isCrankDocked"><code>playdate.isCrankDocked()</code></a> returns <code>true</code>, indicating that the crank is not extended.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/ui</em> to use crankIndicator. There is no need to instantiate a crankIndicator object; <code>playdate.ui.crankIndicator</code> automatically returns the shared crankIndicator instance.
</td>
</tr>
</table>
</div>
<div id="m-ui.crankIndicator.draw" class="openblock item method">
<div class="title">playdate.ui.crankIndicator:draw([xOffset, yOffset])</div>
<div class="content">
<div class="paragraph">
<p>Draws the next frame of the crank indicator animation, and is typically invoked in the <a href="#c-update"><code>playdate.update()</code></a> callback. <em>xOffset</em> and <em>yOffset</em> can be used to alter the position of the indicator by a specified number of pixels if desired. To stop drawing the crank indicator, simply stop calling <code>:draw()</code> in <code>playdate.update()</code>.</p>
</div>
<div class="paragraph">
<p>Note that if sprites are being used, this call should usually happen after <a href="#f-graphics.sprite.update">playdate.graphics.sprite.update()</a>.</p>
</div>
</div>
</div>
<div id="v-ui.crankIndicator.clockwise" class="openblock item variable">
<div class="title">playdate.ui.crankIndicator.clockwise</div>
<div class="content">
<div class="paragraph">
<p>Boolean property specifying which direction to animate the crank. Defaults to true.</p>
</div>
</div>
</div>
<div id="m-ui.crankIndicator.reset" class="openblock item method">
<div class="title">playdate.ui.crankIndicator:resetAnimation()</div>
<div class="content">
<div class="paragraph">
<p>Resets the crank animation to the beginning of its sequence.</p>
</div>
</div>
</div>
<div id="m-ui.crankIndicator.getBounds" class="openblock item method">
<div class="title">playdate.ui.crankIndicator:getBounds()</div>
<div class="content">
<div class="paragraph">
<p>Returns <em>x</em>, <em>y</em>, <em>width</em>, <em>height</em> representing the bounds that the crank indicator draws within. If necessary, this rect could be passed into <a href="#m-graphics.sprite.addDirtyRect">playdate.graphics.sprite.addDirtyRect()</a>, or used to manually draw over the indicator image drawn by <a href="#m-crankIndicator.draw">playdate.ui.crankIndicator:draw()</a> when you want to stop showing the crank indicator.</p>
</div>
</div>
</div>
</div>
<div class="sect3 class">
<h4 id="C-ui.gridview">Grid view</h4>
<div class="paragraph">
<p>playdate.ui.gridview provides a means for drawing a grid view composed of cells, and optionally sections with section headers.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
You must import <em>CoreLibs/ui</em> to use gridview.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Some notes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>playdate.ui.gridview uses <a href="#C-timer">playdate.timer</a> internally, so <a href="#f-timer.updateTimers">playdate.timer.updateTimers()</a> must be called in the main <a href="#c-update">playdate.update()</a> function.</p>
</li>
<li>
<p>If the gridview&#8217;s cell width is set to 0, cells will be drawn the same width as the table (minus any padding).</p>
</li>
<li>
<p>Section headers always draw the full width of the grid (minus padding), and do not scroll horizontally along with the rest of the content.</p>
</li>
</ul>
</div>
<div id="f-ui.gridview.new" class="openblock item function">
<div class="title">playdate.ui.gridview.new(cellWidth, cellHeight)</div>
<div class="content">
<div class="paragraph">
<p>Returns a new <a href="#C-ui.gridview">playdate.ui.gridview</a> with cells sized <em>cellWidth</em>, <em>cellHeight</em>. (Sizes are in pixels.) If cells should span the entire width of the grid (as in a list view), pass zero (0) for <em>cellWidth</em>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_drawing_4">Drawing</h5>
<div id="m-ui.gridview.drawCell" class="openblock item method">
<div class="title">playdate.ui.gridview:drawCell(section, row, column, selected, x, y, width, height)</div>
<div class="content">
<div class="paragraph">
<p>Override this method to draw the cells in the gridview. <em>selected</em> is a boolean, true if the cell being drawn is the currently-selected cell.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.drawSectionHeader" class="openblock item method">
<div class="title">playdate.ui.gridview:drawSectionHeader(section, x, y, width, height)</div>
<div class="content">
<div class="paragraph">
<p>Override this method to draw section headers. This function will only be called if the header height has been set to a value greater than zero (0).</p>
</div>
</div>
</div>
<div id="m-ui.gridview.drawHorizontalDivider" class="openblock item method">
<div class="title">playdate.ui.gridview:drawHorizontalDivider(x, y, width, height)</div>
<div class="content">
<div class="paragraph">
<p>Override this method to customize the drawing of horizontal dividers. This function will only be called if the horizontal divider height is greater than zero (0) and at least one divider has been added.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.drawInRect" class="openblock item method">
<div class="title">playdate.ui.gridview:drawInRect(x, y, width, height)</div>
<div class="content">
<div class="paragraph">
<p>Draws the gridview in the specified rect. Ideally this should be called on every <a href="#c-update">playdate.update()</a> to accommodate scrolling.</p>
</div>
</div>
</div>
<div id="v-ui.gridview.needsDisplay" class="openblock item variable">
<div class="title">playdate.ui.gridview.needsDisplay</div>
<div class="content">
<div class="paragraph">
<p>This read-only variable returns true if the gridview needs to be redrawn. This can be used to help optimize drawing in your app. Keep in mind that a gridview cannot know all reasons it may need to be redrawn, such as changes in your drawing callback functions, coordinate or size changes, or overlapping drawing, so you may need to additionally redraw at other times.</p>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Conditionally draw a grid view</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">if</span> myGridView.needsDisplay == <span class="predefined-constant">true</span> <span class="keyword">then</span>
    myGridView:drawInRect(x, y, w, h)
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_configuration">Configuration</h5>
<div id="m-ui.gridview.setNumberOfSections" class="openblock item method">
<div class="title">playdate.ui.gridview:setNumberOfSections(num)</div>
<div class="content">
<div class="paragraph">
<p>Sets the number of sections in the grid view. Each section contains at least one row, and row numbering starts at 1 in each section.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.getNumberOfSections" class="openblock item method">
<div class="title">playdate.ui.gridview:getNumberOfSections()</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of sections in the grid view.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.setNumberOfRowsInSection" class="openblock item method">
<div class="title">playdate.ui.gridview:setNumberOfRowsInSection(section, num)</div>
<div class="content">
<div class="paragraph">
<p>Sets the number of rows in <em>section</em>.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.getNumberOfRowsInSection" class="openblock item method">
<div class="title">playdate.ui.gridview:getNumberOfRowsInSection(section)</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of rows in <em>section</em>.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.setNumberOfColumns" class="openblock item method">
<div class="title">playdate.ui.gridview:setNumberOfColumns(num)</div>
<div class="content">
<div class="paragraph">
<p>Sets the number of columns in the gridview. 1 by default.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.getNumberOfColumns" class="openblock item method">
<div class="title">playdate.ui.gridview:getNumberOfColumns()</div>
<div class="content">
<div class="paragraph">
<p>Returns the number of columns in the gridview. 1 by default.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.setNumberOfRows" class="openblock item method">
<div class="title">playdate.ui.gridview:setNumberOfRows(&#8230;&#8203;)</div>
<div class="content">
<div class="paragraph">
<p>Convenience method for list-style gridviews, or for setting the number of rows for multiple sections at a time. Pass in a list of numbers of rows for sections starting from section 1.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.setCellSize" class="openblock item method">
<div class="title">playdate.ui.gridview:setCellSize(cellWidth, cellHeight)</div>
<div class="content">
<div class="paragraph">
<p>Sets the size of the cells in the gridview. If cells should span the entire width of the grid (as in a list view), pass zero (0) for <em>cellWidth</em>.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.setCellPadding" class="openblock item method">
<div class="title">playdate.ui.gridview:setCellPadding(left, right, top, bottom)</div>
<div class="content">
<div class="paragraph">
<p>Sets the amount of padding around cells.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.setContentInset" class="openblock item method">
<div class="title">playdate.ui.gridview:setContentInset(left, right, top, bottom)</div>
<div class="content">
<div class="paragraph">
<p>Sets the amount of space the content is inset from the edges of the gridview. Useful if a background image is being used as a border.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.getCellBounds" class="openblock item method">
<div class="title">playdate.ui.gridview:getCellBounds(section, row, column, [gridWidth])</div>
<div class="content">
<div class="paragraph">
<p>Returns multiple values (x, y, width, height) representing the bounds of the cell, not including padding, relative to the top-right corner of the grid view.</p>
</div>
<div class="paragraph">
<p>If the grid view is configured with zero width cells (see <a href="#f-gridview.new">playdate.ui.gridview:new</a>), <em>gridWidth</em> is required, and should be the same value you would pass to <a href="#m-gridview.drawInRect">playdate.ui.gridview:drawInRect</a>.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.setSectionHeaderHeight" class="openblock item method">
<div class="title">playdate.ui.gridview:setSectionHeaderHeight(height)</div>
<div class="content">
<div class="paragraph">
<p>Sets the height of the section headers. 0 by default, which causes section headers not to be drawn.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.getSectionHeaderHeight" class="openblock item method">
<div class="title">playdate.ui.gridview.getSectionHeaderHeight()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current height of the section headers.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.setSectionHeaderPadding" class="openblock item method">
<div class="title">playdate.ui.gridview:setSectionHeaderPadding(left, right, top, bottom)</div>
<div class="content">
<div class="paragraph">
<p>Sets the amount of padding around section headers.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.setHorizontalDividerHeight" class="openblock item method">
<div class="title">playdate.ui.gridview:setHorizontalDividerHeight(height)</div>
<div class="content">
<div class="paragraph">
<p>Sets the height of the horizontal dividers. The default height is half the cell height specified when creating the grid view.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.getHorizontalDividerHeight" class="openblock item method">
<div class="title">playdate.ui.gridview:getHorizontalDividerHeight()</div>
<div class="content">
<div class="paragraph">
<p>Returns the height of the horizontal dividers.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.addHorizontalDividerAbove" class="openblock item method">
<div class="title">playdate.ui.gridview:addHorizontalDividerAbove(section, row)</div>
<div class="content">
<div class="paragraph">
<p>Causes a horizontal divider to be drawn above the specified row. Drawing can be customized by overriding  <a href="#m-gridview.drawHorizontalDivider">playdate.ui.gridview:drawHorizontalDivider</a>.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.removeHorizontalDividers" class="openblock item method">
<div class="title">playdate.ui.gridview:removeHorizontalDividers()</div>
<div class="content">
<div class="paragraph">
<p>Removes all horizontal dividers from the grid view.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_scrolling_2">Scrolling</h5>
<div id="m-ui.gridview.setScrollDuration" class="openblock item method">
<div class="title">playdate.ui.gridview:setScrollDuration(ms)</div>
<div class="content">
<div class="paragraph">
<p>Controls the duration of scroll animations. 250ms by default.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.setScrollPosition" class="openblock item method">
<div class="title">playdate.ui.gridview:setScrollPosition(x, y, [animated])</div>
<div class="content">
<div class="paragraph">
<p>'set' scrolls to the coordinate <em>x</em>, <em>y</em>.</p>
</div>
<div class="paragraph">
<p>If <em>animated</em> is true (or not provided) the new scroll position is animated to using <a href="#v-gridview.scrollEasingFunction">playdate.ui.gridview.scrollEasingFunction</a> and the value set in <a href="#m-gridview.setScrollDuration">playdate.ui.gridview:setScrollDuration()</a>.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.getScrollPosition" class="openblock item method">
<div class="title">playdate.ui.gridview:getScrollPosition()</div>
<div class="content">
<div class="paragraph">
<p>Returns the current scroll location as a pair <em>x</em>, <em>y</em>.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.scrollToCell" class="openblock item method">
<div class="title">playdate.ui.gridview:scrollToCell(section, row, column, [animated])</div>
<div class="content">
<div class="paragraph">
<p>Scrolls to the specified cell, just enough so the cell is visible.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.scrollCellToCenter" class="openblock item method">
<div class="title">playdate.ui.gridview:scrollCellToCenter(section, row, column, [animated])</div>
<div class="content">
<div class="paragraph">
<p>Scrolls to the specified cell, so the cell is centered in the gridview, if possible.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.scrollToRow" class="openblock item method">
<div class="title">playdate.ui.gridview:scrollToRow(row, [animated])</div>
<div class="content">
<div class="paragraph">
<p>Convenience function for list-style gridviews. Scrolls to the specified row in the list.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.scrollToTop" class="openblock item method">
<div class="title">playdate.ui.gridview:scrollToTop([animated])</div>
<div class="content">
<div class="paragraph">
<p>Scrolls to the top of the gridview.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_selection">Selection</h5>
<div class="paragraph">
<p>Changing the selection can also change the scroll position. By default cells are scrolled so that they are centered in the gridview, if possible. To change that behavior so the grid is just scrolled enough to make the cell visible, set <a href="#v-gridview.scrollCellsToCenter">scrollCellsToCenter</a> to false.</p>
</div>
<div id="m-ui.gridview.setSelection" class="openblock item method">
<div class="title">playdate.ui.gridview:setSelection(section, row, column)</div>
<div class="content">
<div class="paragraph">
<p>Selects the cell at the given position.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.getSelection" class="openblock item method">
<div class="title">playdate.ui.gridview:getSelection()</div>
<div class="content">
<div class="paragraph">
<p>Returns the currently-selected cell as <em>section</em>, <em>row</em>, <em>column</em></p>
</div>
</div>
</div>
<div id="m-ui.gridview.setSelectedRow" class="openblock item method">
<div class="title">playdate.ui.gridview:setSelectedRow(row)</div>
<div class="content">
<div class="paragraph">
<p>Convenience method for list-style gridviews. Selects the cell at <em>row</em> in section 1.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.getSelectedRow" class="openblock item method">
<div class="title">playdate.ui.gridview:getSelectedRow()</div>
<div class="content">
<div class="paragraph">
<p>Convenience method for list-style gridviews. Returns the selected cell at <em>row</em> in section 1.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.selectNextRow" class="openblock item method">
<div class="title">playdate.ui.gridview:selectNextRow(wrapSelection, [scrollToSelection, animate])</div>
<div class="content">
<div class="paragraph">
<p>Selects the cell directly below the currently-selected cell.</p>
</div>
<div class="paragraph">
<p>If <em>wrapSelection</em> is true, the selection will wrap around to the opposite end of the grid. If <em>scrollToSelection</em> is true (or not provided), the newly-selected cell will be scrolled to. If <em>animate</em> is true (or not provided), the scroll will be animated.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.selectPreviousRow" class="openblock item method">
<div class="title">playdate.ui.gridview:selectPreviousRow(wrapSelection, [scrollToSelection, animate])</div>
<div class="content">
<div class="paragraph">
<p>Identical to <code>selectNextRow()</code> but goes the other direction.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.selectNextColumn" class="openblock item method">
<div class="title">playdate.ui.gridview:selectNextColumn(wrapSelection, [scrollToSelection, animate])</div>
<div class="content">
<div class="paragraph">
<p>Selects the cell directly to the right of the currently-selected cell.</p>
</div>
<div class="paragraph">
<p>If the last column is currently selected and <em>wrapSelection</em> is true, the selection will wrap around to the opposite side of the grid. If a wrap occurs and the gridview&#8217;s <a href="#v-gridview.changeRowOnColumnWrap"><code>changeRowOnColumnWrap</code></a> is <code>true</code> the row will also be advanced or moved back.</p>
</div>
<div class="paragraph">
<p>If <em>scrollToSelection</em> is true (or not provided), the newly-selected cell will be scrolled to. If <em>animate</em> is true (or not provided), the scroll will be animated.</p>
</div>
</div>
</div>
<div id="m-ui.gridview.selectPreviousColumn" class="openblock item method">
<div class="title">playdate.ui.gridview:selectPreviousColumn(wrapSelection, [scrollToSelection, animate])</div>
<div class="content">
<div class="paragraph">
<p>Identical to <code>selectNextColumn()</code> but goes the other direction.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_properties">Properties</h5>
<div id="v-ui.gridview.backgroundImage" class="openblock item variable">
<div class="title">playdate.ui.gridview.backgroundImage</div>
<div class="content">
<div class="paragraph">
<p>A background image that draws behind the gridview&#8217;s cells. This image can be either a <a href="#C-graphics.image"><code>playdate.graphics.image</code></a> which will be tiled or a <a href="#C-graphics.nineSlice"><code>playdate.nineSlice</code></a>.</p>
</div>
</div>
</div>
<div id="v-ui.gridview.isScrolling" class="openblock item variable">
<div class="title">playdate.ui.gridview.isScrolling</div>
<div class="content">
<div class="paragraph">
<p>Read-only. True if the gridview is currently performing a scroll animation.</p>
</div>
</div>
</div>
<div id="v-ui.gridview.scrollEasingFunction" class="openblock item variable">
<div class="title">playdate.ui.gridview.scrollEasingFunction</div>
<div class="content">
<div class="paragraph">
<p>The easing function used when performing scroll animations. The function should be of the form function(t, b, c, d), where t is elapsed time, b is the beginning value, c is the change, or end value - start value, and d is the duration. Many such functions are available in <a href="#M-easingFunctions"><code>playdate.easingFunctions</code></a>. <a href="#f-easingFunctions.outCubic"><code>playdate.easingFunctions.outCubic</code></a> is the default.</p>
</div>
</div>
</div>
<div id="v-ui.gridview.easingAmplitude" class="openblock item variable">
<div class="title">playdate.ui.gridview.easingAmplitude <br> playdate.ui.gridview.easingPeriod</div>
<div class="content">
<div class="paragraph">
<p>For <a href="#M-easingFunctions">easing functions</a> that take additional amplitude and period arguments (such as <em>inOutElastic</em>), set these to the desired values.</p>
</div>
</div>
</div>
<div id="v-ui.gridview.changeRowOnColumnWrap" class="openblock item variable">
<div class="title">playdate.ui.gridview.changeRowOnColumnWrap</div>
<div class="content">
<div class="paragraph">
<p>Controls the behavior of <a href="#m-gridview.selectPreviousColumn">playdate.ui.gridview:selectPreviousColumn()</a> and <a href="#m-gridview.selectNextColumn">playdate.ui.gridview:selectNextColumn()</a> if the current selection is at the first or last column, respectively. If set to true, the selection switch to a new row to allow the selection to change. If false, the call will have no effect on the selection. True by default.</p>
</div>
</div>
</div>
<div id="v-ui.gridview.scrollCellsToCenter" class="openblock item variable">
<div class="title">playdate.ui.gridview.scrollCellsToCenter</div>
<div class="content">
<div class="paragraph">
<p>If true, the gridview will attempt to center cells when scrolling. If false, the gridview will be scrolled just as much as necessary to make the cell visible.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_grid_view_sample_code">Grid view sample code</h5>
<div class="paragraph">
<p>To set up a grid view, specify the dimensions and override the necessary drawing methods:</p>
</div>
<div class="listingblock">
<div class="title">Grid view example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">gfx</span> = playdate.graphics
<span class="keyword">local</span> <span class="local-variable">gridview</span> = playdate.ui.gridview.new(<span class="integer">44</span>, <span class="integer">44</span>)
gridview.backgroundImage = playdate.graphics.nineSlice.new(<span class="string"><span class="delimiter">'</span><span class="content">shadowbox</span><span class="delimiter">'</span></span>, <span class="integer">4</span>, <span class="integer">4</span>, <span class="integer">45</span>, <span class="integer">45</span>)
gridview:setNumberOfColumns(<span class="integer">8</span>)
gridview:setNumberOfRows(<span class="integer">2</span>, <span class="integer">4</span>, <span class="integer">3</span>, <span class="integer">5</span>) <span class="comment">-- number of sections is set automatically</span>
gridview:setSectionHeaderHeight(<span class="integer">24</span>)
gridview:setContentInset(<span class="integer">1</span>, <span class="integer">4</span>, <span class="integer">1</span>, <span class="integer">4</span>)
gridview:setCellPadding(<span class="integer">4</span>, <span class="integer">4</span>, <span class="integer">4</span>, <span class="integer">4</span>)
gridview.changeRowOnColumnWrap = <span class="predefined-constant">false</span>

<span class="keyword">function</span> gridview:<span class="function">drawCell</span>(section, row, column, selected, x, y, width, height)
    <span class="keyword">if</span> selected <span class="keyword">then</span>
        gfx.drawCircleInRect(x<span class="integer">-2</span>, y<span class="integer">-2</span>, width+<span class="integer">4</span>, height+<span class="integer">4</span>, <span class="integer">3</span>)
    <span class="keyword">else</span>
        gfx.drawCircleInRect(x+<span class="integer">4</span>, y+<span class="integer">4</span>, width<span class="integer">-8</span>, height<span class="integer">-8</span>, <span class="integer">0</span>)
    <span class="keyword">end</span>
    <span class="keyword">local</span> <span class="local-variable">cellText</span> = <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>..row..<span class="string"><span class="delimiter">&quot;</span><span class="content">-</span><span class="delimiter">&quot;</span></span>..column
    gfx.drawTextInRect(cellText, x, y+<span class="integer">14</span>, width, <span class="integer">20</span>, <span class="predefined-constant">nil</span>, <span class="predefined-constant">nil</span>, kTextAlignment.center)
<span class="keyword">end</span>

<span class="keyword">function</span> gridview:<span class="function">drawSectionHeader</span>(section, x, y, width, height)
    gfx.drawText(<span class="string"><span class="delimiter">&quot;</span><span class="content">*SECTION </span><span class="delimiter">&quot;</span></span>.. section .. <span class="string"><span class="delimiter">&quot;</span><span class="content">*</span><span class="delimiter">&quot;</span></span>, x + <span class="integer">10</span>, y + <span class="integer">8</span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For the simple case of a simple list-style grid:</p>
</div>
<div class="listingblock">
<div class="title">List-style grid view example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">local</span> <span class="local-variable">menuOptions</span> = <span class="map"><span class="delimiter">{</span><span class="string"><span class="delimiter">&quot;</span><span class="content">Sword</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Shield</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Arrow</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Sling</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Stone</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Longbow</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">MorningStar</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Armour</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Dagger</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Rapier</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Skeggox</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">War Hammer</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Battering Ram</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Catapult</span><span class="delimiter">&quot;</span></span><span class="delimiter">}</span></span>
<span class="keyword">local</span> <span class="local-variable">listview</span> = playdate.ui.gridview.new(<span class="integer">0</span>, <span class="integer">10</span>)
listview.backgroundImage = playdate.graphics.nineSlice.new(<span class="string"><span class="delimiter">'</span><span class="content">scrollbg</span><span class="delimiter">'</span></span>, <span class="integer">20</span>, <span class="integer">23</span>, <span class="integer">92</span>, <span class="integer">28</span>)
listview:setNumberOfRows(#menuOptions)
listview:setCellPadding(<span class="integer">0</span>, <span class="integer">0</span>, <span class="integer">13</span>, <span class="integer">10</span>)
listview:setContentInset(<span class="integer">24</span>, <span class="integer">24</span>, <span class="integer">13</span>, <span class="integer">11</span>)

<span class="keyword">function</span> listview:<span class="function">drawCell</span>(section, row, column, selected, x, y, width, height)
        <span class="keyword">if</span> selected <span class="keyword">then</span>
                gfx.fillRoundRect(x, y, width, <span class="integer">20</span>, <span class="integer">4</span>)
                gfx.setImageDrawMode(gfx.kDrawModeFillWhite)
        <span class="keyword">else</span>
                gfx.setImageDrawMode(gfx.kDrawModeCopy)
        <span class="keyword">end</span>
        gfx.drawTextInRect(menuOptions[row], x, y+<span class="integer">2</span>, width, height, <span class="predefined-constant">nil</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">...</span><span class="delimiter">&quot;</span></span>, kTextAlignment.center)
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, to draw the grid view:</p>
</div>
<div class="listingblock">
<div class="title">Drawing a grid view</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="lua"><span class="keyword">function</span> playdate.<span class="function">update</span>()
    gridview:drawInRect(<span class="integer">20</span>, <span class="integer">20</span>, <span class="integer">180</span>, <span class="integer">200</span>)
    listview:drawInRect(<span class="integer">220</span>, <span class="integer">20</span>, <span class="integer">160</span>, <span class="integer">210</span>)
    playdate.timer:updateTimers()
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-wired-networking">7.33. Serial communication</h3>
<div id="c-serialMessageReceived" class="openblock item callback">
<div class="title">playdate.serialMessageReceived(message)</div>
<div class="content">
<div class="paragraph">
<p>Called when a <code>msg &lt;text&gt;</code> command is received on the serial port. The text following the command is passed to the function as the string <em>message</em>.</p>
</div>
<div class="paragraph">
<p>Running <code>!msg &lt;message&gt;</code> in the simulator Lua console sends the command to the device if one is connected, otherwise it sends it to the game running in the simulator.</p>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-mirror">7.34. Playdate Mirror</h3>
<div class="paragraph">
<p><a href="http://play.date/mirror/">Mirror</a> is an app that routes Playdate&#8217;s audio and video to an PC running Windows, macOS, or Linux.</p>
</div>
<div id="c-mirrorStarted" class="openblock item callback">
<div class="title">playdate.mirrorStarted()</div>
<div class="content">
<div class="paragraph">
<p>Called when the device is connected to Mirror.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
In rare situations, Mirror may have trouble keeping up with games running at a high framerate (&gt; 40 fps). If you find this consistently happens to your game, you can optionally use these callbacks to lower the amount of computation or drawing you do so as to give more time to Playdate OS on each frame, improving your user&#8217;s experience while playing your game via Mirror.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="c-mirrorEnded" class="openblock item callback">
<div class="title">playdate.mirrorEnded()</div>
<div class="content">
<div class="paragraph">
<p>Called when the device is disconnected from Mirror.</p>
</div>
</div>
</div>
</div>
<div class="sect2 module">
<h3 id="M-garbage-collection">7.35. Garbage collection</h3>
<div id="f-setCollectsGarbage" class="openblock item function">
<div class="title">playdate.setCollectsGarbage(flag)</div>
<div class="content">
<div class="paragraph">
<p>If <em>flag</em> is false, automatic garbage collection is disabled and the game should manually collect garbage with Lua&#8217;s <code>collectgarbage()</code> function.</p>
</div>
</div>
</div>
<div id="f-setMinimumGCTime" class="openblock item function">
<div class="title">playdate.setMinimumGCTime(ms)</div>
<div class="content">
<div class="paragraph">
<p>Force the Lua garbage collector to run for at least <em>ms</em> milliseconds every frame, so that garbage doesn&#8217;t pile up and cause the game to run out of memory and stall in emergency garbage collection. The default value is 1 millisecond.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If your game isn&#8217;t generating a lot of garbage, it might be advantageous to set a smaller minimum GC time, granting more CPU bandwidth to your game.
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="f-setGCScaling" class="openblock item function">
<div class="title">playdate.setGCScaling(min, max)</div>
<div class="content">
<div class="paragraph">
<p>When the amount of used memory is less than <code>min</code> (scaled from 0-1, as a percentage of total system memory), the system will only run the collector for the minimum GC time, as set by <a href="#f-setGCScaling">playdate.setGCScaling()</a>, every frame. If the used memory is more than <code>max</code>, the system will spend all free time running the collector. Between the two, the time used by the garbage collector is scaled proportionally.</p>
</div>
<div class="paragraph">
<p>For example, if the scaling is set to a min of 0.4 and max of 0.7, and memory is half full, the collector will run for the minimum GC time plus 1/3 of whatever time is left before the next frame (because (0.5 - 0.4) / (0.7 - 0.4) = 1/3).</p>
</div>
<div class="paragraph">
<p>The default behavior is a scaling of <code>(0.0, 1.0)</code>. If set to <code>(0.0, 0.0)</code>, the system will use all available extra time each frame running GC.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 section">
<h2 id="hidden-gems">8. Hidden Gems</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Playdate APIs include a lot of functionality you might expect:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#M-graphics">graphics</a></p>
</li>
<li>
<p><a href="#C-graphics.sprite">sprites</a></p>
</li>
<li>
<p><a href="#M-sprite-collisions">collisions</a></p>
</li>
<li>
<p><a href="#C-graphics.animator">animation</a></p>
</li>
<li>
<p><a href="#M-sound">sound</a></p>
</li>
<li>
<p><a href="#M-file">file I/O</a></p>
</li>
<li>
<p><a href="#f-graphics.getLocalizedText">localization</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are also some unexpected APIs, some unique to the Playdate platform, that you may not be aware of. Be sure to take a look at these:</p>
</div>
<div class="sect2">
<h3 id="_lua_enhancements">8.1. Lua enhancements</h3>
<div class="paragraph">
<p>The Playdate SDK offers some enhancements to standard Lua, including <a href="#additional-assignment-operators">additional assignment operators</a> (<code>+=</code>, <code>-=</code>) and <a href="#table-additions">convenience functions for handling Lua tables</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_debugging">8.2. Debugging</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#f-drawFPS">playdate.drawFPS()</a>: Displays the current framerate onscreen.</p>
</li>
<li>
<p><a href="#c-debugDraw">playdate.debugDraw()</a>: Highlight regions on the Simulator screen in a different color, to aid in debugging.</p>
</li>
<li>
<p><a href="#f-printTable">printTable()</a>: Outputs the contents of a table to the console.</p>
</li>
<li>
<p><a href="#c-keyPressed">playdate.keyPressed()</a>: Captures computer keyboard keypresses as an aid in debugging. For example, typing a number might advance the game to a higher level.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_enhancing_your_games_user_experience">8.3. Enhancing your game&#8217;s user experience</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#C-ui.crankIndicator">playdate.ui.crankIndicator()</a>: Inform the player that your game uses the crank.</p>
</li>
<li>
<p><a href="#m-menu.addOptionsMenuItem">playdate.menu:addOptionsMenuItem()</a>: Add a special menu item for your game into the System Menu.</p>
</li>
<li>
<p><a href="#f-wait">playdate.wait()</a>: Pause your game&#8217;s execution for a specified period of time. Useful for, say, suspending gameplay while displaying a message to the player.</p>
</li>
<li>
<p><a href="#f-setMenuImage">playdate.setMenuImage()</a>: Set a custom image that displays on the left-side of the screen while your game is paused.</p>
</li>
<li>
<p><a href="#M-keyboard">playdate.keyboard</a>: Display a special Playdate keyboard onscreen and collect text input from the player.</p>
</li>
<li>
<p><a href="#f-timer.keyRepeatTimer">playdate.timer.keyRepeatTimer()</a>: Useful, keyboard-style repeating.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_buttons">8.4. Buttons</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#c-AButtonHeld">playdate.AButtonHeld()</a>, <a href="#c-BButtonHeld">playdate.BButtonHeld()</a>: Called after the A or B buttons are held for one second. Useful for adding a "second function" to a button (display a map, for instance).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_responding_to_device_events">8.5. Responding to device events</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#c-gameWillTerminate">playdate.gameWillTerminate()</a>: Notifies your game it&#8217;s about to end its execution.</p>
</li>
<li>
<p><a href="#c-deviceWillLock">playdate.deviceWillLock()</a>, <a href="#c-deviceDidUnlock">playdate.deviceDidUnlock()</a>: Notifies your game the Playdate is about to be locked, or woken up.</p>
</li>
<li>
<p><a href="#c-gameWillPause">playdate.gameWillPause()/Resume()</a>: Notifies your game it&#8217;s about to be paused or resumed.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_drawing_5">8.6. Drawing</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#f-graphics.setDrawOffset">playdate.graphics.setDrawOffset()</a>: Force all drawing calls to render with an offset; ideal for games with scrolling content.</p>
</li>
<li>
<p><a href="#C-ui.gridview">playdate.ui.gridview</a>: Render one- or two-dimensional grids of content.</p>
</li>
<li>
<p><a href="#C-graphics.nineSlice">playdate.graphics.nineslice</a>: Create resizable rectangular assets.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_effects">8.7. Effects</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#m-graphics.image.vcrPauseFilterImage">playdate.graphics.image.vcrPauseFilterImage()</a> - add glitchiness to your game&#8217;s appearance</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_accessibility">8.8. Accessibility</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#f-getReduceFlashing">playdate.getReduceFlashing()</a>: Check this at the beginning of your game. If <em>true</em>, your game should avoid visuals that could be problematic for people with sensitivities to flashing lights or patterns.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_file_io">8.9. File I/O</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#M-datastore">playdate.datastore</a>: Easy writing and reading of data.</p>
</li>
<li>
<p><a href="#M-json">json</a>: Read and write JSON.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_game_logic">8.10. Game logic</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#M-pathfinder">playdate.pathfinder</a>: An implementation of the A* pathfinding algorithm.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_deployment">8.11. Deployment</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#pdxinfo">buildNumber</a>: It is critical to update your <code>buildNumber</code> for every public release of your game.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_odds_ends">8.12. Odds &amp; ends</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#f-graphics.perlin">playdate.graphics.perlin</a>: Generate natural-looking patterns.</p>
</li>
<li>
<p><a href="#f-graphics.generateQRCode">playdate.graphics.generateQRCode</a>: Display a QR code onscreen.</p>
</li>
<li>
<p><a href="#c-serialMessageReceived">playdate.serialMessageReceived</a>: Communicate over the USB port.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1 section">
<h2 id="getting-help">9. Getting Help</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_where_can_i_download_the_sdk">9.1. Where can I download the SDK?</h3>
<div class="paragraph">
<p>Head to the <a href="https://play.date/dev/">Playdate Developer</a> page to download the latest SDK.</p>
</div>
</div>
<div class="sect2">
<h3 id="_where_do_i_go_if_i_have_questions_about_the_sdk">9.2. Where do I go if I have questions about the SDK?</h3>
<div class="paragraph">
<p>You can find the SDK documentation for Lua <a href="https://sdk.play.date/inside-playdate">here</a> and C <a href="https://sdk.play.date/inside-playdate-with-c">here</a> . If you&#8217;re interested in seeing the Playdate SDK in action, check out our <a href="https://www.twitch.tv/videos/608372277">Twitch stream</a> . For tips on making Playdate games, <a href="https://sdk.play.date/designing-for-playdate">click here</a>.</p>
</div>
<div class="paragraph">
<p>Searching in the <a href="https://devforum.play.date/c/get-help/38">Get Help</a> and <a href="https://devforum.play.date/c/development-discussion/80">Development Discussion</a> on our Developer Forum to find solutions will also be a good place to look at. If you still need help, the best way to get help from either the community or Panic is to post in that same Get Help category.</p>
</div>
</div>
<div class="sect2">
<h3 id="_where_do_i_report_bugs_or_issues_relating_to_the_sdk">9.3. Where do I report bugs or issues relating to the SDK?</h3>
<div class="paragraph">
<p>Head to the <a href="https://devforum.play.date/c/bugs/47">Bug Reports</a> category and check the <a href="https://devforum.play.date/t/about-the-bug-reports-category/1463">Bug Report category info</a> for information on how to post a bug report. One of us at Panic will take a look at it!
And what if I have feature requests?</p>
</div>
<div class="paragraph">
<p>To share your ideas, suggestions, and requests relating to Playdate, head to the <a href="https://devforum.play.date/c/feature-requests/48">Feature Request</a> category and check the <a href="https://devforum.play.date/t/about-the-feature-requests-category/1464">Feature Request category info</a> before posting your feature request.</p>
</div>
</div>
<div class="sect2">
<h3 id="_list_of_helpful_libraries_and_code">9.4. List of Helpful Libraries and Code</h3>
<div class="paragraph">
<p>This thread includes some helpful tips from the community. Check it out <a href="https://devforum.play.date/t/a-list-of-helpful-libraries-and-code/221">here</a>. For more resources, head to the <a href="https://devforum.play.date/c/development-discussion/80">Development Discussion</a> category.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_legal_information">10. Legal information</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Playdate fonts are licensed to you under the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International (CC BY 4.0) license.</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-12-08 19:03:14 UTC
</div>
</div>
</body>
</html>